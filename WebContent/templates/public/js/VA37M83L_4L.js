if (self.CavalryLogger) { CavalryLogger.start_js(["pI8yP"]); }

__d("FundsAvailability",[],(function a(b,c,d,e,f,g){f.exports={NONE:0,FUNDS_AVAILABILITY_NA:65,FUNDS_AVAILABILITY_IMMEDIATE:73,FUNDS_AVAILABILITY_SAME_DAY:83,FUNDS_AVAILABILITY_NEXT_DAY:78,FUNDS_AVAILABILITY_FIVE_DAY:70,FUNDS_AVAILABILITY_UNKNOWN:85,FUNDS_AVAILABILITY_ONE_THREE_DAY:79,FUNDS_AVAILABILITY_CROSS_BORDER:66,FUNDS_AVAILABILITY_CROSS_BORDER_FAST_FUNDS:67,FUNDS_AVAILABILITY_DOMESTIC:68,FUNDS_AVAILABILITY_DOMESTIC_FAST_FUNDS:69}}),null);
__d("IrisProtocolMessageLifetime",[],(function a(b,c,d,e,f,g){f.exports={TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:3e4,TTL_1MINUTE:6e4,TTL_3MINUTES:18e4,TTL_5MINUTES:3e5,TTL_10MINUTES:6e5,TTL_15MINUTES:9e5,TTL_30MINUTES:18e5,TTL_1HOUR:36e5,TTL_2HOURS:72e5,TTL_4HOURS:144e5,TTL_8HOURS:288e5,TTL_12HOURS:432e5,TTL_24HOURS:864e5}}),null);
__d("MercuryAPIArgsSource",[],(function a(b,c,d,e,f,g){f.exports={CHAT:"chat",JEWEL:"jewel",MERCURY:"mercury",MERCURYSYNC:"mercury_sync",WEBMESSENGER:"web_messenger",MESSENGER:"messenger"}}),null);
__d("MercuryAudioType",[],(function a(b,c,d,e,f,g){f.exports={AudioClip:"fb_voice_message",VoiceMessageWithTranscript:"fb_voice_message_with_transcript"}}),null);
__d("MessageLiveLocationClientSyncProtocolStopReason",[],(function a(b,c,d,e,f,g){f.exports={EXPIRED:1,CANCELED:2,ARRIVED:3}}),null);
__d("MessengerView",[],(function a(b,c,d,e,f,g){f.exports={DETAIL:{COMPOSE:"detail/compose",THREAD:"detail/thread",PAYTHREAD:"detail/paythread",PAYFRIENDPICKER:"detail/payfriendpicker"},MASTER:{PAYMENT:"master/payment",PEOPLE:"master/people",RECENT:"master/recent",SUPPORT:"master/support",SEARCH:"master/search"}}}),null);
__d("PageCommItemStatus",[],(function a(b,c,d,e,f,g){f.exports={FOLLOW_UP:"FOLLOW_UP",DONE:"DONE",TODO:"TODO",SPAM:"SPAM"}}),null);
__d("EmoticonEmojiList",[],(function a(b,c,d,e,f,g){f.exports={names:{":)":"slightsmile",":-)":"slightsmile",":]":"slightsmile","=)":"smile","(:":"slightsmile","(=":"smile",":(":"frown",":-(":"frown",":[":"frown","=(":"frown",")=":"frown",";-P":"winktongue",";P":"winktongue",";-p":"winktongue",";p":"winktongue",":poop:":"poop",":P":"tongue",":-P":"tongue",":-p":"tongue",":p":"tongue","=P":"tongue","=p":"tongue","=D":"grin",":-D":"slightgrin",":D":"slightgrin",":o":"gasp",":-O":"gasp",":O":"gasp",":-o":"gasp",";)":"wink",";-)":"wink","8-)":"glasses","8)":"glasses","B-)":"glasses","B)":"glasses",">:(":"grumpy",">:-(":"grumpy",":/":"unsure",":-/":"unsure",":\\":"unsure",":-\\":"unsure","=/":"unsure","=\\":"unsure",":'(":"cry",":'-(":"cry",":\u2019(":"cry",":\u2019-(":"cry","3:)":"devil","3:-)":"devil","O:)":"angel","O:-)":"angel","0:)":"angel","0:-)":"angel",":*":"kiss",":-*":"kiss",";-*":"winkkiss",";*":"winkkiss","<3":"heart","&lt;3":"heart","\u2665":"heart","^_^":"kiki","^~^":"kiki","-_-":"expressionless",":-|":"squint",":|":"squint",">:o":"upset",">:O":"upset",">:-O":"upset",">:-o":"upset",">_<":"persevere",">.<":"persevere",'<(")':"penguin",O_O:"flushface",o_o:"flushface","0_0":"flushface",T_T:"crying","T-T":"crying",ToT:"crying","T.T":"crying","-3-":"flushkiss","'-_-":"sweating","\u2019-_-":"sweating","(y)":"like",":like:":"like","(Y)":"like","(n)":"dislike","(N)":"dislike"},emote2emojis:{slightsmile:"1f642",smile:"1f60a",frown:"1f61e",winktongue:"1f61c",poop:"1f4a9",tongue:"1f61b",slightgrin:"1f600",grin:"1f603",gasp:"1f62e",wink:"1f609",glasses:"1f60e",grumpy:"1f620",unsure:"1f615",cry:"1f622",devil:"1f608",angel:"1f607",kiss:"1f617",winkkiss:"1f618",heart:"2764",kiki:"1f60a",expressionless:"1f611",squint:"1f610",upset:"1f620",persevere:"1f623",penguin:"1f427",flushface:"1f633",crying:"1f62d",flushkiss:"1f61a",sweating:"1f613",like:"f0000",dislike:"1f44e"},symbols:{slightsmile:":)",smile:"=)",frown:":(",winktongue:";-P",poop:":poop:",tongue:":P",slightgrin:":D",grin:"=D",gasp:":o",wink:";)",glasses:"8-)",grumpy:">:(",unsure:":/",cry:":'(",devil:"3:)",angel:"O:)",kiss:":*",winkkiss:";*",heart:"<3",kiki:"^_^",expressionless:"-_-",squint:":-|",upset:">:o",persevere:">_<",penguin:'<(")',flushface:"O_O",crying:"T_T",flushkiss:"-3-",sweating:"'-_-",like:"(y)",dislike:"(n)"},regexp:/(^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))([\s\'\".,!?]|<br>|$)/,noncapturingRegexp:/(?:^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))(?:[\s\'\".,!?]|<br>|$)/}}),null);
__d("MessengerHotlikeEmoji.bs",[],(function a(b,c,d,e,f,g){"use strict";var h="f0000";function i(j){return j===h}g.hotlike_key=h;g.isMessengerHotlike=i}),null);
__d("Utf16",[],(function a(b,c,d,e,f,g){var h={decode:function i(j){switch(j.length){case 1:return j.charCodeAt(0);case 2:return 65536|(j.charCodeAt(0)-55296)*1024|j.charCodeAt(1)-56320;default:return null}},encode:function i(j){if(j<65536)return String.fromCharCode(j);else return String.fromCharCode(55296+(j-65536>>10))+String.fromCharCode(56320+j%1024)}};f.exports=h}),null);
__d("messengerIterateEmoji",["MessengerSupportedEmoji","ifRequired"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j,k,l){__p&&__p();var m=String(i);while(m){var n=c("ifRequired")("MessengerSupportedEmojiUtils",function(r){return r.getEmojiMatchObj(m)},function(){return c("MessengerSupportedEmoji").getEmojiMatchObj(m)});if(n){var o=n.offset+n.length,p=m.substr(0,n.is_supported?n.offset:o);k(p);if(n.is_supported)j(n.emoji_str,n.emoji_key,l);var q=m.substr(o);m=q}else break}k(m)}f.exports=h}),null);
__d("messengerIterateEmoticons",["EmoticonEmojiList"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j,k,l){__p&&__p();var m,n,o,p,q,r=String(i);while(r){var s=c("EmoticonEmojiList").regexp.exec(r);if(s){m=s.index+s[1].length;n=r.substr(0,m);o=s[2];p=r.substr(m+o.length);q=c("EmoticonEmojiList").names[o];k(n);j(o,q,l);r=p}else break}k(r)}f.exports=h}),null);
__d("MessengerTextWithEmoticons.react",["cx","fbt","BaseTextWithDecoration.react","EmojiImageURL","EmoticonEmojiList","MessengerHotlikeEmoji.bs","Image.react","React","gkx","messengerIterateEmoji","messengerIterateEmoticons"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes;function m(q,r,s,t){var u=t?128:16,v=c("gkx")("AT7ffoM8gf91Fer7cUMkwGH62Vum20vkKo_AIqUOx27bu9y21PoFYcSzgDJj_KAeh5RgHmHKzv6c5n2RlIxDAfXE")&&!q&&!c("MessengerHotlikeEmoji.bs").isMessengerHotlike(r)?c("EmojiImageURL").getFBEmojiURL(s,u):c("EmojiImageURL").getMessengerURL(s,u),w=t?"_1ift _5m3a":"_1ift _2560";return c("React").createElement(c("Image.react"),{alt:r,className:w,src:v})}function n(q,r,s){var t=s?128:16,u=c("EmoticonEmojiList").emote2emojis[r],v=u?c("gkx")("AT7ffoM8gf91Fer7cUMkwGH62Vum20vkKo_AIqUOx27bu9y21PoFYcSzgDJj_KAeh5RgHmHKzv6c5n2RlIxDAfXE")&&!c("MessengerHotlikeEmoji.bs").isMessengerHotlike(u)?c("EmojiImageURL").getFBEmojiURL(u,t):c("EmojiImageURL").getMessengerURL(u,t):null;if(v){var w=String.fromCodePoint(parseInt(u,t)),x=s?"_1ift _5m3a":"_1ift _2560";return c("React").createElement(c("Image.react"),{alt:w,className:x,src:v})}var y=i._("Bi\u1ec3u t\u01b0\u1ee3ng c\u1ea3m x\u00fac {emoticonName}",[i._param("emoticonName",r)]);return c("React").createElement("span",{"aria-label":y},q)}function o(q,r,s){return function(t,u,v){var w=function w(x,y,s){u(r(x,y,s))};q(String(t),w,v,s)}}j=babelHelpers.inherits(p,c("React").Component);k=j&&j.prototype;p.prototype.shouldComponentUpdate=function(q){return q.text!==this.props.text};p.prototype.render=function(){var q=[o(c("messengerIterateEmoji"),m.bind(null,!!this.props.forceMessengerEmoji),this.props.customSize),o(c("messengerIterateEmoticons"),n,this.props.customSize)];return c("React").createElement(c("BaseTextWithDecoration.react"),babelHelpers["extends"]({},this.props,{text:this.props.text,decorators:q}))};function p(){j.apply(this,arguments)}p.propTypes={text:l.string,customSize:l.bool,forceMessengerEmoji:l.bool};f.exports=p}),null);
__d("MessengerTextWithEntities.react",["Link.react","React","BaseTextWithEntities.react","MessengerTextWithEmoticons.react"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;function j(l){return l.replace(/<3\b|&hearts;/g,"\u2665")}h=babelHelpers.inherits(k,c("React").Component);i=h&&h.prototype;function k(){__p&&__p();var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=i.constructor).call.apply(l,[this].concat(o)),this.$MessengerTextWithEntities1=function(q){if(this.props.renderEmoticons||this.props.renderEmoji)return c("React").createElement(c("MessengerTextWithEmoticons.react"),{text:q,customSize:this.props.customSize,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji});else return j(q)}.bind(this),this.$MessengerTextWithEntities2=function(q,r){if(this.props.interpolator)return this.props.interpolator(q,r);else return c("React").createElement(c("Link.react"),{href:r.entity},q)}.bind(this),m}k.prototype.render=function(){return c("React").createElement(c("BaseTextWithEntities.react"),babelHelpers["extends"]({},this.props,{aggregatedRanges:this.props.aggregatedRanges,imageRanges:this.props.imageRanges,metaRanges:this.props.metaRanges,rangeRenderer:this.$MessengerTextWithEntities2,ranges:this.props.ranges,text:this.props.text,textRenderer:this.$MessengerTextWithEntities1}))};f.exports=k}),null);
__d("EventReminderConstants",[],(function a(b,c,d,e,f,g){"use strict";var h=Object.freeze({INITIAL:"initial",GOING:"going",WATCHED:"watched",UNWATCHED:"unwatched"}),i=Object.freeze({ASSOCIATED_EVENT:"ASSOCIATED_EVENT"}),j=Object.freeze({GOING:"GOING",DECLINED:"DECLINED",INVITED:"INVITED"}),k=Object.freeze({NO_ERROR:"NO_ERROR",PAST_TIME:"PAST_TIME",AFTER_ONE_YEAR:"AFTER_ONE_YEAR"});f.exports={EventGuestStates:h,EventPlanType:i,GuestStates:j,TimeErrorType:k}}),null);
__d("IgnoreMessagesTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:IgnoreMessagesLoggerConfig",this.$IgnoreMessagesTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:IgnoreMessagesLoggerConfig",this.$IgnoreMessagesTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:IgnoreMessagesLoggerConfig",this.$IgnoreMessagesTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$IgnoreMessagesTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$IgnoreMessagesTypedLogger1)};h.prototype.updateData=function(j){this.$IgnoreMessagesTypedLogger1=babelHelpers["extends"]({},this.$IgnoreMessagesTypedLogger1,j);return this};h.prototype.setEvent=function(j){this.$IgnoreMessagesTypedLogger1.event=j;return this};h.prototype.setPlatform=function(j){this.$IgnoreMessagesTypedLogger1.platform=j;return this};h.prototype.setThreadID=function(j){this.$IgnoreMessagesTypedLogger1.thread_id=j;return this};h.prototype.setVC=function(j){this.$IgnoreMessagesTypedLogger1.vc=j;return this};var i={event:true,platform:true,thread_id:true,vc:true};f.exports=h}),null);
__d("MercurySyncHolesTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$MercurySyncHolesTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$MercurySyncHolesTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$MercurySyncHolesTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$MercurySyncHolesTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$MercurySyncHolesTypedLogger1)};h.prototype.updateData=function(j){this.$MercurySyncHolesTypedLogger1=babelHelpers["extends"]({},this.$MercurySyncHolesTypedLogger1,j);return this};h.prototype.setDifference=function(j){this.$MercurySyncHolesTypedLogger1.difference=j;return this};h.prototype.setSeqID=function(j){this.$MercurySyncHolesTypedLogger1.seq_id=j;return this};h.prototype.setTopicType=function(j){this.$MercurySyncHolesTypedLogger1.topic_type=j;return this};h.prototype.setVC=function(j){this.$MercurySyncHolesTypedLogger1.vc=j;return this};var i={difference:true,seq_id:true,topic_type:true,vc:true};f.exports=h}),null);
__d("MqttWsClientTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$MqttWsClientTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$MqttWsClientTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$MqttWsClientTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$MqttWsClientTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$MqttWsClientTypedLogger1)};h.prototype.updateData=function(j){this.$MqttWsClientTypedLogger1=babelHelpers["extends"]({},this.$MqttWsClientTypedLogger1,j);return this};h.prototype.setDeltasInBatch=function(j){this.$MqttWsClientTypedLogger1.deltas_in_batch=j;return this};h.prototype.setFirstSeqID=function(j){this.$MqttWsClientTypedLogger1.first_seq_id=j;return this};h.prototype.setLastSeqID=function(j){this.$MqttWsClientTypedLogger1.last_seq_id=j;return this};h.prototype.setSeqID=function(j){this.$MqttWsClientTypedLogger1.seq_id=j;return this};h.prototype.setVC=function(j){this.$MqttWsClientTypedLogger1.vc=j;return this};var i={deltas_in_batch:true,first_seq_id:true,last_seq_id:true,seq_id:true,vc:true};f.exports=h}),null);
__d("MercuryMessageClientState",[],(function a(b,c,d,e,f,g){var h=Object.freeze({DO_NOT_SEND_TO_SERVER:"do_not_send_to_server",SEND_TO_SERVER:"send_to_server"});f.exports=h}),null);
__d("MercuryActionType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({LOG_MESSAGE:"ma-type:log-message",USER_GENERATED_MESSAGE:"ma-type:user-generated-message",ADD_GROUP_ADMINS:"ma-type:add_group_admins",REMOVE_GROUP_ADMINS:"ma-type:remove_group_admins",CHANGE_READ_STATUS:"ma-type:change_read_status",MARK_THREAD_SEEN:"ma-type:mark_thread_seen",CHANGE_MUTE_SETTINGS:"ma-type:change-mute-settings",SEND_MESSAGE:"ma-type:send-message",DELETE_MESSAGES:"ma-type:delete-messages",DELETE_THREAD:"ma-type:delete-thread",UPDATE_SNIPPET:"ma-type:update-snippet",CHANGE_ARCHIVED_STATUS:"ma-type:change-archived-status",CHANGE_PAGE_FOLLOW_UP_STATUS:"ma-type:change-page-follow-up-status",CHANGE_FOLDER:"ma-type:change-folder",ADD_PARTICIPANTS:"ma-type:add-participants",CANCEL_ATTACHMENT_PLACEHOLDER:"ma-type:cancel-attachment-placeholder",CONFIRM_ATTACHMENT_PLACEHOLDER:"ma-type:confirm-attachment-placeholder",CHANGE_FLAG:"ma-type:change_flag",MOVE_PENDING_TO_INBOX:"ma-type:move_pending_to_inbox",CREATE_PAGE_ADMIN_NOTE:"ma-type:create-page-admin-note",REPLACE_MESSAGE:"ma-type:replace-message",UPDATE_CUSTOM_LIKE:"ma-type:update_custom_like",UNWRAP_MESSAGE:"ma-type:unwrap-message",JOINABLE_MODE:"ma-type:joinable-mode",APPROVAL_MODE:"ma-type:approval-mode",APPROVAL_QUEUE:"ma-type:approval-queue",IS_PIN_PROTECTED:"ma-type:is_pin_protected",REACTION_UPDATE:"ma-type:reaction-update",LIVE_LOCATION_UPDATE:"ma-type:live-location-update",UPDATE_RTC_CALL_DATA:"ma-type:update-rtc-call-data",UPDATE_COMM_STATUS:"ma-type:update-comm-status",EVENT_RSVP_CHANGED:"ma-type:event-rsvp-changed",BLOCK_STATUS_CHANGED:"ma-type:block-status-changed",UPDATE_COMM_ITEM_OWNER:"ma-type:update-comm-item-owner",MONTAGE_DIRECT_EXPIRE:"ma-type:montage-direct-expire",GROUPS_SYNC_STATUS_CHANGED:"ma-type:groups-sync-status-changed",GROUPS_SYNC_METADATA_UPDATE:"ma-type:groups-sync-metadata-update"})}),null);
__d("MercurySingletonMixin",["CurrentUser"],(function a(b,c,d,e,f,g){__p&&__p();var h={_getInstances:function i(){if(!this._instances)this._instances={};return this._instances},get:function i(){return this.getForFBID(c("CurrentUser").getID())},getForFBID:function i(j){var k=this._getInstances();if(!k[j])k[j]=new this(j);return k[j]}};f.exports=h}),null);
__d("MercuryMessageActions",["Bootloader","ChatConfig","MercuryActionType","MercuryDispatcher","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){this.$MercuryMessageActions1=i;this.$MercuryMessageActions2=c("MercuryMessageObject").getForFBID(this.$MercuryMessageActions1);this.__serverRequests=c("MercuryServerRequests").getForFBID(this.$MercuryMessageActions1);this.__dispatcher=c("MercuryDispatcher").getForFBID(this.$MercuryMessageActions1)}h.prototype.send=function(i,j,k){j=j||Function.prototype;this.$MercuryMessageActions2.normalizeNewMessage(i);this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload(babelHelpers["extends"]({},i),c("MercuryPayloadSource").CLIENT_SEND_MESSAGE));this.__serverRequests.sendNewMessage(i,k);j(i.thread_id)};h.prototype.resend=function(i,j){var k=babelHelpers["extends"]({},i);this.$MercuryMessageActions2.normalizeResendMessage(k);this.send(k,undefined,j)};h.prototype.addAttachmentPlaceholder=function(i,j,k){this.$MercuryMessageActions2.normalizeAddAttachmentPlaceholder(i,j,k);this.$MercuryMessageActions2.normalizeNewMessage(i);this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload(babelHelpers["extends"]({},i),c("MercuryPayloadSource").CLIENT_SEND_MESSAGE))};h.prototype.cancelAttachmentPlaceholder=function(i,j){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({upload_id:i,upload_data:j,action_type:c("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER},c("MercuryPayloadSource").CLIENT_SEND_MESSAGE))};h.prototype.confirmAttachmentPlaceholder=function(i,j){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({upload_id:i,upload_data:j,action_type:c("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER},c("MercuryPayloadSource").CLIENT_SEND_MESSAGE))};h.prototype["delete"]=function(i,j,k){this.__dispatcher.handleUpdate(this.$MercuryMessageActions3(i,j,c("MercuryActionType").DELETE_MESSAGES,k||c("MercuryPayloadSource").CLIENT_DELETE_MESSAGES))};h.prototype.unwrap=function(i){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({thread_id:i.thread_id,unwrapped_message_id:i.message_id,action_type:c("MercuryActionType").UNWRAP_MESSAGE},c("MercuryPayloadSource").CLIENT_UNWRAP_MESSAGE))};h.prototype.__constructClientSingleMessagePayload=function(i,j){return{actions:[i],from_client:true,payload_source:j}};h.prototype.$MercuryMessageActions4=function(i,j){return{actions:[i],from_client:false,payload_source:j}};h.prototype.$MercuryMessageActions3=function(i,j,k,l){return{actions:[{action_type:k,thread_id:i,message_ids:j}],from_client:true,payload_source:l}};Object.assign(h,c("MercurySingletonMixin"));f.exports=h}),null);
__d("EmojiLikeConstants",["EmojiStaticConfig"],(function a(b,c,d,e,f,g){"use strict";var h=c("EmojiStaticConfig").sizeMap,i=Object.freeze({XSMALL:"xsmall",SMALL:"small",MEDIUM:"medium",LARGE:"large"}),j={dp16:"xsmall",dp32:"small",dp64:"medium",db64:"medium",dp128:"large"},k=Object.freeze({PICKER:"picker",HOT_LIKE:"hot_like"}),l=[983040],m="hot_emoji_source",n="hot_emoji_size",o="emoji_like",p="\ud83d\udc4d",q=[128077];f.exports={FB_THUMBS_UP_EMOJI:l,size:i,sizeMap:h,sizeMapTransfer:j,source:k,SOURCE_TAG_PREFIX:m,TAG_PREFIX_NEW:n,TAG_PREFIX_OLD:o,THUMBS_UP_EMOJI:p,THUMBS_UP_EMOJI_CODES:q}}),null);
__d("MercuryLogMessageType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SUBSCRIBE:"log:subscribe",UNSUBSCRIBE:"log:unsubscribe",VIDEO_CALL:"log:video-call",PHONE_CALL:"log:phone-call",THREAD_NAME:"log:thread-name",THREAD_IMAGE:"log:thread-image",SERVER_ERROR:"log:error-msg",LIVE_LISTEN:"log:live-listen",WALLPAPER:"log:wallpaper",ORION:"log:orion",SWITCH_TO_WORK:"log:switch",PAGE_REPLY:"log:page-reply",GENERIC_ADMIN_TEXT:"log:generic-admin-text"})}),null);
__d("MercurySourceType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CHAT_ORCA:"source:chat:orca",CHAT_LIGHT_SPEED:"source:chat:light_speed",CHAT_IPHONE:"source:chat:iphone",CHAT_JABBER:"source:chat:jabber",CHAT_MEEBO:"source:chat:meebo",CHAT_WEB:"source:chat:web",CHAT_TEST:"source:chat:test",CHAT_FORWARD_DIALOG:"source:chat:forward",CHAT:"source:chat",CONTACT_ADD_MUTATION:"source:contact_add:graphql_mutation",CONTACT_ADD_CYMK:"source:contact_add:cymk_suggestion",CUSTOMER_CHAT_PLUGIN:"source:discovery:customer_chat_plugin",EMAIL:"source:email",EVENT_MESSAGE_BLAST:"source:event_message_blast",EVENT_TICKETING:"source:event_ticket",EVENT_REMINDERS:"source:event_reminders",FUNDRAISER_MESSAGE_BLAST:"source:fundraiser_message_blast",GENERIC_ADMIN_TEXT:"source:generic_admin_text",GIGABOXX_API:"source:gigaboxx:api",GIGABOXX_BLAST:"source:gigaboxx:blast",GIGABOXX_EMAIL_REPLY:"source:gigaboxx:emailreply",GIGABOXX_MOBILE:"source:gigaboxx:mobile",GIGABOXX_WAP:"source:gigaboxx:wap",GIGABOXX_WEB:"source:gigaboxx:web",INVITE:"source:invite",LEIA:"source:leia",MESSENGER_WEB:"source:messenger:web",MESSENGER_WEB_SEARCH:"source:messenger:web_search",SAM_UFI:"source:sam:ufi",SHARE_DIALOG:"source:share:dialog",SEND_PLUGIN:"source:sendplugin",SMS:"source:sms",TEST:"source:test",TITAN_WAP:"source:titan:wap",TITAN_M_BASIC:"source:titan:m_basic",TITAN_M_FREE:"source:titan:m_free_basic",TITAN_M_JAPAN:"source:titan:m_japan",TITAN_M_MINI:"source:titan:m_mini",TITAN_M_TOUCH:"source:titan:m_touch",TITAN_M_APP:"source:titan:m_app",TITAN_M_TABLET:"source:titan:m_tablet",TITAN_M_ZERO:"source:titan:m_zero",TITAN_M_TALK:"source:titan:m_talk",TITAN_WEB:"source:titan:web",TITAN_FACEWEB_ANDROID:"source:titan:faceweb_android",TITAN_FACEWEB_BUFFY:"source:titan:faceweb_buffy",TITAN_FACEWEB_IPAD:"source:titan:faceweb_ipad",TITAN_FACEWEB_IPHONE:"source:titan:faceweb_iphone",TITAN_FACEWEB_UNKNOWN:"source:titan:faceweb_unknown",TITAN_API:"source:titan:api",TITAN_API_MOBILE:"source:titan:api_mobile",TITAN_ORCA:"source:titan:orca",TITAN_EMAIL_REPLY:"source:titan:emailreply",MOBILE:"source:mobile",PAGE_PLATFORM_API:"source:page_platform_api",PAGE_UNIFIED_INBOX:"source:page_unified_inbox",UNKNOWN:"source:unknown",WEB:"source:web",HELPCENTER:"source:helpcenter",NEW_SHARE_DIALOG:"source:share:dialog:new",PAID_PROMOTION:"source:paid_promotion",BUFFY_SMS:"source:buffy:sms",WEBRTC_MOBILE:"source:webrtc:mobile",MESSENGER_COMMERCE:"source:messenger:commerce",MESSENGER_BOT:"source:bot",MESSENGER_EMPLOYEE_ONLY_BOT:"source:bot:employee_only",MESSENGER_OMNIM:"source:messenger:omnim",PAGES_PRIVATE_REPLY:"source:pages:private_reply",MESSENGER_FORWARD_DIALOG:"source:messenger:forward",MESSENGER_AD:"source:messenger:ad",MARKETPLACE:"source:marketplace",MARKETPLACE_BOT:"source:marketplace:bot",MESSENGER_LEAD_GEN:"source:messenger:lead_gen",PAGES_MESSAGE_SHORTLINK:"source:pages:message_shortlink",STICKER_SUBSCRIBE:"source:messenger:sticker_subscribe",PHOTO_TAG:"source:messenger:photo_tag",INTERNAL_TEST_PENDING:"source:internal:test_pending",JOB_SEARCH_APPLICATION:"source:job_search:application",MESSENGER_JOINABLE_LINK:"source:messenger:joinable_link",MESSENGER_ADD_WITH_APPROVAL:"source:messenger:add_with_approval",MESSENGER_SMS_BRIDGE_CONVERT:"source:messenger:sms_bridge_conversion",TINCAN_ORCA:"source:tincan:orca",TINCAN_IOS:"source:tincan:ios",TINCAN_UNKNOWN:"source:tincan:unknown",FACEBOOK_GROUPS_CHANNELS:"source:groups:channels",GROUP_COMMERCE:"source:group_commerce",INTERNAL_TOOL:"source:internal:tool",PAGES_PLATFORM:"source:pages:platform",PAGES_RECOMMENDATION:"source:pages:recommendation",PAGES_ORDER_MANAGEMENT:"source:pages:order_management",PAGE_AUTO_RESPONSE:"source:pages:auto_response",PAGES_INVITE:"source:pages:invite",PAGES_CHAT_EXTENSION:"source:pages:chat_extension",SAVED_CHAT_EXTENSION:"source:saved:chat_extension",CREATOR_PAGE_INITIATE_TO_CREATOR_PAGE:"source:pages:creator_page_initiate_to_creator_page",LIVE_VIDEO_CHAT:"source:live_video_chat",GEMSTONE:"source:gemstone",FRIENDING_ADMIN_BUMP:"source:messenger_growth:friending_admin_bump",NEW_MESSENGER_USER_ADMIN_BUMP:"source:messenger_growth:new_messenger_user_admin_bump",EVENT_UPCOMING_BUMP:"source:messenger_growth:event_upcoming_bump",PHOTO_TAG_BUMP:"source:messenger_growth:photo_tag_bump",WALL_POST_BUMP:"source:messenger_growth:wall_post_bump",CUSTOMIZATION_UPSELL_BUMP:"source:messenger_growth:customization_upsell_bump",PAGE_COMMENT_MSG:"source:pages:question_triggered_convo",COMMENT_PIVOT:"source:messenger_growth:comment_pivot",PAGE_HOVERCARD:"source:pages:hovercard",INSTANT_GAMES:"source:instant_games",PAGE_EMAIL_REPLY:"source:pages:email_reply",PAGE_HOME_PAGE_PANEL:"source:page_home_page_panel",GROUPSYNC_MESSENGER_GROUP_CREATE:"source:groupsync:messenger_group_create",GROUPSYNC_SYNC_FROM_FB:"source:groupsync:sync_from_fb",GROUPSYNC_NAMING:"source:groupsync:naming",GROUPSYNC_THREAD_INFO_SYNC_FROM_FB:"source:groupsync:thread_info_sync",WORK_GROUP_SYNCED_CHAT_CREATION:"source:work:groupchat:creation",PAGE_PQI_MESSAGE:"source:pages:pqi_message",PAGE_PLUGIN_MESSAGE:"source:pages:page_plugin_message"})}),null);
__d("MercuryAssert",["MercuryIDs"],(function a(b,c,d,e,f,g){__p&&__p();f.exports={isParticipantID:function h(i){if(!c("MercuryIDs").isValid(i))throw new Error("bad_participant_id "+i)},allParticipantIDs:function h(i){i.forEach(this.isParticipantID)},isUserParticipantID:function h(i){var j=c("MercuryIDs").tokenize(i);if(j.type!="fbid")throw new Error("bad_user_id "+i)},isEmailParticipantID:function h(i){var j=c("MercuryIDs").tokenize(i);if(j.type!="email")throw new Error("bad_email_id "+i)},allThreadID:function h(i){i.forEach(this.isThreadID)},isThreadID:function h(i){if(!c("MercuryIDs").isValid(i))throw new Error("bad_thread_id "+i)}}}),null);
__d("MercuryViewer",["CurrentUser","MercuryAssert"],(function a(b,c,d,e,f,g){"use strict";var h="fbid:"+c("CurrentUser").getID(),i={getID:function j(){return h},isViewer:function j(k){c("MercuryAssert").isParticipantID(k);return k===h}};f.exports=i}),null);
__d("XChatRemoveParticipantAsyncController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/chat/remove_participants/",{elem_id:{type:"String"},uid:{type:"Int"},tid:{type:"String"}})}),null);
__d("XGroupsJoinChatController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groups/join_chat/",{link_hash:{type:"String"}})}),null);
__d("XMercuryThreadLikeIconController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/mercury/like_icon/",{emoji:{type:"String",defaultValue:""}})}),null);
__d("XMessagingBlockMessagesController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/block_messages/",{})}),null);
__d("XMessagingGroupJoinThroughHashController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/join_through_hash/",{link_hash:{type:"String"}})}),null);
__d("XMessagingGroupJoinThroughPrivateLinkController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/join_through_invite/",{link_hash:{type:"String"}})}),null);
__d("XMessagingGroupJoinableAcceptController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/joinable_accept/",{thread_fbid:{type:"String"},user_id:{type:"Int"}})}),null);
__d("XMessagingGroupJoinableInviteController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/joinable_invite/",{thread_fbid:{type:"String"},user_ids:{type:"IntSet"}})}),null);
__d("XMessagingGroupJoinableRejectController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/joinable_reject/",{thread_fbid:{type:"String"},user_id:{type:"Int"}})}),null);
__d("XMessagingGroupSetApprovalController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/set_approval_mode/",{set_mode:{type:"Enum",enumType:0},thread_fbid:{type:"String"}})}),null);
__d("XMessagingSaveAdminsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/save_admins/",{elem_id:{type:"String"},parent_elem_id:{type:"String"},thread_fbid:{type:"String"},admin_ids:{type:"FBIDSet"},add:{type:"Bool",defaultValue:false}})}),null);
__d("XMessagingSaveNicknameController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/save_thread_nickname/",{source:{type:"Enum",required:true,enumType:1}})}),null);
__d("XMessagingSaveThreadColorController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/save_thread_color/",{source:{type:"Enum",required:true,enumType:1}})}),null);
__d("XMessagingSaveThreadEmojiController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/save_thread_emoji/",{source:{type:"Enum",required:true,enumType:1}})}),null);
__d("XMessagingUnblockMessagesController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/unblock_messages/",{})}),null);
__d("XNFXIgnoreMessagesActionController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/nfx/ignore_messages/",{thread_fbid:{type:"Int",required:true},location:{type:"Enum",required:true,enumType:1},__asyncDialog:{type:"Int"}})}),null);
__d("XNFXMessengerBlockActionController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/nfx/block_messages/",{thread_fbid:{type:"Int",required:true},location:{type:"Enum",required:true,enumType:1},__asyncDialog:{type:"Int"}})}),null);
__d("MercuryThreadActions",["cssVar","AsyncDialog","AsyncRequest","EmojiLikeConstants","IgnoreMessagesTypedLogger","MercuryActionType","MercuryAPIArgsSource","MercuryDispatcher","MercuryIDs","MercuryLogMessageType","MercuryMessengerBlockingUtils","MercuryPayloadSource","MercuryParticipants","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonMixin","MercurySourceType","MercuryThreadIDMap","MercuryThreads","MercuryViewer","MercuryMessageActions","MessengerActions","MercuryMessageObject","MessagingTag","PageCommItemStatus","ReloadPage","URI","XChatRemoveParticipantAsyncController","XGroupsJoinChatController","XMercuryThreadLikeIconController","XMessagingGroupJoinableAcceptController","XMessagingGroupJoinableInviteController","XMessagingGroupJoinableRejectController","XMessagingGroupJoinThroughHashController","XMessagingGroupJoinThroughPrivateLinkController","XMessagingGroupSetApprovalController","XMessagingSaveAdminsController","XMessagingSaveNicknameController","XMessagingSaveThreadColorController","XMessagingSaveThreadEmojiController","XNFXMessengerBlockActionController","XMessagingBlockMessagesController","XMessagingUnblockMessagesController","XNFXIgnoreMessagesActionController","ex"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("MercuryThreadIDMap").get(),j=c("MercuryThreads").get(),k=c("MercuryMessageActions").get(),l=c("MercuryMessageObject").get();function m(n){this.$MercuryThreadActions1=n;this.__serverRequests=c("MercuryServerRequests").getForFBID(this.$MercuryThreadActions1);this.__dispatcher=c("MercuryDispatcher").getForFBID(this.$MercuryThreadActions1);this.__payloadPreprocessor=c("MercuryServerPayloadPreprocessor").getForFBID(this.$MercuryThreadActions1)}m.prototype.markRead=function(n,o){this.batchMarkRead([n],o)};m.prototype.batchMarkRead=function(n,o){this.__dispatcher.handleUpdate(this.$MercuryThreadActions2(n,true,o))};m.prototype.markUnread=function(n,o){this.batchMarkUnread([n],o)};m.prototype.batchMarkUnread=function(n,o){this.__dispatcher.handleUpdate(this.$MercuryThreadActions2(n,false,o))};m.prototype.markSeen=function(n,o){this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").MARK_THREAD_SEEN,c("MercuryPayloadSource").CLIENT_MARK_THREAD_SEEN,{persistent:o}))};m.prototype.archive=function(n,o){this.batchArchive([n],o)};m.prototype.batchArchive=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadArchivedStatus(p,true,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions3(n,true))};m.prototype.unarchive=function(n,o){this.batchUnarchive([n],o)};m.prototype.batchUnarchive=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadArchivedStatus(p,false,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions3(n,false))};m.prototype.markPageFollowUp=function(n,o){this.batchMarkPageFollowUp([n],o)};m.prototype.batchMarkPageFollowUp=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadPageFollowUpStatus(p,true,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions4(n,true))};m.prototype.unmarkPageFollowUp=function(n,o){this.batchUnmarkPageFollowUp([n],o)};m.prototype.batchUnmarkPageFollowUp=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadPageFollowUpStatus(p,false,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions4(n,false))};m.prototype.markSpam=function(n,o){this.batchMarkSpam([n],o)};m.prototype.batchMarkSpam=function(n,o){n.forEach(function(p){this.__serverRequests.markThreadSpam(p,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions5(n,c("MessagingTag").SPAM))};m.prototype.unmarkSpam=function(n,o){this.batchUnmarkSpam([n],o)};m.prototype.batchUnmarkSpam=function(n,o){n.forEach(function(p){this.__serverRequests.unmarkThreadSpam(p,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions5(n,c("MessagingTag").INBOX))};m.prototype.changeFolder=function(n,o){this.batchChangeFolder([n],o)};m.prototype.batchChangeFolder=function(n,o){n.forEach(function(p){this.__serverRequests.changeThreadFolder(p,o)}.bind(this));this.__dispatcher.handleUpdate(this.$MercuryThreadActions5(n,o))};m.prototype["delete"]=function(n,o){this.batchDelete([n],o)};m.prototype.batchDelete=function(n,o){this.__serverRequests.deleteThreads(n,o);this.__dispatcher.handleUpdate(this.__constructClientPayload(n,c("MercuryActionType").DELETE_THREAD,c("MercuryPayloadSource").CLIENT_DELETE_THREAD))};m.prototype.unmute=function(n){this.updateMuteSetting(n,0)};m.prototype.updateMuteSetting=function(n,o){this.__serverRequests.changeMutingOnThread(n,o);this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").CHANGE_MUTE_SETTINGS,c("MercuryPayloadSource").CLIENT_CHANGE_MUTE_SETTINGS,{mute_until:o}))};m.prototype.updateMentionsMuteSetting=function(n,o){var p=o?1:0;this.__serverRequests.changeMentionsMutingOnThread(n,p);this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").CHANGE_MUTE_SETTINGS,c("MercuryPayloadSource").CLIENT_CHANGE_MUTE_SETTINGS,{mentions_mute_mode:p}))};m.prototype.updateReactionsMuteSetting=function(n,o){var p=o?1:0;this.__serverRequests.changeReactionsMutingOnThread(n,p);this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").CHANGE_MUTE_SETTINGS,c("MercuryPayloadSource").CLIENT_CHANGE_MUTE_SETTINGS,{reactions_mute_mode:p}))};m.prototype.blockMessages=function(n,o){__p&&__p();var p="";j.getThreadMeta(n,function(r){var s=c("MercuryParticipants").getNow(c("MercuryIDs").getParticipantIDFromUserID(r.other_user_fbid));p=s&&s.short_name});var q=c("XNFXMessengerBlockActionController").getURIBuilder().setInt("thread_fbid",c("MercuryIDs").getUserIDFromThreadID(n)).setEnum("location","www_chat_head").getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(q),function(r){r.subscribe("confirm",function(){r.hide();o&&o(p);this.changeFolder(n,c("MessagingTag").OTHER)}.bind(this))}.bind(this))};m.prototype.unblockMessages=function(n){var o=c("MercuryIDs").getUserIDFromThreadID(n);if(o===null)throw new Error(c("ex")("Expected user ID to unblock messages for, got null"));var p=JSON.stringify({reportable_ent_token:o,initial_action_name:c("MercuryMessengerBlockingUtils").block_messages});new(c("AsyncRequest"))(new(c("URI"))("/ajax/nfx/messenger_undo_block").addQueryData({story_location:"messenger",context:p})).send();this.changeFolder(n,c("MessagingTag").INBOX)};m.prototype.ignoreMessages=function(n,o){var p=c("XNFXIgnoreMessagesActionController").getURIBuilder().setInt("thread_fbid",n).setEnum("location","www_chat_head").getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(p))};m.prototype.blockOnMessengerDotCom=function(n){var o=c("XMessagingBlockMessagesController").getURIBuilder().getURI();new(c("IgnoreMessagesTypedLogger"))().setEvent("block_confirmed").setThreadID(c("MercuryIDs").getThreadFBIDFromThreadID(n)).setPlatform("messengerdotcom").log();new(c("AsyncRequest"))(o).setMethod("POST").setData({fbid:c("MercuryIDs").getUserIDFromThreadID(n)}).send()};m.prototype.blockIgnoreOnMessengerDotCom=function(n,o,p){n&&c("MessengerActions").selectThread(null);this.changeFolder(o,c("MessagingTag").OTHER);this.blockOnMessengerDotCom(o);p&&p()};m.prototype.unblockOnMessengerDotCom=function(n){var o=c("XMessagingUnblockMessagesController").getURIBuilder().getURI();new(c("AsyncRequest"))(o).setMethod("POST").setData({fbid:c("MercuryIDs").getUserIDFromThreadID(n)}).send();this.changeFolder(n,c("MessagingTag").INBOX)};m.prototype.leaveGroup=function(n){if(!j.isEmptyLocalThread(n))k.send(l.constructLogMessageObject(c("MercurySourceType").TITAN_WEB,n,c("MercuryLogMessageType").UNSUBSCRIBE,{removed_participants:[c("MercuryViewer").getID()]}),null,c("MercuryAPIArgsSource").WEBMESSENGER)};m.prototype.removeFromGroup=function(n,o){if(!j.isEmptyLocalThread(n)){var p=c("XChatRemoveParticipantAsyncController").getURIBuilder().getURI(),q={tid:n,uid:o};new(c("AsyncRequest"))(p).setMethod("POST").setData(q).send()}};m.prototype.changeThreadColor=function(n,o,p){if(j.isEmptyLocalThread(n))return;i.getServerIDFromClientID(n,function(q){var r={};if(o!="#0084ff")r.color_choice=o;r.thread_or_other_fbid=q;var s=c("XMessagingSaveThreadColorController").getURIBuilder().setEnum("source",p).getURI();new(c("AsyncRequest"))(s).setMethod("POST").setData(r).send()})};m.prototype.changeThreadEmoji=function(n,o,p){if(j.isEmptyLocalThread(n))return;i.getServerIDFromClientID(n,function(q){var r={},s=String.fromCodePoint.apply(String,o);if(s!==String.fromCodePoint(c("EmojiLikeConstants").FB_THUMBS_UP_EMOJI)&&s!==String.fromCodePoint(c("EmojiLikeConstants").THUMBS_UP_EMOJI_CODES))r.emoji_choice=s;r.thread_or_other_fbid=q;var t=c("XMessagingSaveThreadEmojiController").getURIBuilder().setEnum("source",p).getURI();new(c("AsyncRequest"))(t).setMethod("POST").setData(r).send()})};m.prototype.changeThreadNicknames=function(n,o,p,q){if(j.isEmptyLocalThread(n))return;i.getServerIDFromClientID(n,function(r){var s={thread_or_other_fbid:r,participant_id:o,nickname:p},t=c("XMessagingSaveNicknameController").getURIBuilder().setEnum("source",q).getURI();new(c("AsyncRequest"))(t).setMethod("POST").setData(s).send()})};m.prototype.setApprovalMode=function(n,o){var p=c("XMessagingGroupSetApprovalController").getURIBuilder().getURI();new(c("AsyncRequest"))(p).setMethod("POST").setData({set_mode:n,thread_fbid:o.thread_fbid}).send()};m.prototype.changeGroupAdmins=function(n,o,p){var q={thread_fbid:n,admin_ids:o,add:p},r=c("XMessagingSaveAdminsController").getURIBuilder().getURI();new(c("AsyncRequest"))(r).setMethod("POST").setData(q).send()};m.prototype.joinThroughHash=function(n){var o={link_hash:n},p=c("XMessagingGroupJoinThroughHashController").getURIBuilder().getURI();new(c("AsyncRequest"))(p).setMethod("POST").setData(o).send()};m.prototype.joinThroughPrivateLink=function(n){var o={link_hash:n},p=c("XMessagingGroupJoinThroughPrivateLinkController").getURIBuilder().getURI();new(c("AsyncRequest"))(p).setMethod("POST").setData(o).send()};m.prototype.chatJoinThroughHash=function(n){var o={link_hash:n},p=c("XGroupsJoinChatController").getURIBuilder().getURI();new(c("AsyncRequest"))(p).setMethod("POST").setData(o).setHandler(function(q){return c("ReloadPage").now()}).send()};m.prototype.inviteToJoinableGroup=function(n,o){var p={thread_fbid:n,user_ids:o},q=c("XMessagingGroupJoinableInviteController").getURIBuilder().getURI();new(c("AsyncRequest"))(q).setMethod("POST").setData(p).send()};m.prototype.acceptToJoinableGroup=function(n,o){var p={thread_fbid:n,user_id:o},q=c("XMessagingGroupJoinableAcceptController").getURIBuilder().getURI();new(c("AsyncRequest"))(q).setMethod("POST").setData(p).send()};m.prototype.rejectToJoinableGroup=function(n,o){var p={thread_fbid:n,user_id:o},q=c("XMessagingGroupJoinableRejectController").getURIBuilder().getURI();new(c("AsyncRequest"))(q).setMethod("POST").setData(p).send()};m.prototype.addParticipants=function(n,o){this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").ADD_PARTICIPANTS,c("MercuryPayloadSource").CLIENT_ADD_PARTICIPANTS,{participants:o}))};m.prototype.updateCustomLike=function(n,o){var p=c("XMercuryThreadLikeIconController").getURIBuilder().setString("emoji",o).getURI();new(c("AsyncRequest"))().setURI(p).setHandler(function(q){this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").UPDATE_CUSTOM_LIKE,c("MercuryPayloadSource").CLIENT_CHANGE_CUSTOM_LIKE,{custom_like:q.getPayload()}))}.bind(this)).send()};m.prototype.movePendingToInbox=function(n){this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").MOVE_PENDING_TO_INBOX,c("MercuryPayloadSource").CLIENT_MOVE_PENDING_TO_INBOX))};m.prototype.updateSnippet=function(n,o){this.__dispatcher.handleUpdate(this.__constructClientPayload([n],c("MercuryActionType").UPDATE_SNIPPET,c("MercuryPayloadSource").CLIENT_UPDATE_SNIPPET,{deleted_ids:o}))};m.prototype.updateCommStatus=function(n,o){this.__dispatcher.handleUpdate(this.$MercuryThreadActions6(n,o));var p=o===c("PageCommItemStatus").DONE;this.__dispatcher.handleUpdate(this.$MercuryThreadActions3(n,p))};m.prototype.updateCommItemOwner=function(n,o,p,q){this.__dispatcher.handleUpdate(this.$MercuryThreadActions7(n,o,p,q))};m.prototype.$MercuryThreadActions2=function(n,o,p){return this.__constructClientPayload(n,c("MercuryActionType").CHANGE_READ_STATUS,c("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS,{mark_as_read:o,source:p})};m.prototype.$MercuryThreadActions7=function(n,o,p,q){return this.__constructClientPayload(n,c("MercuryActionType").UPDATE_COMM_ITEM_OWNER,c("MercuryPayloadSource").UPDATE_COMM_ITEM_OWNER,{id:p,name:o,profile_pic_uri:q})};m.prototype.$MercuryThreadActions3=function(n,o){return this.__constructClientPayload(n,c("MercuryActionType").CHANGE_ARCHIVED_STATUS,c("MercuryPayloadSource").CLIENT_CHANGE_ARCHIVED_STATUS,{archived:o})};m.prototype.$MercuryThreadActions4=function(n,o){return this.__constructClientPayload(n,c("MercuryActionType").CHANGE_PAGE_FOLLOW_UP_STATUS,c("MercuryPayloadSource").CLIENT_CHANGE_PAGE_FOLLOW_UP_STATUS,{is_page_follow_up:o})};m.prototype.$MercuryThreadActions6=function(n,o){return this.__constructClientPayload(n,c("MercuryActionType").UPDATE_COMM_STATUS,c("MercuryPayloadSource").CLIENT_UPDATE_COMM_STATUS,{comm_status:o})};m.prototype.$MercuryThreadActions5=function(n,o){return this.__constructClientPayload(n,c("MercuryActionType").CHANGE_FOLDER,c("MercuryPayloadSource").CLIENT_CHANGE_FOLDER,{new_folder:o})};m.prototype.__constructClientPayload=function(n,o,p,q){return{actions:n.map(function(r){return babelHelpers["extends"]({action_type:o,thread_id:r},q)}),from_client:true,payload_source:p}};Object.assign(m,c("MercurySingletonMixin"));f.exports=m}),null);
__d("MercuryTypeaheadConstants",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:8,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_MESSENGER_ONLY_CONTACT_MAX:4,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:5,COMPOSER_WM_MAX:23,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",SEARCH_TYPE:"search",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game",WORKPLACE_BOT_CATEGORY_TYPE:"WORKPLACE_BOT",VALID_EMAIL:"^([A-Z0-9._%+-]+@((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._%+-]+[A-Z0-9._%+-]*)|([A-Z0-9._%+-]+[A-Z._%+-]+[A-Z0-9._%+-]*))@(?:facebook\\.com))$"})}),null);
__d("MessengerDispatcher",["Dispatcher_DEPRECATED"],(function a(b,c,d,e,f,g){"use strict";f.exports=new(c("Dispatcher_DEPRECATED"))()}),null);
__d("MessengerActions",["invariant","Bootloader","EventProfiler","LogHistory","MercuryIDs","MercuryTypeaheadConstants","MessengerDispatcher","MessengerURISerializer","MessengerView","URI","goURI","keyMirror"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("keyMirror")({CANCEL_FILE_UPLOAD:null,EMPTY_FILES:null,LINK_PREVIEW:null,LOADED_SHARE_DATA:null,LOADING_SHARE_DATA:null,REMOVE_SHARE_PREVIEW:null,PREPARE_FILES_FOR_SEND:null,REPLACE_STATE:null,SELECT_THREAD:null,UPDATE_MDOT_ME:null,UPDATE_THREAD_TAG:null,UPLOAD_FILE_FAILED:null,UPLOADED_FILE:null}),j=c("LogHistory").getInstance("messenger_actions"),k={Types:i,changeDetailView:function n(o){m(function(p){if(p.detailView!==o)return{detailView:o};return null})},changeMasterView:function n(o){__p&&__p();m(function(p){__p&&__p();if(p.masterView!==o){var q={masterView:o};if(p.masterView===c("MessengerView").MASTER.SEARCH){q.query=undefined;c("Bootloader").loadModules(["MessengerContentSearchFunnelLogger","MessengerContentSearchFunnelLoggerConstants"],function(r,s){r&&r.endFunnel(s.FUNNEL_LOGGER_TAGS.END_WITH_BACK_BUTTON)},"MessengerActions")}return q}return null})},selectAggregation:function n(o){m(function(p){return{detailView:c("MessengerView").MASTER.RECENT,threadIDs:o,mid:null}})},selectThread:function n(o,p){__p&&__p();if(p===c("MercuryTypeaheadConstants").MEETING_ROOM_PAGE_TYPE){!!o||h(0);var q=c("MercuryIDs").getUserIDFromThreadID(o);!!q||h(0);var r=new(c("URI"))(),s=r.getQualifiedURI().getSubdomain();r.setDomain("facebook.com").setSubdomain(s).setPath("/"+q).setProtocol("https");window.open(r,"_blank");return}c("EventProfiler").tagCurrentActiveInteractionsAs("MessengerThreadSwitch");c("MessengerDispatcher").dispatch({type:i.SELECT_THREAD,threadID:o});m(function(t){if(t.activeThreadID!==o)return{activeThreadID:o,detailView:c("MessengerView").DETAIL.THREAD,mid:null};return null})},changeState:function n(o){c("MessengerDispatcher").dispatch({type:i.REPLACE_STATE,nextState:o})},changeMDotMeReferral:function n(){var o=arguments.length<=0||arguments[0]===undefined?null:arguments[0],p=arguments.length<=1||arguments[1]===undefined?null:arguments[1];c("MessengerDispatcher").dispatch({type:k.Types.UPDATE_MDOT_ME,refCode:o,refThreadID:p})},changeThreadTag:function n(){var o=arguments.length<=0||arguments[0]===undefined?null:arguments[0],p=arguments.length<=1||arguments[1]===undefined?null:arguments[1];c("MessengerDispatcher").dispatch({type:k.Types.UPDATE_THREAD_TAG,messagingTags:o,threadID:p})},changeFolder:function n(o){m(function(p){if(p.folder!==o)return{folder:o};return null})},changeFilter:function n(o){m(function(p){if(p.filter!==o)return{filter:o};return null})},changeQuery:function n(o){m(function(p){if(p.query!==o)return{query:o};return null})},changeQueryAll:function n(o){m(function(p){if(p.queryAll!==o)return{query:o,masterView:c("MessengerView").MASTER.SEARCH};return null})},changeMid:function n(o){m(function(p){if(p.mid!==o)return{mid:o};return null})},changeID:function n(o){m(function(p){if(p.extraQueryParams.id!==o)return{extraQueryParams:babelHelpers["extends"]({},p.extraQueryParams,{id:o})};return null})},prepareFilesForSend:function n(o,p){if(!o)return;c("MessengerDispatcher").dispatch({type:k.Types.PREPARE_FILES_FOR_SEND,threadID:o,files:p})},uploadedFile:function n(o,p,q){if(!o)return;c("MessengerDispatcher").dispatch({type:k.Types.UPLOADED_FILE,threadID:o,uploadID:p,payload:q})},cancelFileUpload:function n(o,p){if(!o)return;c("MessengerDispatcher").dispatch({type:k.Types.CANCEL_FILE_UPLOAD,threadID:o,uploadID:p})},uploadFileFailed:function n(o,p){if(!o)return;c("MessengerDispatcher").dispatch({type:k.Types.UPLOAD_FILE_FAILED,threadID:o,uploadID:p})},cleanFiles:function n(o){j.debug("clean files",o);if(!o)return;c("MessengerDispatcher").dispatch({type:k.Types.EMPTY_FILES,threadID:o})},loadingPreview:function n(o,p){c("MessengerDispatcher").dispatch({type:k.Types.LINK_PREVIEW,threadID:o,match:p})},loadingShareData:function n(o){c("MessengerDispatcher").dispatch({type:k.Types.LOADING_SHARE_DATA,threadID:o})},loadedShareData:function n(o,p){c("MessengerDispatcher").dispatch({type:k.Types.LOADED_SHARE_DATA,threadID:o,attachmentData:p})},removeSharePreview:function n(o){c("MessengerDispatcher").dispatch({type:k.Types.REMOVE_SHARE_PREVIEW,threadID:o})}};function l(n,o){return n.detailView==null}function m(n){var o=c("MessengerURISerializer").deserialize(new(c("URI"))(window.location.href)),p=n(o),q=l(o,p);if(p)c("goURI")(c("MessengerURISerializer").serialize(Object.assign(o,p)),false,q)}f.exports=k}),null);
__d("bs_caml_exceptions",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=[0];function i(m){m[1]=h[0];h[0]+=1;return m}function j(){h[0]+=1;return h[0]}function k(m){var n=j(0),o=[m,n];o.tag=248;return o}function l(m){if(m===undefined)return false;else if(m.tag===248)return true;else{var n=m[0];if(n!==undefined)return n.tag===248;else return false}}g.caml_set_oo_id=i;g.get_id=j;g.create=k;g.isCamlExceptionOrOpenVariant=l}),null);
__d("bs_js_exn",["bs_caml_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("bs_caml_exceptions").create("Js_exn.Error");function i(q){if(c("bs_caml_exceptions").isCamlExceptionOrOpenVariant(q))return q;else return[h,q]}function j(q){throw new Error(q)}function k(q){throw new EvalError(q)}function l(q){throw new RangeError(q)}function m(q){throw new ReferenceError(q)}function n(q){throw new SyntaxError(q)}function o(q){throw new TypeError(q)}function p(q){throw new URIError(q)}g.$$Error=h;g.internalToOCamlException=i;g.raiseError=j;g.raiseEvalError=k;g.raiseRangeError=l;g.raiseReferenceError=m;g.raiseSyntaxError=n;g.raiseTypeError=o;g.raiseUriError=p}),null);
__d("bs_block",[],(function a(b,c,d,e,f,g){"use strict";function h(i,j){j.tag=i;return j}g.__=h}),null);
__d("bs_js_types",["bs_block"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){__p&&__p();if(typeof k==="undefined")return[0,k];else if(k===null)return[1,k];else if(typeof k==="number")return[3,k];else if(typeof k==="string")return[4,k];else if(typeof k==="boolean")return[2,k];else if(typeof k==="function")return[5,k];else if(typeof k==="object")return[6,k];else return[7,k]}function i(k){__p&&__p();var l=typeof k;if(l==="undefined")return 3;else if(k===null)return 2;else if(l==="number")return c("bs_block").__(0,[k]);else if(l==="string")return c("bs_block").__(1,[k]);else if(l==="boolean")if(k===true)return 1;else return 0;else if(l==="function")return c("bs_block").__(2,[k]);else if(l==="object")return c("bs_block").__(3,[k]);else return c("bs_block").__(4,[k])}function j(k,l){switch(l){case 0:return typeof k==="undefined";case 1:return k===null;case 2:return typeof k==="boolean";case 3:return typeof k==="number";case 4:return typeof k==="string";case 5:return typeof k==="function";case 6:return typeof k==="object";case 7:return typeof k==="symbol"}}g.reify_type=h;g.test=j;g.classify=i}),null);
__d("bs_caml_int32",["bs_caml_builtin_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(n,o){if(o===0)throw c("bs_caml_builtin_exceptions").division_by_zero;else return n/o|0}function i(n,o){if(o===0)throw c("bs_caml_builtin_exceptions").division_by_zero;else return n%o}function j(n){return(n&255)<<8|(n&65280)>>>8}function k(n){return(n&255)<<24|(n&65280)<<8|(n&16711680)>>>8|(n&4278190080)>>>24}var l=Math.imul||function(n,o){o|=0;return((n>>16)*o<<16)+(n&65535)*o|0},m=k;g.div=h;g.mod_=i;g.caml_bswap16=j;g.caml_int32_bswap=k;g.caml_nativeint_bswap=m;g.imul=l}),null);
__d("bs_caml_primitive",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(z,A){if(z<A)return-1;else if(z===A)return 0;else return 1}function i(z,A){if(z)if(A)return 0;else return 1;else if(A)return-1;else return 0}function j(z,A){if(z===A)return 0;else if(z<A)return-1;else if(z>A||z===z)return 1;else if(A===A)return-1;else return 0}function k(z,A){if(z===A)return 0;else if(z<A)return-1;else return 1}function l(z,A){if(z)return A;else return z}function m(z,A){if(z<A)return z;else return A}function n(z,A){if(z<A)return z;else return A}function o(z,A){if(z<A)return z;else return A}function p(z,A){if(z<A)return z;else return A}function q(z,A){if(z<A)return z;else return A}function r(z,A){if(z)return z;else return A}function s(z,A){if(z>A)return z;else return A}function t(z,A){if(z>A)return z;else return A}function u(z,A){if(z>A)return z;else return A}function v(z,A){if(z>A)return z;else return A}function w(z,A){if(z>A)return z;else return A}var x=h,y=h;g.caml_int_compare=h;g.caml_bool_compare=i;g.caml_float_compare=j;g.caml_nativeint_compare=x;g.caml_string_compare=k;g.caml_int32_compare=y;g.caml_bool_min=l;g.caml_int_min=m;g.caml_float_min=n;g.caml_string_min=o;g.caml_nativeint_min=p;g.caml_int32_min=q;g.caml_bool_max=r;g.caml_int_max=s;g.caml_float_max=t;g.caml_string_max=u;g.caml_nativeint_max=v;g.caml_int32_max=w}),null);
__d("bs_caml_obj",["bs_block","bs_caml_primitive","bs_caml_builtin_exceptions"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function c(n,o){var p=new Array(o);p.tag=n;return p}function d(n){var o=n.length|0,p=new Array(o);for(var q=0,r=o-1|0;q<=r;++q)p[q]=n[q];p.tag=n.tag|0;return p}function e(n,o){__p&&__p();var p=n.length|0;if(o<=0||o>p)throw[a("bs_caml_builtin_exceptions").invalid_argument,"Obj.truncate"];else if(p!==o){for(var q=o,r=p-1|0;q<=r;++q)n[q]=0;n.length=o;return 0}else return 0}function f(n){return a("bs_block").__(250,[n])}function g(n,o){var p=o.length|0;for(var q=0,r=p-1|0;q<=r;++q)n[q]=o[q];var s=o.tag|0;if(s!==0){n.tag=s;return 0}else return 0}var h=function h(n,o){for(var p in n)o(p)};function i(n,o){__p&&__p();while(true){var p=o,q=n;if(q===p)return 0;else{var r=typeof q,s=typeof p;if(r==="string")return a("bs_caml_primitive").caml_string_compare(q,p);else{var t=r==="number",u=s==="number";if(t)if(u)return a("bs_caml_primitive").caml_int_compare(q,p);else return-1;else if(u)return 1;else if(r==="boolean"||r==="undefined"||q===null){var v=q,w=p;if(v===w)return 0;else if(v<w)return-1;else return 1}else if(r==="function"||s==="function")throw[a("bs_caml_builtin_exceptions").invalid_argument,"compare: functional value"];else{var x=q.tag|0,y=p.tag|0;if(x===250){n=q[0];continue}else if(y===250){o=p[0];continue}else if(x===248)return a("bs_caml_primitive").caml_int_compare(q[1],p[1]);else if(x===251)throw[a("bs_caml_builtin_exceptions").invalid_argument,"equal: abstract value"];else if(x!==y)if(x<y)return-1;else return 1;else{var z=q.length|0,A=p.length|0;if(z===A)if(Array.isArray(q)){var B=q,C=p,D=0,E=z;while(true){var F=D;if(F===E)return 0;else{var G=i(B[F],C[F]);if(G!==0)return G;else{D=F+1|0;continue}}}}else{var H=q,I=p,J=[0],K=[0],L=function L(Y,Z){__p&&__p();var $=Y[2],p=Y[1];if(!Object.prototype.hasOwnProperty.call(p,Z)||i(Y[0][Z],p[Z])>0){var Q=$[0];if(Q)if(Z<Q[0]){$[0]=[Z];return 0}else return 0;else{$[0]=[Z];return 0}}else return 0},M=[H,I,K],N=function(M){return function N(Y){return L(M,Y)}}(M),O=[I,H,J],P=function(O){return function P(Y){return L(O,Y)}}(O);h(H,N);h(I,P);var Q=J[0],R=K[0];if(Q)if(R)return a("bs_caml_primitive").caml_string_compare(Q[0],R[0]);else return-1;else if(R)return 1;else return 0}else if(z<A){var ma=q,na=p,S=0,oa=z;while(true){var T=S;if(T===oa)return-1;else{var U=i(ma[T],na[T]);if(U!==0)return U;else{S=T+1|0;continue}}}}else{var pa=q,qa=p,V=0,ra=A;while(true){var W=V;if(W===ra)return 1;else{var X=i(pa[W],qa[W]);if(X!==0)return X;else{V=W+1|0;continue}}}}}}}}}}function j(n,o){__p&&__p();while(true){var p=o,q=n;if(q===p)return true;else{var r=typeof q;if(r==="string"||r==="number"||r==="boolean"||r==="undefined"||q===null)return false;else{var s=typeof p;if(r==="function"||s==="function")throw[a("bs_caml_builtin_exceptions").invalid_argument,"equal: functional value"];else if(s==="number"||s==="undefined"||p===null)return false;else{var t=q.tag|0,u=p.tag|0;if(t===250){n=q[0];continue}else if(u===250){o=p[0];continue}else if(t===248)return q[1]===p[1];else if(t===251)throw[a("bs_caml_builtin_exceptions").invalid_argument,"equal: abstract value"];else if(t!==u)return false;else{var v=q.length|0,w=p.length|0;if(v===w)if(Array.isArray(q)){var x=q,y=p,z=0,A=v;while(true){var B=z;if(B===A)return true;else if(j(x[B],y[B])){z=B+1|0;continue}else return false}}else{var C=q,D=p,E=[true],F=function(D,E){return function F(H){if(Object.prototype.hasOwnProperty.call(D,H))return 0;else{E[0]=false;return 0}}}(D,E),G=function(C,D,E){return function G(H){if(!Object.prototype.hasOwnProperty.call(C,H)||!j(D[H],C[H])){E[0]=false;return 0}else return 0}}(C,D,E);h(C,F);if(E[0])h(D,G);return E[0]}else return false}}}}}}function k(n,o){if(o!==null)return j(n,o);else return n===o}function l(n,o){if(o!==undefined)return j(n,o);else return n===o}function m(n,o){if(o==null)return n===o;else return j(n,o)}function fa(n,o){return!j(n,o)}function ga(n,o){return i(n,o)>=0}function ha(n,o){return i(n,o)>0}function ia(n,o){return i(n,o)<=0}function ja(n,o){return i(n,o)<0}function ka(n,o){if(i(n,o)<=0)return n;else return o}function la(n,o){if(i(n,o)>=0)return n;else return o}b.caml_obj_block=c;b.caml_obj_dup=d;b.caml_obj_truncate=e;b.caml_lazy_make_forward=f;b.caml_update_dummy=g;b.caml_compare=i;b.caml_equal=j;b.caml_equal_null=k;b.caml_equal_undefined=l;b.caml_equal_nullable=m;b.caml_notequal=fa;b.caml_greaterequal=ga;b.caml_greaterthan=ha;b.caml_lessthan=ja;b.caml_lessequal=ia;b.caml_min=ka;b.caml_max=la}),null);
__d("bs_caml_string",["bs_caml_builtin_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(u){return String.fromCharCode(u)}function i(u,v){if(v>=u.length||v<0)throw[c("bs_caml_builtin_exceptions").invalid_argument,"index out of bounds"];else return u.charCodeAt(v)}function j(u){if(u<0)throw[c("bs_caml_builtin_exceptions").invalid_argument,"String.create"];else{var v=new Array(u);for(var w=0,x=u-1|0;w<=x;++w)v[w]=0;return v}}function k(u,v,w,x){if(w>0){for(var y=v,z=(w+v|0)-1|0;y<=z;++y)u[y]=x;return 0}else return 0}function l(u,v,w,x,y){__p&&__p();if(y>0){var z=u.length-v|0;if(y<=z){for(var A=0,B=y-1|0;A<=B;++A)w[x+A|0]=u.charCodeAt(v+A|0);return 0}else{for(var C=0,D=z-1|0;C<=D;++C)w[x+C|0]=u.charCodeAt(v+C|0);for(var E=z,F=y-1|0;E<=F;++E)w[x+E|0]=0;return 0}}else return 0}function m(u,v,w,x,y){__p&&__p();if(y>0)if(u===w){var z=u,A=v,B=x,C=y;if(A<B){var D=(z.length-B|0)-1|0,E=C-1|0,F=D>E?E:D;for(var G=F;G>=0;--G)z[B+G|0]=z[A+G|0];return 0}else if(A>B){var H=(z.length-A|0)-1|0,I=C-1|0,J=H>I?I:H;for(var K=0;K<=J;++K)z[B+K|0]=z[A+K|0];return 0}else return 0}else{var L=u.length-v|0;if(y<=L){for(var M=0,N=y-1|0;M<=N;++M)w[x+M|0]=u[v+M|0];return 0}else{for(var O=0,P=L-1|0;O<=P;++O)w[x+O|0]=u[v+O|0];for(var Q=L,R=y-1|0;Q<=R;++Q)w[x+Q|0]=0;return 0}}else return 0}function n(u){var v=u.length,w=new Array(v);for(var x=0,y=v-1|0;x<=y;++x)w[x]=u.charCodeAt(x);return w}function o(u){__p&&__p();var v=u,w=0,x=u.length,y="",z=x;if(w===0&&x<=4096&&x===v.length)return String.fromCharCode.apply(null,v);else{var A=0;while(z>0){var B=z<1024?z:1024,C=new Array(B);m(v,A,C,0,B);y=y+String.fromCharCode.apply(null,C);z=z-B|0;A=A+B|0}return y}}function p(u){var v=u.length,w=new Array(v);for(var x=0,y=v-1|0;x<=y;++x)w[x]=u[x];return o(w)}function q(u){if(u>31)return u<127;else return false}function r(u,v){return u.charCodeAt(v)+(u.charCodeAt(v+1|0)<<8)|0}function s(u,v){return((u.charCodeAt(v)+(u.charCodeAt(v+1|0)<<8)|0)+(u.charCodeAt(v+2|0)<<16)|0)+(u.charCodeAt(v+3|0)<<24)|0}function t(u,v){if(v<0||v>=u.length)throw[c("bs_caml_builtin_exceptions").invalid_argument,"index out of bounds"];else return u.charCodeAt(v)}g.bytes_of_string=n;g.bytes_to_string=o;g.caml_is_printable=q;g.caml_string_of_char_array=p;g.caml_string_get=i;g.caml_create_string=j;g.caml_fill_string=k;g.caml_blit_string=l;g.caml_blit_bytes=m;g.caml_string_get16=r;g.caml_string_get32=s;g.string_of_char=h;g.get=t}),null);
__d("bs_char",["bs_caml_string","bs_caml_builtin_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(m){if(m<0||m>255)throw[c("bs_caml_builtin_exceptions").invalid_argument,"Char.chr"];else return m}function i(m){__p&&__p();var n=0;if(m>=40)if(m!==92)n=m>=127?1:2;else return"\\\\";else if(m>=32)if(m>=39)return"\\'";else n=2;else if(m>=14)n=1;else switch(m){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:n=1;break;case 13:return"\\r"}switch(n){case 1:var o=c("bs_caml_string").caml_create_string(4);o[0]=92;o[1]=48+(m/100|0)|0;o[2]=48+(m/10|0)%10|0;o[3]=48+m%10|0;return c("bs_caml_string").bytes_to_string(o);case 2:var p=c("bs_caml_string").caml_create_string(1);p[0]=m;return c("bs_caml_string").bytes_to_string(p)}}function j(m){if(m>=65&&m<=90||m>=192&&m<=214||m>=216&&m<=222)return m+32|0;else return m}function k(m){if(m>=97&&m<=122||m>=224&&m<=246||m>=248&&m<=254)return m-32|0;else return m}function l(m,n){return m-n|0}g.chr=h;g.escaped=i;g.lowercase=j;g.uppercase=k;g.compare=l}),null);
__d("bs_caml_utils",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=String.prototype.repeat&&function(i,j){return j.repeat(i)}||function(i,j){__p&&__p();if(j.length==0||i==0)return"";if(j.length*i>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var k="";for(;;){if((i&1)==1)k+=j;i>>>=1;if(i==0)break;j+=j}return k};g.repeat=h}),null);
__d("bs_caml_int64",["bs_caml_int32","bs_caml_utils","bs_caml_primitive","bs_caml_builtin_exceptions"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();var c=[-2147483648,0],d=[2147483647,1],e=[0,1],f=[0,0],g=[-1,4294967295];function h(B){return(B&2147483648)!==0}function i(B,C){var D=C[1],E=B[1],F=E+D&4294967295,G=h(E)&&(h(D)||!h(F))||h(D)&&!h(F)?1:0,H=B[0]+C[0]+G&4294967295;return[H,F>>>0]}function j(B){var C=B[0]^-1,D=B[1]^-1;return[C,D>>>0]}function k(B,C){if(B[0]===C[0])return B[1]===C[1];else return false}function l(B,C){if(C!==null)return k(B,C);else return false}function m(B,C){if(C!==undefined)return k(B,C);else return false}function n(B,C){if(C==null)return false;else return k(B,C)}function o(B){if(k(B,c))return c;else return i(j(B),e)}function p(B,C){return i(B,o(C))}function q(B,C){if(C===0)return B;else{var D=B[1];if(C>=32)return[D<<(C-32|0),0];else{var E=D>>>(32-C|0)|B[0]<<C;return[E,D<<C>>>0]}}}function r(B,C){__p&&__p();if(C===0)return B;else{var D=B[0],E=C-32|0;if(E===0)return[0,D>>>0];else if(E>0){var F=D>>>E;return[0,F>>>0]}else{var G=D>>>C,H=D<<(-E|0)|B[1]>>>C;return[G,H>>>0]}}}function s(B,C){__p&&__p();if(C===0)return B;else{var D=B[0];if(C<32){var E=D>>C,F=D<<(32-C|0)|B[1]>>>C;return[E,F>>>0]}else{var G=D>>(C-32|0);return[D>=0?0:-1,G>>>0]}}}function t(B){if(B[0]!==0||B[1]!==0)return false;else return true}function u(B,C){__p&&__p();while(true){var D=C,E=B,F=0,G,H=E[0],I=0,J=0,K=0;if(H!==0||E[1]!==0)K=4;else return f;if(K===4)if(D[0]!==0||D[1]!==0)J=3;else return f;if(J===3)if(H!==-2147483648||E[1]!==0)I=2;else{G=D[1];F=1}if(I===2){var L=D[0],M=E[1],N=0;if(L!==-2147483648||D[1]!==0)N=3;else{G=M;F=1}if(N===3){var O=D[1];if(H<0)if(L<0){C=o(D);B=o(E);continue}else return o(u(o(E),D));else if(L<0)return o(u(E,o(D)));else{var P=H>>>16,Q=H&65535,R=M>>>16,S=M&65535,T=L>>>16,U=L&65535,V=O>>>16,W=O&65535,X=0,Y=0,Z=0,$=S*W;Z=($>>>16)+R*W;Y=Z>>>16;Z=(Z&65535)+S*V;Y=Y+(Z>>>16)+Q*W;X=Y>>>16;Y=(Y&65535)+R*V;X+=Y>>>16;Y=(Y&65535)+S*U;X+=Y>>>16;Y=Y&65535;X=X+(P*W+Q*V+R*U+S*T)&65535;var Aa=Y|X<<16,Ba=$&65535|(Z&65535)<<16;return[Aa,Ba>>>0]}}}if(F===1)if((G&1)===0)return f;else return c}}function fa(B){var C=a("bs_caml_int32").caml_int32_bswap(B[1]),D=a("bs_caml_int32").caml_int32_bswap(B[0]);return[C,D>>>0]}function ga(B,C){return[B[0]^C[0],(B[1]^C[1])>>>0]}function ha(B,C){return[B[0]|C[0],(B[1]|C[1])>>>0]}function ia(B,C){return[B[0]&C[0],(B[1]&C[1])>>>0]}function v(B,C){var D=C[0],E=B[0];if(E>D)return true;else if(E<D)return false;else return B[1]>=C[1]}function ja(B,C){return!k(B,C)}function ka(B,C){return!v(B,C)}function w(B,C){if(B[0]>C[0])return true;else if(B[0]<C[0])return false;else return B[1]>C[1]}function la(B,C){return!w(B,C)}function ma(B,C){if(v(B,C))return C;else return B}function na(B,C){if(w(B,C))return B;else return C}function x(B){return B[0]*4294967296+B[1]}var y=Math.pow(2,32),oa=Math.pow(2,63),pa=-Math.pow(2,63);function z(B){__p&&__p();if(isNaN(B)||!isFinite(B))return f;else if(B<=pa)return c;else if(B+1>=oa)return d;else if(B<0)return o(z(-B));else{var C=B/y|0,D=B%y|0;return[C,D>>>0]}}function A(B,C){__p&&__p();while(true){var D=C,E=B,F=E[0],G=0,H=0;if(D[0]!==0||D[1]!==0)H=2;else throw a("bs_caml_builtin_exceptions").division_by_zero;if(H===2)if(F!==-2147483648)if(F!==0||E[1]!==0)G=1;else return f;else if(E[1]!==0)G=1;else if(k(D,e)||k(D,g))return E;else if(k(D,c))return e;else{var I=D[0],J=s(E,1),K=q(A(J,D),1),L=0;if(K[0]!==0||K[1]!==0)L=3;else if(I<0)return e;else return o(e);if(L===3){var M=u(D,K),N=i(E,o(M));return i(K,A(N,D))}}if(G===1){var O=D[0],P=0;if(O!==-2147483648||D[1]!==0)P=2;else return f;if(P===2)if(F<0)if(O<0){C=o(D);B=o(E);continue}else return o(A(o(E),D));else if(O<0)return o(A(E,o(D)));else{var Q=f,R=E;while(v(R,D)){var S=a("bs_caml_primitive").caml_float_max(1,Math.floor(x(R)/x(D))),T=Math.ceil(Math.log(S)/Math.LN2),U=T<=48?1:Math.pow(2,T-48),V=z(S),W=u(V,D);while(W[0]<0||w(W,R)){S-=U;V=z(S);W=u(V,D)}if(t(V))V=e;Q=i(Q,V);R=i(R,o(W))}return Q}}}}function qa(B,C){var D=u(A(B,C),C);return i(B,o(D))}function ra(B,C){var D=A(B,C),E=u(D,C);return[D,i(B,o(E))]}function sa(B,C){var D=a("bs_caml_primitive").caml_nativeint_compare(B[0],C[0]);if(D===0)return a("bs_caml_primitive").caml_nativeint_compare(B[1],C[1]);else return D}function ta(B){return[B<0?-1:0,B>>>0]}function ua(B){return B[1]|0}function va(B){__p&&__p();var C=function C(I){return(I>>>0).toString(16)},D=B[0],E=B[1],F=0;if(D!==0||E!==0)F=1;else return"0";if(F===1)if(E!==0)if(D!==0){var G=C(B[1]),H=8-G.length|0;if(H<=0)return C(B[0])+G;else return C(B[0])+(a("bs_caml_utils").repeat(H,"0")+G)}else return C(B[1]);else return C(B[0])+"00000000"}function wa(B){return[2147483647&B[0],B[1]]}function xa(B){var C=new Int32Array([B[1],B[0]]);return new Float64Array(C.buffer)[0]}function ya(B){var C=new Float64Array([B]),D=new Int32Array(C.buffer),E=D[1],F=E,G=D[0],H=G;return[F,H>>>0]}function za(B,C){var D=B.charCodeAt(C+4|0)<<32|B.charCodeAt(C+5|0)<<40|B.charCodeAt(C+6|0)<<48|B.charCodeAt(C+7|0)<<56,E=B.charCodeAt(C)|B.charCodeAt(C+1|0)<<8|B.charCodeAt(C+2|0)<<16|B.charCodeAt(C+3|0)<<24;return[D,E>>>0]}b.min_int=c;b.max_int=d;b.one=e;b.zero=f;b.not=j;b.of_int32=ta;b.to_int32=ua;b.add=i;b.neg=o;b.sub=p;b.lsl_=q;b.lsr_=r;b.asr_=s;b.is_zero=t;b.mul=u;b.xor=ga;b.or_=ha;b.and_=ia;b.swap=fa;b.ge=v;b.eq=k;b.neq=ja;b.lt=ka;b.gt=w;b.le=la;b.equal_null=l;b.equal_undefined=m;b.equal_nullable=n;b.min=ma;b.max=na;b.to_float=x;b.of_float=z;b.div=A;b.mod_=qa;b.div_mod=ra;b.compare=sa;b.to_hex=va;b.discard_sign=wa;b.float_of_bits=xa;b.bits_of_float=ya;b.get64=za}),null);
__d("bs_caml_format",["bs_curry","bs_caml_int32","bs_caml_int64","bs_caml_utils","bs_caml_builtin_exceptions"],(function a(b,c,aa,ba,ca,d){"use strict";__p&&__p();function e(x){throw[c("bs_caml_builtin_exceptions").failure,x]}function f(x){__p&&__p();if(x>=65)if(x>=97)if(x>=123)return-1;else return x-87|0;else if(x>=91)return-1;else return x-55|0;else if(x>57||x<48)return-1;else return x-48|0}function g(x){switch(x){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}function h(x){__p&&__p();var y=1,z=2,A=0;if(x[A]==="-"){y=-1;A=A+1|0}var B=x.charCodeAt(A),C=x.charCodeAt(A+1|0);if(B===48)if(C>=89)if(C!==98)if(C!==111){if(C===120){z=1;A=A+2|0}}else{z=0;A=A+2|0}else{z=3;A=A+2|0}else if(C!==66)if(C!==79){if(C>=88){z=1;A=A+2|0}}else{z=0;A=A+2|0}else{z=3;A=A+2|0}return[A,y,z]}function i(x){__p&&__p();var y=h(x),z=y[0],A=g(y[2]),B=4294967295,C=x.length,D=z<C?x.charCodeAt(z):0,E=f(D);if(E<0||E>=A)throw[c("bs_caml_builtin_exceptions").failure,"int_of_string"];var F=function F(I,J){__p&&__p();while(true){var K=J,L=I;if(K===C)return L;else{var M=x.charCodeAt(K);if(M===95){J=K+1|0;continue}else{var N=f(M);if(N<0||N>=A)throw[c("bs_caml_builtin_exceptions").failure,"int_of_string"];else{var O=A*L+N;if(O>B)throw[c("bs_caml_builtin_exceptions").failure,"int_of_string"];else{J=K+1|0;I=O;continue}}}}}},G=y[1]*F(E,z+1|0),H=G|0;if(A===10&&G!==H)throw[c("bs_caml_builtin_exceptions").failure,"int_of_string"];return H}function j(x){__p&&__p();var y=h(x),z=y[2],A=y[0],B=c("bs_caml_int64").of_int32(g(z)),C=c("bs_caml_int64").of_int32(y[1]),D;switch(z){case 0:D=[536870911,4294967295];break;case 1:D=[268435455,4294967295];break;case 2:D=[429496729,2576980377];break;case 3:D=[2147483647,4294967295];break}var E=x.length,F=A<E?x.charCodeAt(A):0,G=c("bs_caml_int64").of_int32(f(F));if(c("bs_caml_int64").lt(G,[0,0])||c("bs_caml_int64").ge(G,B))throw[c("bs_caml_builtin_exceptions").failure,"int64_of_string"];var H=function H(K,L){__p&&__p();while(true){var M=L,N=K;if(M===E)return N;else{var O=x.charCodeAt(M);if(O===95){L=M+1|0;continue}else{var P=c("bs_caml_int64").of_int32(f(O));if(c("bs_caml_int64").lt(P,[0,0])||c("bs_caml_int64").ge(P,B)||c("bs_caml_int64").gt(N,D))throw[c("bs_caml_builtin_exceptions").failure,"int64_of_string"];else{var Q=c("bs_caml_int64").add(c("bs_caml_int64").mul(B,N),P);L=M+1|0;K=Q;continue}}}}},I=c("bs_caml_int64").mul(C,H(G,A+1|0)),J=c("bs_caml_int64").or_(I,[0,0]);if(c("bs_caml_int64").eq(B,[0,10])&&c("bs_caml_int64").neq(I,J))throw[c("bs_caml_builtin_exceptions").failure,"int64_of_string"];return J}function k(x){switch(x){case 0:return 8;case 1:return 16;case 2:return 10}}function l(x){if(x>=65&&x<=90||x>=192&&x<=214||x>=216&&x<=222)return x+32|0;else return x}function m(x){__p&&__p();var y=x.length;if(y>31)throw[c("bs_caml_builtin_exceptions").invalid_argument,"format_int: format too long"];var z=["+","-"," ",false,2,false,0,false,1,-1,"f"],A=0;while(true){var B=A;if(B>=y)return z;else{var C=x.charCodeAt(B),D=0;if(C>=69)if(C>=88)if(C>=121)D=1;else switch(C-88|0){case 0:z[4]=1;z[7]=true;A=B+1|0;continue;case 13:case 14:case 15:D=5;break;case 12:case 17:D=4;break;case 23:z[4]=0;A=B+1|0;continue;case 29:z[4]=2;A=B+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:D=1;break;case 32:z[4]=1;A=B+1|0;continue}else if(C>=72)D=1;else{z[5]=true;z[7]=true;z[10]=String.fromCharCode(l(C));A=B+1|0;continue}else{var E=C-32|0;if(E>25||E<0)D=1;else switch(E){case 3:z[3]=true;A=B+1|0;continue;case 0:case 11:D=2;break;case 13:z[0]="-";A=B+1|0;continue;case 14:z[9]=0;var F=B+1|0;while(function(F){return function(){var H=x.charCodeAt(F)-48|0;return H>=0&&H<=9}}(F)()){z[9]=(c("bs_caml_int32").imul(z[9],10)+x.charCodeAt(F)|0)-48|0;F=F+1|0}A=F;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 15:D=1;break;case 16:z[2]="0";A=B+1|0;continue;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:D=3;break}}switch(D){case 1:A=B+1|0;continue;case 2:z[1]=String.fromCharCode(C);A=B+1|0;continue;case 3:z[6]=0;var G=B;while(function(G){return function(){var H=x.charCodeAt(G)-48|0;return H>=0&&H<=9}}(G)()){z[6]=(c("bs_caml_int32").imul(z[6],10)+x.charCodeAt(G)|0)-48|0;G=G+1|0}A=G;continue;case 4:z[5]=true;z[4]=2;A=B+1|0;continue;case 5:z[5]=true;z[10]=String.fromCharCode(C);A=B+1|0;continue}}}}function n(x,y){__p&&__p();var z=x[0],A=x[1],B=x[2],C=x[3],D=x[4],E=x[5],F=x[6],G=x[7],H=x[8],I=y.length;if(E&&(H<0||A!=="-"))I=I+1|0;if(C)if(D===0)I=I+1|0;else if(D===1)I=I+2|0;var J="";if(z==="+"&&B===" ")for(var K=I,L=F-1|0;K<=L;++K)J=J+B;if(E)if(H<0)J=J+"-";else if(A!=="-")J=J+A;if(C&&D===0)J=J+"0";if(C&&D===1)J=J+"0x";if(z==="+"&&B==="0")for(var M=I,N=F-1|0;M<=N;++M)J=J+B;J=G?J+y.toUpperCase():J+y;if(z==="-")for(var O=I,P=F-1|0;O<=P;++O)J=J+" ";return J}function o(x,y){__p&&__p();if(x==="%d")return String(y);else{var z=m(x),A=z,B=y,C=B<0?A[5]?(A[8]=-1,-B):B>>>0:B,D=C.toString(k(A[4]));if(A[9]>=0){A[2]=" ";var E=A[9]-D.length|0;if(E>0)D=c("bs_caml_utils").repeat(E,"0")+D}return n(A,D)}}function p(x,y){__p&&__p();var z=m(x),A=z[5]&&c("bs_caml_int64").lt(y,[0,0])?(z[8]=-1,c("bs_caml_int64").neg(y)):y,B="",C=z[4];switch(C){case 0:var D=[0,8],E="01234567";if(c("bs_caml_int64").lt(A,[0,0])){var F=c("bs_caml_int64").discard_sign(A),G=c("bs_caml_int64").div_mod(F,D),H=c("bs_caml_int64").add([268435456,0],G[0]),I=G[1];B=String.fromCharCode(E.charCodeAt(I[1]|0))+B;while(c("bs_caml_int64").neq(H,[0,0])){var J=c("bs_caml_int64").div_mod(H,D);H=J[0];I=J[1];B=String.fromCharCode(E.charCodeAt(I[1]|0))+B}}else{var K=c("bs_caml_int64").div_mod(A,D),L=K[0],M=K[1];B=String.fromCharCode(E.charCodeAt(M[1]|0))+B;while(c("bs_caml_int64").neq(L,[0,0])){var N=c("bs_caml_int64").div_mod(L,D);L=N[0];M=N[1];B=String.fromCharCode(E.charCodeAt(M[1]|0))+B}}break;case 1:B=c("bs_caml_int64").to_hex(A)+B;break;case 2:var O=[0,10],P="0123456789";if(c("bs_caml_int64").lt(A,[0,0])){var Q=c("bs_caml_int64").discard_sign(A),R=c("bs_caml_int64").div_mod(Q,O),S=c("bs_caml_int64").div_mod(c("bs_caml_int64").add([0,8],R[1]),O),T=c("bs_caml_int64").add(c("bs_caml_int64").add([214748364,3435973836],R[0]),S[0]),U=S[1];B=String.fromCharCode(P.charCodeAt(U[1]|0))+B;while(c("bs_caml_int64").neq(T,[0,0])){var V=c("bs_caml_int64").div_mod(T,O);T=V[0];U=V[1];B=String.fromCharCode(P.charCodeAt(U[1]|0))+B}}else{var W=c("bs_caml_int64").div_mod(A,O),X=W[0],Y=W[1];B=String.fromCharCode(P.charCodeAt(Y[1]|0))+B;while(c("bs_caml_int64").neq(X,[0,0])){var Z=c("bs_caml_int64").div_mod(X,O);X=Z[0];Y=Z[1];B=String.fromCharCode(P.charCodeAt(Y[1]|0))+B}}break}if(z[9]>=0){z[2]=" ";var $=z[9]-B.length|0;if($>0)B=c("bs_caml_utils").repeat($,"0")+B}return n(z,B)}function q(x,y){__p&&__p();var z=m(x),A=z[9]<0?6:z[9],B=y<0?(z[8]=-1,-y):y,C="";if(isNaN(B)){C="nan";z[2]=" "}else if(isFinite(B)){var D=z[10];switch(D){case"e":C=B.toExponential(A);var E=C.length;if(C[E-3|0]==="e")C=C.slice(0,E-1|0)+("0"+C.slice(E-1|0));break;case"f":C=B.toFixed(A);break;case"g":var F=A!==0?A:1;C=B.toExponential(F-1|0);var G=C.indexOf("e"),H=Number(C.slice(G+1|0))|0;if(H<-4||B>=1e21||B.toFixed().length>F){var I=G-1|0;while(C[I]==="0")I=I-1|0;if(C[I]===".")I=I-1|0;C=C.slice(0,I+1|0)+C.slice(G);var J=C.length;if(C[J-3|0]==="e")C=C.slice(0,J-1|0)+("0"+C.slice(J-1|0))}else{var K=F;if(H<0){K=K-(H+1|0)|0;C=B.toFixed(K)}else while(function(){C=B.toFixed(K);return C.length>(F+1|0)}())K=K-1|0;if(K!==0){var L=C.length-1|0;while(C[L]==="0")L=L-1|0;if(C[L]===".")L=L-1|0;C=C.slice(0,L+1|0)}}break;default:}}else{C="inf";z[2]=" "}return n(z,C)}var r=function r(x,e){__p&&__p();var y=+x;if(x.length>0&&y===y)return y;x=x.replace(/_/g,"");y=+x;if(x.length>0&&y===y||/^[+-]?nan$/i.test(x))return y;if(/^ *0x[0-9a-f_]+p[+-]?[0-9_]+/i.test(x)){var z=x.indexOf("p");z=z==-1?x.indexOf("P"):z;var A=+x.substring(z+1);y=+x.substring(0,z);return y*Math.pow(2,A)}if(/^\+?inf(inity)?$/i.test(x))return Infinity;if(/^-inf(inity)?$/i.test(x))return-Infinity;e("float_of_string")};function s(x){return c("bs_curry")._2(r,x,e)}var t=o,u=o,v=i,w=i;d.caml_format_float=q;d.caml_format_int=o;d.caml_nativeint_format=t;d.caml_int32_format=u;d.caml_float_of_string=s;d.caml_int64_format=p;d.caml_int_of_string=i;d.caml_int32_of_string=v;d.caml_int64_of_string=j;d.caml_nativeint_of_string=w}),null);
__d("bs_caml_io",["bs_curry","bs_caml_builtin_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(u,v){return u+v}var i=["",function(u,v){var w=v.length-1|0;if(typeof process!=="undefined"&&process.stdout&&process.stdout.write)return process.stdout.write(v);else if(v[w]==="\n")return 0;else return 0}],j=["",function(u,v){var w=v.length-1|0;if(v[w]==="\n")return 0;else return 0}];function k(){throw[c("bs_caml_builtin_exceptions").failure,"caml_ml_open_descriptor_in not implemented"]}function l(){throw[c("bs_caml_builtin_exceptions").failure,"caml_ml_open_descriptor_out not implemented"]}function m(u){if(u[0]!==""){c("bs_curry")._2(u[1],u,u[0]);u[0]="";return 0}else return 0}var n=function n(u){return typeof process!=="undefined"&&process.stdout&&(process.stdout.write(u),true)};function o(u,v,w,x){__p&&__p();var y=w===0&&x===v.length?v:v.slice(w,x);if(typeof process!=="undefined"&&process.stdout&&process.stdout.write&&u===i)return process.stdout.write(y);else{var z=y.lastIndexOf("\n");if(z<0){u[0]=u[0]+y;return 0}else{u[0]=u[0]+y.slice(0,z+1|0);m(u);u[0]=u[0]+y.slice(z+1|0);return 0}}}function p(u,v){return o(u,String.fromCharCode(v),0,1)}function q(u,v,w,x){throw[c("bs_caml_builtin_exceptions").failure,"caml_ml_input ic not implemented"]}function r(){throw[c("bs_caml_builtin_exceptions").failure,"caml_ml_input_char not implemnted"]}function s(){return[i,[j,0]]}var t=undefined;g.$caret=h;g.stdin=t;g.stdout=i;g.stderr=j;g.caml_ml_open_descriptor_in=k;g.caml_ml_open_descriptor_out=l;g.caml_ml_flush=m;g.node_std_output=n;g.caml_ml_output=o;g.caml_ml_output_char=p;g.caml_ml_input=q;g.caml_ml_input_char=r;g.caml_ml_out_channels_list=s}),null);
__d("bs_caml_missing_polyfill",[],(function a(b,c,d,e,f,g){"use strict";function h(i){var j=i+" not implemented by BuckleScript yet\n";throw new Error(j)}g.not_implemented=h}),null);
__d("bs_caml_sys",["bs_caml_builtin_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(q){var r=typeof process==="undefined"?undefined:process;if(r!==undefined){var s=r.env[q];if(s!==undefined)return s;else throw c("bs_caml_builtin_exceptions").not_found}else throw c("bs_caml_builtin_exceptions").not_found}function i(){var q=typeof process==="undefined"?undefined:process;if(q!==undefined)return q.uptime();else return-1}function j(){return[((Date.now()|0)^4294967295)*Math.random()|0]}function k(){return 127}function l(){var q=typeof process==="undefined"?undefined:process;if(q!==undefined)return q.cwd();else return"/"}function m(){var q=typeof process==="undefined"?undefined:process;if(q!==undefined)if(q.argv==null)return["",[""]];else return[q.argv[0],q.argv];else return["",[""]]}function n(q){var r=typeof process==="undefined"?undefined:process;if(r!==undefined)return r.exit(q);else return 0}function o(){throw[c("bs_caml_builtin_exceptions").failure,"caml_sys_is_directory not implemented"]}function p(){throw[c("bs_caml_builtin_exceptions").failure,"caml_sys_file_exists not implemented"]}g.caml_sys_getenv=h;g.caml_sys_time=i;g.caml_sys_random_seed=j;g.caml_sys_system_command=k;g.caml_sys_getcwd=l;g.caml_sys_get_argv=m;g.caml_sys_exit=n;g.caml_sys_is_directory=o;g.caml_sys_file_exists=p}),null);
__d("bs_camlinternalFormatBasics",["bs_block"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){__p&&__p();if(typeof k==="number")return 0;else switch(k.tag|0){case 0:return c("bs_block").__(0,[h(k[0])]);case 1:return c("bs_block").__(1,[h(k[0])]);case 2:return c("bs_block").__(2,[h(k[0])]);case 3:return c("bs_block").__(3,[h(k[0])]);case 4:return c("bs_block").__(4,[h(k[0])]);case 5:return c("bs_block").__(5,[h(k[0])]);case 6:return c("bs_block").__(6,[h(k[0])]);case 7:return c("bs_block").__(7,[h(k[0])]);case 8:return c("bs_block").__(8,[k[0],h(k[1])]);case 9:var l=k[0];return c("bs_block").__(9,[l,l,h(k[2])]);case 10:return c("bs_block").__(10,[h(k[0])]);case 11:return c("bs_block").__(11,[h(k[0])]);case 12:return c("bs_block").__(12,[h(k[0])]);case 13:return c("bs_block").__(13,[h(k[0])]);case 14:return c("bs_block").__(14,[h(k[0])])}}function i(k,l){__p&&__p();if(typeof k==="number")return l;else switch(k.tag|0){case 0:return c("bs_block").__(0,[i(k[0],l)]);case 1:return c("bs_block").__(1,[i(k[0],l)]);case 2:return c("bs_block").__(2,[i(k[0],l)]);case 3:return c("bs_block").__(3,[i(k[0],l)]);case 4:return c("bs_block").__(4,[i(k[0],l)]);case 5:return c("bs_block").__(5,[i(k[0],l)]);case 6:return c("bs_block").__(6,[i(k[0],l)]);case 7:return c("bs_block").__(7,[i(k[0],l)]);case 8:return c("bs_block").__(8,[k[0],i(k[1],l)]);case 9:return c("bs_block").__(9,[k[0],k[1],i(k[2],l)]);case 10:return c("bs_block").__(10,[i(k[0],l)]);case 11:return c("bs_block").__(11,[i(k[0],l)]);case 12:return c("bs_block").__(12,[i(k[0],l)]);case 13:return c("bs_block").__(13,[i(k[0],l)]);case 14:return c("bs_block").__(14,[i(k[0],l)])}}function j(k,l){__p&&__p();if(typeof k==="number")return l;else switch(k.tag|0){case 0:return c("bs_block").__(0,[j(k[0],l)]);case 1:return c("bs_block").__(1,[j(k[0],l)]);case 2:return c("bs_block").__(2,[k[0],j(k[1],l)]);case 3:return c("bs_block").__(3,[k[0],j(k[1],l)]);case 4:return c("bs_block").__(4,[k[0],k[1],k[2],j(k[3],l)]);case 5:return c("bs_block").__(5,[k[0],k[1],k[2],j(k[3],l)]);case 6:return c("bs_block").__(6,[k[0],k[1],k[2],j(k[3],l)]);case 7:return c("bs_block").__(7,[k[0],k[1],k[2],j(k[3],l)]);case 8:return c("bs_block").__(8,[k[0],k[1],k[2],j(k[3],l)]);case 9:return c("bs_block").__(9,[j(k[0],l)]);case 10:return c("bs_block").__(10,[j(k[0],l)]);case 11:return c("bs_block").__(11,[k[0],j(k[1],l)]);case 12:return c("bs_block").__(12,[k[0],j(k[1],l)]);case 13:return c("bs_block").__(13,[k[0],k[1],j(k[2],l)]);case 14:return c("bs_block").__(14,[k[0],k[1],j(k[2],l)]);case 15:return c("bs_block").__(15,[j(k[0],l)]);case 16:return c("bs_block").__(16,[j(k[0],l)]);case 17:return c("bs_block").__(17,[k[0],j(k[1],l)]);case 18:return c("bs_block").__(18,[k[0],j(k[1],l)]);case 19:return c("bs_block").__(19,[j(k[0],l)]);case 20:return c("bs_block").__(20,[k[0],k[1],j(k[2],l)]);case 21:return c("bs_block").__(21,[k[0],j(k[1],l)]);case 22:return c("bs_block").__(22,[j(k[0],l)]);case 23:return c("bs_block").__(23,[k[0],j(k[1],l)]);case 24:return c("bs_block").__(24,[k[0],k[1],j(k[2],l)])}}g.concat_fmtty=i;g.erase_rel=h;g.concat_fmt=j}),null);
__d("bs_pervasives",["bs_curry","bs_caml_io","bs_caml_sys","bs_caml_format","bs_caml_string","bs_caml_exceptions","bs_caml_missing_polyfill","bs_caml_builtin_exceptions","bs_camlinternalFormatBasics"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function c(R){throw[a("bs_caml_builtin_exceptions").failure,R]}function d(R){throw[a("bs_caml_builtin_exceptions").invalid_argument,R]}var e=a("bs_caml_exceptions").create("Pervasives.Exit");function f(R){if(R>=0)return R;else return-R|0}function g(R){return R^-1}var h=-2147483648;function i(R){if(R<0||R>255)throw[a("bs_caml_builtin_exceptions").invalid_argument,"char_of_int"];else return R}function j(R){if(R)return"true";else return"false"}function k(R){switch(R){case"false":return false;case"true":return true;default:throw[a("bs_caml_builtin_exceptions").invalid_argument,"bool_of_string"]}}function l(R){__p&&__p();var S=R.length,T=0;while(true){var U=T;if(U>=S)return R+".";else{var V=a("bs_caml_string").get(R,U);if(V>=48)if(V>=58)return R;else{T=U+1|0;continue}else if(V!==45)return R;else{T=U+1|0;continue}}}}function m(R){return l(a("bs_caml_format").caml_format_float("%.12g",R))}function n(R,S){if(R)return[R[0],n(R[1],S)];else return S}var o=a("bs_caml_io").stdin,p=a("bs_caml_io").stdout,q=a("bs_caml_io").stderr;function r(R,S,T){return a("bs_caml_io").caml_ml_open_descriptor_out(a("bs_caml_missing_polyfill").not_implemented("caml_sys_open"))}function s(R){return r([1,[3,[4,[7,0]]]],438,R)}function t(R){return r([1,[3,[4,[6,0]]]],438,R)}function u(){__p&&__p();var R=a("bs_caml_io").caml_ml_out_channels_list(0);while(true){var S=R;if(S){try{a("bs_caml_io").caml_ml_flush(S[0])}catch(T){}R=S[1];continue}else return 0}}function v(R,S){return a("bs_caml_io").caml_ml_output(R,S,0,S.length)}function w(R,S){return a("bs_caml_io").caml_ml_output(R,S,0,S.length)}function x(R,S,T,U){if(T<0||U<0||T>(S.length-U|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"output"];else return a("bs_caml_io").caml_ml_output(R,S,T,U)}function y(R,S,T,U){if(T<0||U<0||T>(S.length-U|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"output_substring"];else return a("bs_caml_io").caml_ml_output(R,S,T,U)}function z(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_output_value")}function A(R){a("bs_caml_io").caml_ml_flush(R);return a("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}function B(R){try{a("bs_caml_io").caml_ml_flush(R)}catch(S){}try{return a("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}catch(T){return 0}}function C(R,S,T){return a("bs_caml_io").caml_ml_open_descriptor_in(a("bs_caml_missing_polyfill").not_implemented("caml_sys_open"))}function D(R){return C([0,[7,0]],0,R)}function E(R){return C([0,[6,0]],0,R)}function F(R,S,T,U){if(T<0||U<0||T>(S.length-U|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"input"];else return a("bs_caml_missing_polyfill").not_implemented("caml_ml_input")}function G(R,S,T,U){__p&&__p();while(true){var V=U,W=T;if(V<=0)return 0;else{var X=a("bs_caml_missing_polyfill").not_implemented("caml_ml_input");if(X===0)throw a("bs_caml_builtin_exceptions").end_of_file;else{U=V-X|0;T=W+X|0;continue}}}}function H(R,S,T,U){if(T<0||U<0||T>(S.length-U|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"really_input"];else return G(R,S,T,U)}function I(R,S){var T=a("bs_caml_string").caml_create_string(S);H(R,T,0,S);return a("bs_caml_string").bytes_to_string(T)}function J(R){__p&&__p();var S=function S(U,V,W){__p&&__p();while(true){var X=W,Y=V;if(X){var Z=X[0],$=Z.length;a("bs_caml_string").caml_blit_bytes(Z,0,U,Y-$|0,$);W=X[1];V=Y-$|0;continue}else return U}},T=function T(U,V){__p&&__p();while(true){var W=V,X=U,Y=a("bs_caml_missing_polyfill").not_implemented("caml_ml_input_scan_line");if(Y===0)if(X)return S(a("bs_caml_string").caml_create_string(W),W,X);else throw a("bs_caml_builtin_exceptions").end_of_file;else if(Y>0){var Z=a("bs_caml_string").caml_create_string(Y-1|0);a("bs_caml_missing_polyfill").not_implemented("caml_ml_input");a("bs_caml_io").caml_ml_input_char(R);if(X){var $=(W+Y|0)-1|0;return S(a("bs_caml_string").caml_create_string($),$,[Z,X])}else return Z}else{var Ua=a("bs_caml_string").caml_create_string(-Y|0);a("bs_caml_missing_polyfill").not_implemented("caml_ml_input");V=W-Y|0;U=[Ua,X];continue}}};return a("bs_caml_string").bytes_to_string(T(0,0))}function K(){try{return a("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}catch(R){return 0}}function L(R){return a("bs_caml_io").caml_ml_output_char(p,R)}function M(R){return w(p,R)}function N(R){return v(p,R)}function O(R){return w(p,String(R))}function fa(R){return w(p,l(a("bs_caml_format").caml_format_float("%.12g",R)))}function ga(){a("bs_caml_io").caml_ml_output_char(p,10);return a("bs_caml_io").caml_ml_flush(p)}function ha(R){return a("bs_caml_io").caml_ml_output_char(q,R)}function ia(R){return w(q,R)}function ja(R){return v(q,R)}function ka(R){return w(q,String(R))}function la(R){return w(q,l(a("bs_caml_format").caml_format_float("%.12g",R)))}function ma(){a("bs_caml_io").caml_ml_output_char(q,10);return a("bs_caml_io").caml_ml_flush(q)}function na(){a("bs_caml_io").caml_ml_flush(p);return J(o)}function oa(){return a("bs_caml_format").caml_int_of_string((a("bs_caml_io").caml_ml_flush(p),J(o)))}function pa(){return a("bs_caml_format").caml_float_of_string((a("bs_caml_io").caml_ml_flush(p),J(o)))}function qa(R){return R[1]}function ra(R,S){return[a("bs_camlinternalFormatBasics").concat_fmt(R[0],S[0]),R[1]+("%,"+S[1])]}var P=[u];function sa(R){var S=P[0];P[0]=function(){a("bs_curry")._1(R,0);return a("bs_curry")._1(S,0)};return 0}function Q(){return a("bs_curry")._1(P[0],0)}function ta(R){Q(0);return a("bs_caml_sys").caml_sys_exit(R)}var ua=2147483647,va=2220446049250313e-31,wa=a("bs_caml_io").caml_ml_flush,xa=a("bs_caml_io").caml_ml_output_char,ya=a("bs_caml_io").caml_ml_output_char;function za(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_output_int")}function Aa(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_out")}function Ba(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_out")}function Ca(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size")}function Da(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_set_binary_mode")}var Ea=a("bs_caml_io").caml_ml_input_char,Fa=a("bs_caml_io").caml_ml_input_char;function Ga(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_input_int")}function Ha(){return a("bs_caml_missing_polyfill").not_implemented("caml_input_value")}function Ia(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_in")}function Ja(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_in")}function Ka(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size")}function La(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}function Ma(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_set_binary_mode")}function Na(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_out_64")}function Oa(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_out_64")}function Pa(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size_64")}function Qa(R,S){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_in_64")}function Ra(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_in_64")}function Sa(){return a("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size_64")}var Ta=[Na,Oa,Pa,Qa,Ra,Sa];b.invalid_arg=d;b.failwith=c;b.Exit=e;b.abs=f;b.max_int=ua;b.min_int=h;b.lnot=g;b.epsilon_float=va;b.char_of_int=i;b.string_of_bool=j;b.bool_of_string=k;b.string_of_float=m;b.$at=n;b.stdin=o;b.stdout=p;b.stderr=q;b.print_char=L;b.print_string=M;b.print_bytes=N;b.print_int=O;b.print_float=fa;b.print_newline=ga;b.prerr_char=ha;b.prerr_string=ia;b.prerr_bytes=ja;b.prerr_int=ka;b.prerr_float=la;b.prerr_newline=ma;b.read_line=na;b.read_int=oa;b.read_float=pa;b.open_out=s;b.open_out_bin=t;b.open_out_gen=r;b.flush=wa;b.flush_all=u;b.output_char=xa;b.output_string=w;b.output_bytes=v;b.output=x;b.output_substring=y;b.output_byte=ya;b.output_binary_int=za;b.output_value=z;b.seek_out=Aa;b.pos_out=Ba;b.out_channel_length=Ca;b.close_out=A;b.close_out_noerr=B;b.set_binary_mode_out=Da;b.open_in=D;b.open_in_bin=E;b.open_in_gen=C;b.input_char=Ea;b.input_line=J;b.input=F;b.really_input=H;b.really_input_string=I;b.input_byte=Fa;b.input_binary_int=Ga;b.input_value=Ha;b.seek_in=Ia;b.pos_in=Ja;b.in_channel_length=Ka;b.close_in=La;b.close_in_noerr=K;b.set_binary_mode_in=Ma;b.LargeFile=Ta;b.string_of_format=qa;b.$caret$caret=ra;b.exit=ta;b.at_exit=sa;b.valid_float_lexem=l;b.unsafe_really_input=G;b.do_at_exit=Q}),null);
__d("bs_list",["bs_curry","bs_caml_obj","bs_pervasives","bs_caml_builtin_exceptions"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function c(q){__p&&__p();var r=0,s=q;while(true){var t=s,u=r;if(t){s=t[1];r=u+1|0;continue}else return u}}function fa(q){if(q)return q[0];else throw[a("bs_caml_builtin_exceptions").failure,"hd"]}function ga(q){if(q)return q[1];else throw[a("bs_caml_builtin_exceptions").failure,"tl"]}function ha(q,r){__p&&__p();if(r<0)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.nth"];else{var s=q,t=r;while(true){var u=t,v=s;if(v)if(u===0)return v[0];else{t=u-1|0;s=v[1];continue}else throw[a("bs_caml_builtin_exceptions").failure,"nth"]}}}function d(q,r){while(true){var s=r,t=q;if(t){r=[t[0],s];q=t[1];continue}else return s}}function ia(q){return d(q,0)}function e(q){if(q)return a("bs_pervasives").$at(q[0],e(q[1]));else return 0}function f(q,r){if(r){var s=a("bs_curry")._1(q,r[0]);return[s,f(q,r[1])]}else return 0}function g(q,r,s){if(s){var t=a("bs_curry")._2(r,q,s[0]);return[t,g(q+1|0,r,s[1])]}else return 0}function ja(q,r){return g(0,q,r)}function ka(q,r){__p&&__p();var s=0,t=r;while(true){var u=t,v=s;if(u){t=u[1];s=[a("bs_curry")._1(q,u[0]),v];continue}else return v}}function la(q,r){while(true){var s=r;if(s){a("bs_curry")._1(q,s[0]);r=s[1];continue}else return 0}}function ma(q,r){__p&&__p();var s=0,t=q,u=r;while(true){var v=u,w=s;if(v){a("bs_curry")._2(t,w,v[0]);u=v[1];s=w+1|0;continue}else return 0}}function na(q,r,s){while(true){var t=s,u=r;if(t){s=t[1];r=a("bs_curry")._2(q,u,t[0]);continue}else return u}}function h(q,r,s){if(r)return a("bs_curry")._2(q,r[0],h(q,r[1],s));else return s}function i(q,r,s){if(r)if(s){var t=a("bs_curry")._2(q,r[0],s[0]);return[t,i(q,r[1],s[1])]}else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.map2"];else if(s)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.map2"];else return 0}function oa(q,r,s){__p&&__p();var t=0,u=r,v=s;while(true){var w=v,x=u,y=t;if(x)if(w){v=w[1];u=x[1];t=[a("bs_curry")._2(q,x[0],w[0]),y];continue}else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.rev_map2"];else if(w)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.rev_map2"];else return y}}function pa(q,r,s){__p&&__p();while(true){var t=s,u=r;if(u)if(t){a("bs_curry")._2(q,u[0],t[0]);s=t[1];r=u[1];continue}else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.iter2"];else if(t)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.iter2"];else return 0}}function qa(q,r,s,t){__p&&__p();while(true){var u=t,v=s,w=r;if(v)if(u){t=u[1];s=v[1];r=a("bs_curry")._3(q,w,v[0],u[0]);continue}else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.fold_left2"];else if(u)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.fold_left2"];else return w}}function j(q,r,s,t){if(r)if(s)return a("bs_curry")._3(q,r[0],s[0],j(q,r[1],s[1],t));else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.fold_right2"];else if(s)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.fold_right2"];else return t}function ra(q,r){__p&&__p();while(true){var s=r;if(s)if(a("bs_curry")._1(q,s[0])){r=s[1];continue}else return false;else return true}}function sa(q,r){__p&&__p();while(true){var s=r;if(s)if(a("bs_curry")._1(q,s[0]))return true;else{r=s[1];continue}else return false}}function ta(q,r,s){__p&&__p();while(true){var t=s,u=r;if(u)if(t)if(a("bs_curry")._2(q,u[0],t[0])){s=t[1];r=u[1];continue}else return false;else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.for_all2"];else if(t)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.for_all2"];else return true}}function ua(q,r,s){__p&&__p();while(true){var t=s,u=r;if(u)if(t)if(a("bs_curry")._2(q,u[0],t[0]))return true;else{s=t[1];r=u[1];continue}else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.exists2"];else if(t)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.exists2"];else return false}}function va(q,r){__p&&__p();while(true){var s=r;if(s)if(a("bs_caml_obj").caml_equal(s[0],q))return true;else{r=s[1];continue}else return false}}function wa(q,r){__p&&__p();while(true){var s=r;if(s)if(s[0]===q)return true;else{r=s[1];continue}else return false}}function xa(q,r){__p&&__p();while(true){var s=r;if(s){var t=s[0];if(a("bs_caml_obj").caml_equal(t[0],q))return t[1];else{r=s[1];continue}}else throw a("bs_caml_builtin_exceptions").not_found}}function ya(q,r){__p&&__p();while(true){var s=r;if(s){var t=s[0];if(t[0]===q)return t[1];else{r=s[1];continue}}else throw a("bs_caml_builtin_exceptions").not_found}}function za(q,r){__p&&__p();while(true){var s=r;if(s)if(a("bs_caml_obj").caml_equal(s[0][0],q))return true;else{r=s[1];continue}else return false}}function Aa(q,r){__p&&__p();while(true){var s=r;if(s)if(s[0][0]===q)return true;else{r=s[1];continue}else return false}}function k(q,r){if(r){var s=r[1],t=r[0];if(a("bs_caml_obj").caml_equal(t[0],q))return s;else return[t,k(q,s)]}else return 0}function l(q,r){if(r){var s=r[1],t=r[0];if(t[0]===q)return s;else return[t,l(q,s)]}else return 0}function Ba(q,r){__p&&__p();while(true){var s=r;if(s){var t=s[0];if(a("bs_curry")._1(q,t))return t;else{r=s[1];continue}}else throw a("bs_caml_builtin_exceptions").not_found}}function Ca(q){__p&&__p();return function(r){__p&&__p();var s=0,t=r;while(true){var u=t,v=s;if(u){var w=u[1],x=u[0];if(a("bs_curry")._1(q,x)){t=w;s=[x,v];continue}else{t=w;continue}}else return d(v,0)}}}function Da(q,r){__p&&__p();var s=0,t=0,u=r;while(true){var v=u,w=t,x=s;if(v){var y=v[1],z=v[0];if(a("bs_curry")._1(q,z)){u=y;s=[z,x];continue}else{u=y;t=[z,w];continue}}else return[d(x,0),d(w,0)]}}function Ea(q){if(q){var r=q[0],s=Ea(q[1]);return[[r[0],s[0]],[r[1],s[1]]]}else return[0,0]}function Fa(q,r){if(q)if(r)return[[q[0],r[0]],Fa(q[1],r[1])];else throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.combine"];else if(r)throw[a("bs_caml_builtin_exceptions").invalid_argument,"List.combine"];else return 0}function m(q,r,s){if(r)if(s){var t=s[0],u=r[0];if(a("bs_curry")._2(q,u,t)<=0)return[u,m(q,r[1],s)];else return[t,m(q,r,s[1])]}else return r;else return s}function n(q,r){__p&&__p();while(true){var s=r,t=q;if(t===0)return s;else if(s){r=s[1];q=t-1|0;continue}else throw[a("bs_caml_builtin_exceptions").assert_failure,["list.ml",223,11]]}}function o(q,r){__p&&__p();var p=function p(u,r){__p&&__p();var v=0;if(u!==2)if(u!==3||!r)v=1;else{var w=r[1];if(w){var x=w[1];if(x){var y=x[0],z=w[0],A=r[0];if(a("bs_curry")._2(q,A,z)<=0)if(a("bs_curry")._2(q,z,y)<=0)return[A,[z,[y,0]]];else if(a("bs_curry")._2(q,A,y)<=0)return[A,[y,[z,0]]];else return[y,[A,[z,0]]];else if(a("bs_curry")._2(q,A,y)<=0)return[z,[A,[y,0]]];else if(a("bs_curry")._2(q,z,y)<=0)return[z,[y,[A,0]]];else return[y,[z,[A,0]]]}else v=1}else v=1}else if(r){var B=r[1];if(B){var C=B[0],D=r[0];if(a("bs_curry")._2(q,D,C)<=0)return[D,[C,0]];else return[C,[D,0]]}else v=1}else v=1;if(v===1){var E=u>>1,F=u-E|0,G=n(E,r),H=s(E,r),I=s(F,G),J=H,K=I,L=0;while(true){var M=L,N=K,O=J;if(O)if(N){var P=N[0],Q=O[0];if(a("bs_curry")._2(q,Q,P)>0){L=[Q,M];J=O[1];continue}else{L=[P,M];K=N[1];continue}}else return d(O,M);else return d(N,M)}}},s=function s(u,r){__p&&__p();var v=0;if(u!==2)if(u!==3||!r)v=1;else{var w=r[1];if(w){var x=w[1];if(x){var y=x[0],z=w[0],A=r[0];if(a("bs_curry")._2(q,A,z)>0)if(a("bs_curry")._2(q,z,y)>0)return[A,[z,[y,0]]];else if(a("bs_curry")._2(q,A,y)>0)return[A,[y,[z,0]]];else return[y,[A,[z,0]]];else if(a("bs_curry")._2(q,A,y)>0)return[z,[A,[y,0]]];else if(a("bs_curry")._2(q,z,y)>0)return[z,[y,[A,0]]];else return[y,[z,[A,0]]]}else v=1}else v=1}else if(r){var B=r[1];if(B){var C=B[0],D=r[0];if(a("bs_curry")._2(q,D,C)>0)return[D,[C,0]];else return[C,[D,0]]}else v=1}else v=1;if(v===1){var E=u>>1,F=u-E|0,G=n(E,r),H=p(E,r),I=p(F,G),J=H,K=I,L=0;while(true){var M=L,N=K,O=J;if(O)if(N){var P=N[0],Q=O[0];if(a("bs_curry")._2(q,Q,P)<=0){L=[Q,M];J=O[1];continue}else{L=[P,M];K=N[1];continue}}else return d(O,M);else return d(N,M)}}},t=c(r);if(t<2)return r;else return p(t,r)}function Ga(q,r){__p&&__p();var p=function p(u,r){__p&&__p();var v=0;if(u!==2)if(u!==3||!r)v=1;else{var w=r[1];if(w){var x=w[1];if(x){var y=x[0],z=w[0],A=r[0],B=a("bs_curry")._2(q,A,z);if(B===0){var C=a("bs_curry")._2(q,z,y);if(C===0)return[z,0];else if(C<0)return[z,[y,0]];else return[y,[z,0]]}else if(B<0){var D=a("bs_curry")._2(q,z,y);if(D===0)return[A,[z,0]];else if(D<0)return[A,[z,[y,0]]];else{var E=a("bs_curry")._2(q,A,y);if(E===0)return[A,[z,0]];else if(E<0)return[A,[y,[z,0]]];else return[y,[A,[z,0]]]}}else{var F=a("bs_curry")._2(q,A,y);if(F===0)return[z,[A,0]];else if(F<0)return[z,[A,[y,0]]];else{var G=a("bs_curry")._2(q,z,y);if(G===0)return[z,[A,0]];else if(G<0)return[z,[y,[A,0]]];else return[y,[z,[A,0]]]}}}else v=1}else v=1}else if(r){var H=r[1];if(H){var I=H[0],J=r[0],K=a("bs_curry")._2(q,J,I);if(K===0)return[J,0];else if(K<0)return[J,[I,0]];else return[I,[J,0]]}else v=1}else v=1;if(v===1){var L=u>>1,M=u-L|0,N=n(L,r),O=s(L,r),P=s(M,N),Q=O,R=P,S=0;while(true){var T=S,U=R,V=Q;if(V)if(U){var W=U[1],X=U[0],Y=V[1],Z=V[0],$=a("bs_curry")._2(q,Z,X);if($===0){S=[Z,T];R=W;Q=Y;continue}else if($>0){S=[Z,T];Q=Y;continue}else{S=[X,T];R=W;continue}}else return d(V,T);else return d(U,T)}}},s=function s(u,r){__p&&__p();var v=0;if(u!==2)if(u!==3||!r)v=1;else{var w=r[1];if(w){var x=w[1];if(x){var y=x[0],z=w[0],A=r[0],B=a("bs_curry")._2(q,A,z);if(B===0){var C=a("bs_curry")._2(q,z,y);if(C===0)return[z,0];else if(C>0)return[z,[y,0]];else return[y,[z,0]]}else if(B>0){var D=a("bs_curry")._2(q,z,y);if(D===0)return[A,[z,0]];else if(D>0)return[A,[z,[y,0]]];else{var E=a("bs_curry")._2(q,A,y);if(E===0)return[A,[z,0]];else if(E>0)return[A,[y,[z,0]]];else return[y,[A,[z,0]]]}}else{var F=a("bs_curry")._2(q,A,y);if(F===0)return[z,[A,0]];else if(F>0)return[z,[A,[y,0]]];else{var G=a("bs_curry")._2(q,z,y);if(G===0)return[z,[A,0]];else if(G>0)return[z,[y,[A,0]]];else return[y,[z,[A,0]]]}}}else v=1}else v=1}else if(r){var H=r[1];if(H){var I=H[0],J=r[0],K=a("bs_curry")._2(q,J,I);if(K===0)return[J,0];else if(K>0)return[J,[I,0]];else return[I,[J,0]]}else v=1}else v=1;if(v===1){var L=u>>1,M=u-L|0,N=n(L,r),O=p(L,r),P=p(M,N),Q=O,R=P,S=0;while(true){var T=S,U=R,V=Q;if(V)if(U){var W=U[1],X=U[0],Y=V[1],Z=V[0],$=a("bs_curry")._2(q,Z,X);if($===0){S=[Z,T];R=W;Q=Y;continue}else if($<0){S=[Z,T];Q=Y;continue}else{S=[X,T];R=W;continue}}else return d(V,T);else return d(U,T)}}},t=c(r);if(t<2)return r;else return p(t,r)}var Ha=a("bs_pervasives").$at,Ia=e,Ja=Ca,p=o,Ka=o;b.length=c;b.hd=fa;b.tl=ga;b.nth=ha;b.rev=ia;b.append=Ha;b.rev_append=d;b.concat=Ia;b.flatten=e;b.iter=la;b.iteri=ma;b.map=f;b.mapi=ja;b.rev_map=ka;b.fold_left=na;b.fold_right=h;b.iter2=pa;b.map2=i;b.rev_map2=oa;b.fold_left2=qa;b.fold_right2=j;b.for_all=ra;b.exists=sa;b.for_all2=ta;b.exists2=ua;b.mem=va;b.memq=wa;b.find=Ba;b.filter=Ja;b.find_all=Ca;b.partition=Da;b.assoc=xa;b.assq=ya;b.mem_assoc=za;b.mem_assq=Aa;b.remove_assoc=k;b.remove_assq=l;b.split=Ea;b.combine=Fa;b.sort=p;b.stable_sort=o;b.fast_sort=Ka;b.sort_uniq=Ga;b.merge=m}),null);
__d("bs_bytes",["bs_char","bs_list","bs_curry","bs_caml_obj","bs_caml_int32","bs_caml_string","bs_caml_primitive","bs_caml_builtin_exceptions"],(function a(aa,b,ba,ca,da,c){"use strict";__p&&__p();function d(P,Q){var R=b("bs_caml_string").caml_create_string(P);b("bs_caml_string").caml_fill_string(R,0,P,Q);return R}function e(P,Q){var R=b("bs_caml_string").caml_create_string(P);for(var S=0,T=P-1|0;S<=T;++S)R[S]=b("bs_curry")._1(Q,S);return R}var f=[];function g(P){var Q=P.length,R=b("bs_caml_string").caml_create_string(Q);b("bs_caml_string").caml_blit_bytes(P,0,R,0,Q);return R}function h(P){return b("bs_caml_string").bytes_to_string(g(P))}function i(P){return g(b("bs_caml_string").bytes_of_string(P))}function j(P,Q,R){if(Q<0||R<0||Q>(P.length-R|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.sub / Bytes.sub"];else{var S=b("bs_caml_string").caml_create_string(R);b("bs_caml_string").caml_blit_bytes(P,Q,S,0,R);return S}}function k(P,Q,R){return b("bs_caml_string").bytes_to_string(j(P,Q,R))}function l(P,Q,R){var S=(P.length+Q|0)+R|0,T=b("bs_caml_string").caml_create_string(S),U=Q<0?[-Q|0,0]:[0,Q],V=U[1],W=U[0],X=b("bs_caml_primitive").caml_int_min(P.length-W|0,S-V|0);if(X>0)b("bs_caml_string").caml_blit_bytes(P,W,T,V,X);return T}function m(P,Q,R,S){if(Q<0||R<0||Q>(P.length-R|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.fill / Bytes.fill"];else return b("bs_caml_string").caml_fill_string(P,Q,R,S)}function n(P,Q,R,S,T){if(T<0||Q<0||Q>(P.length-T|0)||S<0||S>(R.length-T|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"Bytes.blit"];else return b("bs_caml_string").caml_blit_bytes(P,Q,R,S,T)}function o(P,Q,R,S,T){if(T<0||Q<0||Q>(P.length-T|0)||S<0||S>(R.length-T|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.blit / Bytes.blit_string"];else return b("bs_caml_string").caml_blit_string(P,Q,R,S,T)}function p(P,Q){for(var R=0,S=Q.length-1|0;R<=S;++R)b("bs_curry")._1(P,Q[R]);return 0}function q(P,Q){for(var R=0,S=Q.length-1|0;R<=S;++R)b("bs_curry")._2(P,R,Q[R]);return 0}function r(P,Q){__p&&__p();if(Q){var R=Q[0],S=[0],T=[0];b("bs_list").iter(function(W){S[0]=S[0]+1|0;T[0]=T[0]+W.length|0;return 0},Q);var U=b("bs_caml_string").caml_create_string(T[0]+b("bs_caml_int32").imul(P.length,S[0]-1|0)|0);b("bs_caml_string").caml_blit_bytes(R,0,U,0,R.length);var V=[R.length];b("bs_list").iter(function(W){b("bs_caml_string").caml_blit_bytes(P,0,U,V[0],P.length);V[0]=V[0]+P.length|0;b("bs_caml_string").caml_blit_bytes(W,0,U,V[0],W.length);V[0]=V[0]+W.length|0;return 0},Q[1]);return U}else return f}function s(P,Q){var R=P.length,S=Q.length,T=b("bs_caml_string").caml_create_string(R+S|0);b("bs_caml_string").caml_blit_bytes(P,0,T,0,R);b("bs_caml_string").caml_blit_bytes(Q,0,T,R,S);return T}function t(P){var Q=P-9|0;if(Q>4||Q<0)if(Q!==23)return false;else return true;else if(Q!==2)return true;else return false}function u(P){var Q=P.length,R=0;while(R<Q&&t(P[R]))R=R+1|0;var S=Q-1|0;while(S>=R&&t(P[S]))S=S-1|0;if(S>=R)return j(P,R,(S-R|0)+1|0);else return f}function v(P){__p&&__p();var Q=0;for(var R=0,S=P.length-1|0;R<=S;++R){var T=P[R],U;if(T>=32){var V=T-34|0;U=V>58||V<0?V>=93?4:1:V>57||V<1?2:1}else U=T>=11?T!==13?4:2:T>=8?2:4;Q=Q+U|0}if(Q===P.length)return g(P);else{var W=b("bs_caml_string").caml_create_string(Q);Q=0;for(var X=0,Y=P.length-1|0;X<=Y;++X){var Z=P[X],$=0;if(Z>=35)if(Z!==92)if(Z>=127)$=1;else W[Q]=Z;else $=2;else if(Z>=32)if(Z>=34)$=2;else W[Q]=Z;else if(Z>=14)$=1;else switch(Z){case 8:W[Q]=92;Q=Q+1|0;W[Q]=98;break;case 9:W[Q]=92;Q=Q+1|0;W[Q]=116;break;case 10:W[Q]=92;Q=Q+1|0;W[Q]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:$=1;break;case 13:W[Q]=92;Q=Q+1|0;W[Q]=114;break}switch($){case 1:W[Q]=92;Q=Q+1|0;W[Q]=48+(Z/100|0)|0;Q=Q+1|0;W[Q]=48+(Z/10|0)%10|0;Q=Q+1|0;W[Q]=48+Z%10|0;break;case 2:W[Q]=92;Q=Q+1|0;W[Q]=Z;break}Q=Q+1|0}return W}}function w(P,Q){var R=Q.length;if(R===0)return Q;else{var S=b("bs_caml_string").caml_create_string(R);for(var T=0,U=R-1|0;T<=U;++T)S[T]=b("bs_curry")._1(P,Q[T]);return S}}function x(P,Q){var R=Q.length;if(R===0)return Q;else{var S=b("bs_caml_string").caml_create_string(R);for(var T=0,U=R-1|0;T<=U;++T)S[T]=b("bs_curry")._2(P,T,Q[T]);return S}}function y(P){return w(b("bs_char").uppercase,P)}function z(P){return w(b("bs_char").lowercase,P)}function A(P,Q){if(Q.length===0)return Q;else{var R=g(Q);R[0]=b("bs_curry")._1(P,Q[0]);return R}}function B(P){return A(b("bs_char").uppercase,P)}function C(P){return A(b("bs_char").lowercase,P)}function D(P,Q,R,S){__p&&__p();while(true){var T=R;if(T>=Q)throw b("bs_caml_builtin_exceptions").not_found;else if(P[T]===S)return T;else{R=T+1|0;continue}}}function E(P,Q){return D(P,P.length,0,Q)}function F(P,Q,R){var S=P.length;if(Q<0||Q>S)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.index_from / Bytes.index_from"];else return D(P,S,Q,R)}function G(P,Q,R){__p&&__p();while(true){var S=Q;if(S<0)throw b("bs_caml_builtin_exceptions").not_found;else if(P[S]===R)return S;else{Q=S-1|0;continue}}}function H(P,Q){return G(P,P.length-1|0,Q)}function I(P,Q,R){if(Q<-1||Q>=P.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.rindex_from / Bytes.rindex_from"];else return G(P,Q,R)}function J(P,Q,R){var S=P.length;if(Q<0||Q>S)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.contains_from / Bytes.contains_from"];else try{D(P,S,Q,R);return true}catch(T){if(T===b("bs_caml_builtin_exceptions").not_found)return false;else throw T}}function K(P,Q){return J(P,0,Q)}function L(P,Q,R){if(Q<0||Q>=P.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.rcontains_from / Bytes.rcontains_from"];else try{G(P,Q,R);return true}catch(S){if(S===b("bs_caml_builtin_exceptions").not_found)return false;else throw S}}var M=b("bs_caml_obj").caml_compare,N=b("bs_caml_string").bytes_to_string,O=b("bs_caml_string").bytes_of_string;c.make=d;c.init=e;c.empty=f;c.copy=g;c.of_string=i;c.to_string=h;c.sub=j;c.sub_string=k;c.extend=l;c.fill=m;c.blit=n;c.blit_string=o;c.concat=r;c.cat=s;c.iter=p;c.iteri=q;c.map=w;c.mapi=x;c.trim=u;c.escaped=v;c.index=E;c.rindex=H;c.index_from=F;c.rindex_from=I;c.contains=K;c.contains_from=J;c.rcontains_from=L;c.uppercase=y;c.lowercase=z;c.capitalize=B;c.uncapitalize=C;c.compare=M;c.unsafe_to_string=N;c.unsafe_of_string=O}),null);
__d("bs_string",["bs_list","bs_bytes","bs_caml_int32","bs_caml_string","bs_caml_primitive"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(H,I){return c("bs_caml_string").bytes_to_string(c("bs_bytes").make(H,I))}function i(H,I){return c("bs_caml_string").bytes_to_string(c("bs_bytes").init(H,I))}function j(H){return c("bs_caml_string").bytes_to_string(c("bs_bytes").copy(c("bs_caml_string").bytes_of_string(H)))}function k(H,I,J){return c("bs_caml_string").bytes_to_string(c("bs_bytes").sub(c("bs_caml_string").bytes_of_string(H),I,J))}function l(H,I){__p&&__p();if(I){var J=I[0],K=[0],L=[0];c("bs_list").iter(function(O){K[0]=K[0]+1|0;L[0]=L[0]+O.length|0;return 0},I);var M=c("bs_caml_string").caml_create_string(L[0]+c("bs_caml_int32").imul(H.length,K[0]-1|0)|0);c("bs_caml_string").caml_blit_string(J,0,M,0,J.length);var N=[J.length];c("bs_list").iter(function(O){c("bs_caml_string").caml_blit_string(H,0,M,N[0],H.length);N[0]=N[0]+H.length|0;c("bs_caml_string").caml_blit_string(O,0,M,N[0],O.length);N[0]=N[0]+O.length|0;return 0},I[1]);return c("bs_caml_string").bytes_to_string(M)}else return""}function m(H,I){return c("bs_bytes").iter(H,c("bs_caml_string").bytes_of_string(I))}function n(H,I){return c("bs_bytes").iteri(H,c("bs_caml_string").bytes_of_string(I))}function o(H,I){return c("bs_caml_string").bytes_to_string(c("bs_bytes").map(H,c("bs_caml_string").bytes_of_string(I)))}function p(H,I){return c("bs_caml_string").bytes_to_string(c("bs_bytes").mapi(H,c("bs_caml_string").bytes_of_string(I)))}function q(H){var I=H-9|0;if(I>4||I<0)if(I!==23)return false;else return true;else if(I!==2)return true;else return false}function r(H){if(H===""||!(q(H.charCodeAt(0))||q(H.charCodeAt(H.length-1|0))))return H;else return c("bs_caml_string").bytes_to_string(c("bs_bytes").trim(c("bs_caml_string").bytes_of_string(H)))}function s(H){__p&&__p();var I=function I(J){__p&&__p();while(true){var K=J;if(K>=H.length)return false;else{var L=H.charCodeAt(K);if(L>=32){var M=L-34|0;if(M>58||M<0)if(M>=93)return true;else{J=K+1|0;continue}else if(M>57||M<1)return true;else{J=K+1|0;continue}}else return true}}};if(I(0))return c("bs_caml_string").bytes_to_string(c("bs_bytes").escaped(c("bs_caml_string").bytes_of_string(H)));else return H}function t(H,I){return c("bs_bytes").index(c("bs_caml_string").bytes_of_string(H),I)}function u(H,I){return c("bs_bytes").rindex(c("bs_caml_string").bytes_of_string(H),I)}function v(H,I,J){return c("bs_bytes").index_from(c("bs_caml_string").bytes_of_string(H),I,J)}function w(H,I,J){return c("bs_bytes").rindex_from(c("bs_caml_string").bytes_of_string(H),I,J)}function x(H,I){return c("bs_bytes").contains(c("bs_caml_string").bytes_of_string(H),I)}function y(H,I,J){return c("bs_bytes").contains_from(c("bs_caml_string").bytes_of_string(H),I,J)}function z(H,I,J){return c("bs_bytes").rcontains_from(c("bs_caml_string").bytes_of_string(H),I,J)}function A(H){return c("bs_caml_string").bytes_to_string(c("bs_bytes").uppercase(c("bs_caml_string").bytes_of_string(H)))}function B(H){return c("bs_caml_string").bytes_to_string(c("bs_bytes").lowercase(c("bs_caml_string").bytes_of_string(H)))}function C(H){return c("bs_caml_string").bytes_to_string(c("bs_bytes").capitalize(c("bs_caml_string").bytes_of_string(H)))}function D(H){return c("bs_caml_string").bytes_to_string(c("bs_bytes").uncapitalize(c("bs_caml_string").bytes_of_string(H)))}var E=c("bs_caml_primitive").caml_string_compare,F=c("bs_bytes").fill,G=c("bs_bytes").blit_string;g.make=h;g.init=i;g.copy=j;g.sub=k;g.fill=F;g.blit=G;g.concat=l;g.iter=m;g.iteri=n;g.map=o;g.mapi=p;g.trim=r;g.escaped=s;g.index=t;g.rindex=u;g.index_from=v;g.rindex_from=w;g.contains=x;g.contains_from=y;g.rcontains_from=z;g.uppercase=A;g.lowercase=B;g.capitalize=C;g.uncapitalize=D;g.compare=E}),null);
__d("FBID.bs",["invariant","bs_js_exn","bs_string","gkx","bs_js_types"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(l){if(c("gkx")("AT5AGDWr7VWKZPg1PvTz69G07vIW7nWrxrA4PloGCgjyPuof8r7WUUsWLIKzWOZMmcJyN6U1BeEUXZmBqPUEAKAe")){c("bs_js_types").test(l,4)||h(0);l!=="0"||h(0);var m=/^[0-9]+$/;m.test(l)||h(0)}return l}function j(l){try{return[i(l)]}catch(m){var n=c("bs_js_exn").internalToOCamlException(m);if(n[0]===c("bs_js_exn").$$Error)return 0;else throw n}}var k=c("bs_string").compare;g.compare=k;g.ofString=j;g.ofStringExn=i}),null);
__d("bs_array",["bs_curry","bs_js_exn","bs_caml_array","bs_caml_exceptions","bs_caml_builtin_exceptions"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function c(x,y){if(x===0)return[];else if(x<0)throw[a("bs_caml_builtin_exceptions").invalid_argument,"Array.init"];else{var z=a("bs_caml_array").caml_make_vect(x,a("bs_curry")._1(y,0));for(var A=1,B=x-1|0;A<=B;++A)z[A]=a("bs_curry")._1(y,A);return z}}function d(x,y,c){var z=a("bs_caml_array").caml_make_vect(x,[]);for(var A=0,B=x-1|0;A<=B;++A)z[A]=a("bs_caml_array").caml_make_vect(y,c);return z}function e(x){var y=x.length;if(y===0)return[];else return a("bs_caml_array").caml_array_sub(x,0,y)}function f(x,y){var z=x.length;if(z===0)return e(y);else if(y.length===0)return a("bs_caml_array").caml_array_sub(x,0,z);else return x.concat(y)}function g(x,y,z){if(z<0||y>(x.length-z|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"Array.sub"];else return a("bs_caml_array").caml_array_sub(x,y,z)}function h(x,y,z,A){if(y<0||z<0||y>(x.length-z|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"Array.fill"];else{for(var B=y,C=(y+z|0)-1|0;B<=C;++B)x[B]=A;return 0}}function i(x,y,z,A,B){if(B<0||y<0||y>(x.length-B|0)||A<0||A>(z.length-B|0))throw[a("bs_caml_builtin_exceptions").invalid_argument,"Array.blit"];else return a("bs_caml_array").caml_array_blit(x,y,z,A,B)}function j(x,y){for(var z=0,A=y.length-1|0;z<=A;++z)a("bs_curry")._1(x,y[z]);return 0}function k(x,y){var z=y.length;if(z===0)return[];else{var A=a("bs_caml_array").caml_make_vect(z,a("bs_curry")._1(x,y[0]));for(var B=1,C=z-1|0;B<=C;++B)A[B]=a("bs_curry")._1(x,y[B]);return A}}function l(x,y){for(var z=0,A=y.length-1|0;z<=A;++z)a("bs_curry")._2(x,z,y[z]);return 0}function m(x,y){var z=y.length;if(z===0)return[];else{var A=a("bs_caml_array").caml_make_vect(z,a("bs_curry")._2(x,0,y[0]));for(var B=1,C=z-1|0;B<=C;++B)A[B]=a("bs_curry")._2(x,B,y[B]);return A}}function n(x){__p&&__p();var y=x.length-1|0,z=0;while(true){var A=z,B=y;if(B<0)return A;else{z=[x[B],A];y=B-1|0;continue}}}function o(x,y){while(true){var z=y,A=x;if(z){y=z[1];x=A+1|0;continue}else return A}}function p(x){__p&&__p();if(x){var y=a("bs_caml_array").caml_make_vect(o(0,x),x[0]),z=1,A=x[1];while(true){var B=A,C=z;if(B){y[C]=B[0];A=B[1];z=C+1|0;continue}else return y}}else return[]}function q(x,y,z){var A=y;for(var B=0,C=z.length-1|0;B<=C;++B)A=a("bs_curry")._2(x,A,z[B]);return A}function r(x,y,z){var A=z;for(var B=y.length-1|0;B>=0;--B)A=a("bs_curry")._2(x,y[B],A);return A}var s=a("bs_caml_exceptions").create("Array.Bottom");function t(x,y){__p&&__p();var z=function z(D,E){__p&&__p();var I=((E+E|0)+E|0)+1|0,J=I;if((I+2|0)<D){if(a("bs_curry")._2(x,a("bs_caml_array").caml_array_get(y,I),a("bs_caml_array").caml_array_get(y,I+1|0))<0)J=I+1|0;if(a("bs_curry")._2(x,a("bs_caml_array").caml_array_get(y,J),a("bs_caml_array").caml_array_get(y,I+2|0))<0)J=I+2|0;return J}else if((I+1|0)<D&&a("bs_curry")._2(x,a("bs_caml_array").caml_array_get(y,I),a("bs_caml_array").caml_array_get(y,I+1|0))<0)return I+1|0;else if(I<D)return I;else throw[s,E]},A=function A(D,E,G){__p&&__p();try{var I=D,J=E,H=G;while(true){var F=J,K=z(I,F);if(a("bs_curry")._2(x,a("bs_caml_array").caml_array_get(y,K),H)>0){a("bs_caml_array").caml_array_set(y,F,a("bs_caml_array").caml_array_get(y,K));J=K;continue}else return a("bs_caml_array").caml_array_set(y,F,H)}}catch(L){var M=a("bs_js_exn").internalToOCamlException(L);if(M[0]===s)return a("bs_caml_array").caml_array_set(y,M[1],G);else throw M}},B=function B(D,E){__p&&__p();try{var I=D,J=E;while(true){var F=J,K=z(I,F);a("bs_caml_array").caml_array_set(y,F,a("bs_caml_array").caml_array_get(y,K));J=K;continue}}catch(L){var M=a("bs_js_exn").internalToOCamlException(L);if(M[0]===s)return M[1];else throw M}},C=function C(I,G){__p&&__p();while(true){var E=I,J=(E-1|0)/3|0;if(E===J)throw[a("bs_caml_builtin_exceptions").assert_failure,["array.ml",173,4]];if(a("bs_curry")._2(x,a("bs_caml_array").caml_array_get(y,J),G)<0){a("bs_caml_array").caml_array_set(y,E,a("bs_caml_array").caml_array_get(y,J));if(J>0){I=J;continue}else return a("bs_caml_array").caml_array_set(y,0,G)}else return a("bs_caml_array").caml_array_set(y,E,G)}},D=y.length;for(var E=((D+1|0)/3|0)-1|0;E>=0;--E)A(D,E,a("bs_caml_array").caml_array_get(y,E));for(var F=D-1|0;F>=2;--F){var G=a("bs_caml_array").caml_array_get(y,F);a("bs_caml_array").caml_array_set(y,F,a("bs_caml_array").caml_array_get(y,0));C(B(F,0),G)}if(D>1){var H=a("bs_caml_array").caml_array_get(y,1);a("bs_caml_array").caml_array_set(y,1,a("bs_caml_array").caml_array_get(y,0));return a("bs_caml_array").caml_array_set(y,0,H)}else return 0}function u(x,y){__p&&__p();var z=function z(G,H,I,J,K,L,M){__p&&__p();var N=G+H|0,O=J+K|0,P=G,Q=a("bs_caml_array").caml_array_get(y,G),R=J,S=a("bs_caml_array").caml_array_get(I,J),T=M;while(true){var U=T,V=S,W=R,X=Q,Y=P;if(a("bs_curry")._2(x,X,V)<=0){a("bs_caml_array").caml_array_set(L,U,X);var Z=Y+1|0;if(Z<N){T=U+1|0;Q=a("bs_caml_array").caml_array_get(y,Z);P=Z;continue}else return i(I,W,L,U+1|0,O-W|0)}else{a("bs_caml_array").caml_array_set(L,U,V);var $=W+1|0;if($<O){T=U+1|0;S=a("bs_caml_array").caml_array_get(I,$);R=$;continue}else return i(y,Y,L,U+1|0,N-Y|0)}}},A=function A(G,H,I,J){for(var K=0,L=J-1|0;K<=L;++K){var M=a("bs_caml_array").caml_array_get(y,G+K|0),N=(I+K|0)-1|0;while(N>=I&&a("bs_curry")._2(x,a("bs_caml_array").caml_array_get(H,N),M)>0){a("bs_caml_array").caml_array_set(H,N+1|0,a("bs_caml_array").caml_array_get(H,N));N=N-1|0}a("bs_caml_array").caml_array_set(H,N+1|0,M)}return 0},B=function B(G,H,I,J){if(J<=5)return A(G,H,I,J);else{var D=J/2|0,E=J-D|0;B(G+D|0,H,I+D|0,E);B(G,y,G+E|0,D);return z(G+E|0,D,H,I+D|0,E,H,I)}},C=y.length;if(C<=5)return A(0,y,0,C);else{var D=C/2|0,E=C-D|0,F=a("bs_caml_array").caml_make_vect(E,a("bs_caml_array").caml_array_get(y,0));B(D,F,0,E);B(0,y,E,D);return z(E,D,F,0,E,y,0)}}var v=d,w=a("bs_caml_array").caml_array_concat,fa=u;b.init=c;b.make_matrix=d;b.create_matrix=v;b.append=f;b.concat=w;b.sub=g;b.copy=e;b.fill=h;b.blit=i;b.to_list=n;b.of_list=p;b.iter=j;b.map=k;b.iteri=l;b.mapi=m;b.fold_left=q;b.fold_right=r;b.sort=t;b.stable_sort=u;b.fast_sort=fa}),null);
__d("Utils.bs",["bs_array","bs_curry","bs_caml_builtin_exceptions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(q){if(q==null)return false;else return q}function i(q,r){if(q)return q[0];else return r}function j(q){return(q==null?0:[q])!==0}function k(q){if(q)return q[0];else return false}function l(q){if(q==null)return 0;else return[q]}function m(q){if(q)return q[0];else return undefined}function n(q){if(q)return q[0];else return false}function o(q,r){__p&&__p();var s=q,t=r,u=0;while(true){var v=u,w=t;if(w){var x=w[1],y=c("bs_curry")._1(s,w[0]);if(y){u=[y[0],v];t=x;continue}else{t=x;continue}}else return v}}function p(q){return c("bs_array").map(function(r){if(r)return r[0];else throw[c("bs_caml_builtin_exceptions").invalid_argument,"arrayCompact: sorry, something went wrong."]},q.filter(function(r){if(r)return true;else return false}))}g.isTruthy=h;g.$pipe$unknown=i;g.isDefined=j;g.isSomeTrue=k;g.nullUndefinedBooleanToOptionBool=l;g.optionBoolToNullUndefinedBoolean=m;g.optionBoolToBoolean=n;g.listFilterMap=o;g.arrayCompact=p}),null);
__d("bs_js_dict",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=function h(n,o){delete n[o];return 0};function i(n){var o=Object.keys(n),p=o.length,j=new Array(p);for(var q=0,r=p-1|0;q<=r;++q){var s=o[q];j[q]=[s,n[s]]}return j}function j(n){var o=Object.keys(n),p=o.length,q=new Array(p);for(var r=0,s=p-1|0;r<=s;++r)q[r]=n[o[r]];return q}function k(i){__p&&__p();var n={},o=i;while(true){var p=o;if(p){var q=p[0];n[q[0]]=q[1];o=p[1];continue}else return n}}function l(i){var n={},o=i.length;for(var p=0,q=o-1|0;p<=q;++p){var r=i[p];n[r[0]]=r[1]}return n}function m(n,o){var p={},q=Object.keys(o),r=q.length;for(var s=0,t=r-1|0;s<=t;++s){var u=q[s];p[u]=n(o[u])}return p}g.unsafeDeleteKey=h;g.entries=i;g.values=j;g.fromList=k;g.fromArray=l;g.map=m}),null);
__d("MessengerState.bs",["FBID.bs","bs_list","bs_array","bs_block","bs_curry","Utils.bs","Arbiter","bs_js_dict","bs_caml_obj","FBIDCheck","immutable","MercuryIDs","CurrentUser","ReasonReact.bs","bs_js_primitive","MessagingTag","TypingStates","MercuryViewer","ChannelConstants","MercuryActionType","MercuryThreadIDMap","MercuryPayloadSource","setTimeoutAcrossTransitions"],(function aa(ba,a,ca,da,ea,b){"use strict";__p&&__p();function c(n){return n[0]}function fa(n){return n[1]}function ga(n){return n[2]}function ha(n){return n[3]}function ia(n){return n[4]}function ja(n){return n[5]}function d(n){return n[6]}function e(n){var o=new Set();n.forEach(function(p){o.add(p);return 0});return o}function ka(n){return n.reduce(function(o,p){if(o)return true;else if(p.action_type==="mga-type:mark-all-seen")return p.folder===a("MessagingTag").PENDING;else return false},false)}function la(n,o){if(a("bs_caml_obj").caml_equal(n.action_type,a("MercuryActionType").USER_GENERATED_MESSAGE)&&n.folder===a("MessagingTag").PENDING)return a("bs_caml_obj").caml_equal(o,a("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE);else return false}var f=function f(n,o){delete n[o];return 0};function g(d,n,o){var p=d[n];if(p!==undefined){var q=p[o];if(q!==undefined)return a("bs_curry")._2(f,p,o);else return 0}else return 0}function ma(c,n){__p&&__p();var o=n.thread_fbid;if(o==null)if(n.type==="typ"||n.type==="page_typing"){var p=a("FBID.bs").ofString(n.from.toString());if(p)return a("MercuryIDs").getThreadIDFromUserID(p[0]);else return null}else return null;else{var q=a("MercuryThreadIDMap").getForFBID(c);return q.getClientIDFromServerIDNow(o.toString())}}function na(n,o){__p&&__p();return a("bs_array").fold_left(function(o,p){__p&&__p();if(p.tag){var q=p[0];if(q){a("bs_curry")._1(q[0],{blocked_ids:o[4]});return o}else{var r=o,s=a("bs_js_dict").fromArray(a("bs_js_dict").entries(r[6])),t=[];a("bs_js_dict").entries(s).forEach(function(Y){var R=Y[0];a("bs_js_dict").entries(Y[1]).forEach(function(Y){if(Y[1]<Date.now()-3e4){t.push([R,Y[0]]);return 0}else return 0});return 0});if(t.length===0)return r;else{t.forEach(function(Y){return g(s,Y[0],Y[1])});return[r[0],r[1],r[2],r[3],r[4],r[5],s]}}}else{var u=p[0];if(typeof u==="number")switch(u){case 0:var v=o;return[v[0],v[1],v[2],v[3],v[4],0,v[6]];case 1:var w=o;return[w[0],w[1],w[2],w[3],w[4],w[5]+1|0,w[6]];case 2:var x=o;return[x[0],x[1],{},x[3],x[4],x[5],x[6]]}else switch(u.tag|0){case 0:var y=o,z=u[0],A=a("bs_js_dict").fromArray(a("bs_js_dict").entries(y[1]));Object.keys(z).forEach(function(Y){var Z=z[Y],$=a("Utils.bs").$pipe$unknown(a("bs_js_primitive").undefined_to_opt(A[Y]),0);if(Z>$){A[Y]=Z;return 0}else return 0});return[y[0],A,y[2],y[3],y[4],y[5],y[6]];case 1:var B=o,C=u[0],D=e(B[3]);a("bs_array").iter(function(Y){D.add(Y);return 0},C);return[B[0],B[1],B[2],D,B[4],B[5],B[6]];case 2:var E=o,F=u[0],G=u[1],H=e(E[4]);a("bs_array").iter(function(Y){H.add(Y);return 0},F);a("bs_array").iter(function(Y){H["delete"](Y);return 0},G);return[E[0],E[1],E[2],E[3],H,E[5],E[6]];case 3:var I=o,va=u[0],J=e(I[4]);a("bs_array").iter(function(Y){if(J.has(Y)){J["delete"](Y);return 0}else{J.add(Y);return 0}},va);return[I[0],I[1],I[2],I[3],J,I[5],I[6]];case 4:var K=o,wa=u[0],L=e(K[3]);wa.forEach(function(Y){__p&&__p();var q=a("Utils.bs").nullUndefinedBooleanToOptionBool(Y.is_messenger_ignored),u=Y.fbid;if(q)if(q[0])if(u==null)return 0;else{L.add(a("MercuryIDs").getParticipantIDFromUserID(u));return 0}else if(u==null)return 0;else{L["delete"](a("MercuryIDs").getParticipantIDFromUserID(u));return 0}else return 0});return[K[0],K[1],K[2],L,K[4],K[5],K[6]];case 5:var M=o,xa=u[0];return[M[0],M[1],M[2],M[3],M[4],xa,M[6]];case 6:var N=o,ya=u[0],O=a("bs_js_dict").fromArray(a("bs_js_dict").entries(N[6]));ya.forEach(function(Y){var Z=Y.author;if(a("bs_caml_obj").caml_equal(Y.action_type,a("MercuryActionType").USER_GENERATED_MESSAGE)&&a("bs_caml_obj").caml_notequal(Z,a("MercuryViewer").getID())){var R=Y.thread_id;return g(O,R,Z)}else return 0});return[N[0],N[1],N[2],N[3],N[4],N[5],O];case 7:var P=o,Q=u[0],R=ma(P[0],Q);if(R==null)return P;else{var S=a("FBID.bs").ofString(Q.from.toString());if(S){var T=Q.persona_id,U=T==null?a("MercuryIDs").getParticipantIDFromUserID(S[0]):a("MercuryIDs").getParticipantIDFromUserID(T);if(Q.st===a("TypingStates").TYPING){var za=P[6][R];if(za!==undefined){za[U]=Date.now();return[P[0],P[1],P[2],P[3],P[4],P[5],P[6]]}else{var Aa=a("bs_js_dict").fromArray(a("bs_js_dict").entries(P[6])),Ba={};Ba[U]=Date.now();Aa[R]=Ba;return[P[0],P[1],P[2],P[3],P[4],P[5],Aa]}}else if(Q.st===a("TypingStates").INACTIVE){var Ca=a("bs_js_dict").fromArray(a("bs_js_dict").entries(P[6]));g(Ca,R,U);return[P[0],P[1],P[2],P[3],P[4],P[5],Ca]}else return P}else return P}case 8:var V=o,W=u[0],X=a("bs_js_dict").fromArray(a("bs_js_dict").entries(V[2]));Object.keys(W).forEach(function(Y){__p&&__p();Object.keys(W[Y]).forEach(function(Z){var q=X[Y],$=q!==undefined?q:a("immutable").OrderedMap(),Da=$.get(Z),Ea=W[Y][Z],Fa=0;if(Da==null||Ea.watermark>Da.watermark)Fa=1;else return 0;if(Fa===1){X[Y]=$.set(Z,Ea);return 0}});var q=X[Y];if(q!==undefined){X[Y]=q.sort(function(Z,$){return Z.watermark-$.watermark|0});return 0}else return 0});return[V[0],V[1],X,V[3],V[4],V[5],V[6]];case 9:return o}}},o,n)}function oa(c){var n=[a("ChannelConstants").getArbiterType("typ"),a("ChannelConstants").getArbiterType("ttyp")];if(!a("FBIDCheck").isUser_deprecated(c))n.push(a("ChannelConstants").getArbiterType("page_typing"));return n}var h={},i=a("ReasonReact.bs").reducerComponent("MessengerStateProvider"),j=function j(n,o){delete n[o];return 0};function pa(n,o){a("ReasonReact.bs").RemoteAction[3](n,[a("bs_block").__(0,[a("bs_block").__(7,[o])])]);a("setTimeoutAcrossTransitions")(function(){return a("ReasonReact.bs").RemoteAction[3](n,[a("bs_block").__(1,[0])])},3e4);return 0}function k(c,n,o){__p&&__p();var p=n?n[0]:a("ReasonReact.bs").RemoteAction[0](0),q=[0],r=[[c,{},{},new Set(),new Set(),0,{}]],s=a("ReasonReact.bs").RemoteAction[1](function(v){var w=r[0];r[0]=na(v,w);if(r[0]!==w)return a("bs_list").iter(function(x){return a("bs_curry")._1(x,r[0])},q[0]);else return 0},p);a("Arbiter").subscribe(oa(c),function(o,v){var w=v.obj,x=w.to;if(!(x==null)&&x.toString()!==c)return 0;else{pa(p,w);return 0}});var t=function t(v){__p&&__p();return[i[0],i[1],i[2],i[3],function(w){__p&&__p();q[0]=[w[3],q[0]];a("bs_curry")._1(w[4],function(){q[0]=a("bs_list").filter(function(x){return x!==w[3]})(q[0]);if(q[0]===0){if(s)a("ReasonReact.bs").RemoteAction[2](s[0]);return a("bs_curry")._2(j,h,c)}else return 0});return 0},i[5],i[6],i[7],i[8],function(w){return a("bs_curry")._1(v,w[1])},function(){return r[0]},i[11],function(w,o){return a("bs_block").__(0,[w])},i[13]]},u=[p,t];h[c]=u;return u}function l(n,o){var c=o?o[0]:a("CurrentUser").getID(),p=h[c];if(p!==undefined)return p[1];else return k(c,n,0)[1]}function m(n,o){var c=n?n[0]:a("CurrentUser").getID(),p=h[c];if(p!==undefined)return a("ReasonReact.bs").RemoteAction[3](p[0],o);else{var q=k(c,0,0);return a("ReasonReact.bs").RemoteAction[3](q[0],o)}}function qa(c,n){var o=h[c];if(o!==undefined)return a("ReasonReact.bs").RemoteAction[3](o[0],[a("bs_block").__(1,[[n]])]);else{var p=k(c,0,0);return a("ReasonReact.bs").RemoteAction[3](p[0],[a("bs_block").__(1,[[n]])])}}function ra(c,n){return m(c==null?0:[c],n)}function sa(n){__p&&__p();var o=[];if(!(n==null)){var p=n.payload_source;if(!(p==null))if(a("bs_caml_obj").caml_equal(p,a("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE))o.push(a("bs_block").__(0,[2]));var q=n.delivery_receipts;if(!(q==null))o.push(a("bs_block").__(0,[a("bs_block").__(0,[q])]));var r=n.message_ignored_ids;if(!(r==null))o.push(a("bs_block").__(0,[a("bs_block").__(1,[r])]));var s=n.actions;if(!(s==null))o.push(a("bs_block").__(0,[a("bs_block").__(3,[s.reduce(function(F,G){var p=G.message_blocked_ids;if(p==null)return F;else return p.concat(F)},[])])]));var t=n.participants;if(!(t==null)){o.push(a("bs_block").__(0,[a("bs_block").__(4,[t])]));var u=[],v=[];t.forEach(function(F){__p&&__p();var p=a("Utils.bs").nullUndefinedBooleanToOptionBool(F.is_messenger_blocked),q=F.fbid;if(p)if(p[0])if(q==null)return 0;else{u.push(a("MercuryIDs").getParticipantIDFromUserID(q));return 0}else if(q==null)return 0;else{v.push(a("MercuryIDs").getParticipantIDFromUserID(q));return 0}else return 0});if(u.length>0||v.length>0)o.push(a("bs_block").__(0,[a("bs_block").__(2,[u,v])]))}var w=n.message_blocked_ids;if(!(w==null))if(w.length>0)o.push(a("bs_block").__(0,[a("bs_block").__(2,[w,[]])]));var x=n.pending_folder_unseen_count;if(!(x==null))o.push(a("bs_block").__(0,[a("bs_block").__(5,[x])]));var y=n.actions,z=n.payload_source;if(!(y==null))if(!(z==null))y.forEach(function(F){if(la(F,z)){o.push(a("bs_block").__(0,[1]));return 0}else return 0});var A=n.global_actions;if(!(A==null)){var B=ka(A);if(B)o.push(a("bs_block").__(0,[0]))}var C=n.actions,D=n.payload_source;if(!(C==null))if(!(D==null)&&a("bs_caml_obj").caml_equal(D,a("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE)&&C.length>0)o.push(a("bs_block").__(0,[a("bs_block").__(6,[a("bs_array").map(function(F){return{action_type:F.action_type,author:F.author,thread_id:F.thread_id}},C)])]));var E=n.roger;if(!(E==null))o.push(a("bs_block").__(0,[a("bs_block").__(8,[E])]))}return o}var ta=a("ReasonReact.bs").wrapReasonForJs(i,function(n){return a("bs_curry")._1(l(0,a("bs_js_primitive").null_undefined_to_opt(n.fbid)),n.children)}),ua=[l];b.fbid=c;b.deliveryReceipts=fa;b.readReceiptsPerThread=ga;b.ignoredIds=ha;b.blockedIds=ia;b.pendingFolderUnseenCount=ja;b.typing=d;b.send=m;b.compute=qa;b.sendJS=ra;b.processJSActions=sa;b.Provider=ua;b.jsComponent=ta}),null);
__d("MercuryVanityIDMap.bs",["bs_string","bs_js_primitive","MercuryAssert","bs_js_null_undefined"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={},i={};function j(o){return c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(h[c("bs_string").lowercase(o)]))}function k(o){return c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(i[o]))}function l(o){var p=i[o];if(p!==undefined)return true;else return false}function m(o){var p=h[c("bs_string").lowercase(o)];if(p!==undefined)return true;else return false}function n(o,p){c("MercuryAssert").isParticipantID(p);var q=c("bs_string").lowercase(o);h[q]=p;i[p]=q;return 0}g.vanityToID=h;g.idToVanity=i;g.getID=j;g.getVanity=k;g.hasID=l;g.hasVanity=m;g.set=n}),null);
__d("MessengerStateProcessor",["MercuryAPIArgsSource","MercuryIDs","MercuryParticipantTypes","MercuryParticipants","MercuryThreadIDMap","MercuryThreads","MercuryVanityIDMap.bs","MessengerURIConstants"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={preprocess:function j(k){__p&&__p();var l=k.activeThreadID;if(l){var m=c("MercuryIDs").getUserIDFromThreadID(l),n=m&&c("MercuryParticipants").getNow(c("MercuryIDs").getParticipantIDFromUserID(m));if(n&&n.type!==c("MercuryParticipantTypes").EVENT)k.threadKey=n.vanity||m;else if(m&&!n){var o=c("MercuryIDs").getParticipantIDFromUserID(m);k.threadKey=c("MercuryVanityIDMap.bs").hasID(o)?c("MercuryVanityIDMap.bs").getVanity(o):m}else{var p=c("MercuryThreadIDMap").get(),q=p.getServerIDFromClientIDNow(l);k.threadKey=q||c("MercuryIDs").tokenize(l).value}}delete k.activeThreadID;return k},postprocess:function j(k){__p&&__p();var l=c("MercuryThreadIDMap").get(),m=c("MercuryThreads").get(),n=i(k.threadKey),o=void 0;o=c("MercuryIDs").isValid(n)?n:l.getClientIDFromServerIDNow(n);if(!o){var p=c("MercuryParticipants").getIDFromVanityOrFBID(n),q=p&&m.getCanonicalThreadToParticipant(p,null,c("MercuryAPIArgsSource").MESSENGER);if(q)o=q.thread_id}if(o){k.activeThreadID=o;k.serverThreadID=l.getServerIDFromClientIDNow(o)}delete k.threadKey;return k},supportInboxPostprocess:function j(k){if(k.threadKey)k.activeThreadID=c("MercuryIDs").getThreadIDFromSupportInboxItemID(k.threadKey);delete k.threadKey;return k}};function i(j){if(!j)return null;return j.startsWith(c("MessengerURIConstants").GROUP_PREFIX)?j.substr(c("MessengerURIConstants").GROUP_PREFIX.length):j}f.exports=h}),null);
__d("MercuryFilters",["MessagingTag"],(function a(b,c,d,e,f,g){var h=[c("MessagingTag").UNREAD],i={ALL:"all",UNREAD:c("MessagingTag").UNREAD,getSupportedFilters:function j(){return h.concat()},isSupportedFilter:function j(k){return h.includes(k)}};f.exports=i}),null);
__d("MessengerURISerializer",["CurrentEnvironment","MercuryFilters","MessagingTag","MessengerStateProcessor","MessengerURIConstants","MessengerView","URI","WWWBase","MercuryIDs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="/?$",i=function i(m,n){m.setPath(c("CurrentEnvironment").facebookdotcom?c("MessengerURIConstants").FACEBOOK_PREFIX+n:n)},j=function j(m,n){var o=m.getPath();if(c("CurrentEnvironment").facebookdotcom&&!o.startsWith(c("MessengerURIConstants").FACEBOOK_PREFIX))n=c("MessengerURIConstants").FACEBOOK_PREFIX+n;m.setPath(m.getPath()+n)},k={serialize:function m(n){__p&&__p();var o=new(c("URI"))(c("WWWBase").uri);n=c("MessengerStateProcessor").preprocess(n);switch(n.masterView){case c("MessengerView").MASTER.PAYMENT:i(o,c("MessengerURIConstants").PAYMENT_PATH);break;case c("MessengerView").MASTER.PEOPLE:i(o,c("MessengerURIConstants").PEOPLE_PATH);break;case c("MessengerView").MASTER.SUPPORT:i(o,c("MessengerURIConstants").SUPPORT_PATH);break}switch(n.folder){case c("MessagingTag").OTHER:i(o,c("MessengerURIConstants").FILTERED_REQUESTS_PATH);break;case c("MessagingTag").ACTION_ARCHIVED:i(o,c("MessengerURIConstants").ARCHIVED_PATH);break;case c("MessagingTag").PENDING:i(o,c("MessengerURIConstants").MESSAGE_REQUESTS_PATH);break}if(n.detailView===c("MessengerView").DETAIL.PAYTHREAD){j(o,c("MessengerURIConstants").PAYMENT_PAY_PATH);if(n.threadKey)o.addQueryData("id",n.threadKey)}else if(n.detailView===c("MessengerView").DETAIL.PAYFRIENDPICKER)j(o,c("MessengerURIConstants").PAYMENT_PAY_PATH);else if(n.detailView===c("MessengerView").DETAIL.COMPOSE)j(o,c("MessengerURIConstants").COMPOSE_SUBPATH);else if(n.threadKey)if(n.masterView===c("MessengerView").MASTER.PAYMENT){i(o,c("MessengerURIConstants").THREAD_PREFIX+n.threadKey);delete n.extraQueryParams.id;delete n.extraQueryParams.a;delete n.extraQueryParams.m}else j(o,c("MessengerURIConstants").THREAD_PREFIX+n.threadKey);else if(n.masterView===c("MessengerView").MASTER.PAYMENT){i(o,"");delete n.extraQueryParams.id;delete n.extraQueryParams.a;delete n.extraQueryParams.m}else j(o,"");if(n.extraQueryParams)o.addQueryData(n.extraQueryParams);if(c("MercuryFilters").isSupportedFilter(n.filter))o.addQueryData({filter:n.filter});if(n.query!=null){var p;o.addQueryData((p={},p[n.masterView===c("MessengerView").MASTER.SEARCH?"qa":"q"]=n.query,p))}if(n.threadIDs)o.addQueryData({threadIDs:JSON.stringify(n.threadIDs)});if(n.mid)o.addQueryData({mid:n.mid});return o},deserialize:function m(n){__p&&__p();var o={},p=n.getPath();if(c("CurrentEnvironment").facebookdotcom&&!p.startsWith(c("MessengerURIConstants").FACEBOOK_PREFIX))o.notMessenger=true;var q=p.replace(c("MessengerURIConstants").FACEBOOK_PREFIX,""),r=void 0,s=n.getQueryData(),t=s.filter,u=s.mid,v=s.q,w=s.qa,x=s.threadIDs,y=babelHelpers.objectWithoutProperties(s,["filter","mid","q","qa","threadIDs"]);if(x)try{r=JSON.parse(x)}catch(z){}if(r)o.threadIDs=r.filter(function(B){return c("MercuryIDs").isValidThreadID(B)});else o.threadIDs=null;if(q.match("^"+c("MessengerURIConstants").PEOPLE_PATH))o.masterView=c("MessengerView").MASTER.PEOPLE;else if(q.match("^"+c("MessengerURIConstants").SUPPORT_PATH))o.masterView=c("MessengerView").MASTER.SUPPORT;else if(q.match("^"+c("MessengerURIConstants").PAYMENT_PATH))o.masterView=c("MessengerView").MASTER.PAYMENT;else if(w)o.masterView=c("MessengerView").MASTER.SEARCH;else o.masterView=c("MessengerView").MASTER.RECENT;if(q.match("^"+c("MessengerURIConstants").FILTERED_REQUESTS_PATH))o.folder=c("MessagingTag").OTHER;else if(q.match("^"+c("MessengerURIConstants").ARCHIVED_PATH))o.folder=c("MessagingTag").ACTION_ARCHIVED;else if(q.match("^"+c("MessengerURIConstants").MESSAGE_REQUESTS_PATH))o.folder=c("MessagingTag").PENDING;else o.folder=c("MessagingTag").INBOX;if(q.match(c("MessengerURIConstants").COMPOSE_SUBPATH+h))o.detailView=c("MessengerView").DETAIL.COMPOSE;else if(q.match("^"+c("MessengerURIConstants").PAYMENT_PATH+c("MessengerURIConstants").PAYMENT_PAY_PATH))if(y&&y.id){o.threadKey=y.id;o.detailView=c("MessengerView").DETAIL.PAYTHREAD}else o.detailView=c("MessengerView").DETAIL.PAYFRIENDPICKER;else{var A=l(q);if(A){o.threadKey=A;o.detailView=c("MessengerView").DETAIL.THREAD}}if(c("MercuryFilters").isSupportedFilter(t))o.filter=t;else o.filter=c("MercuryFilters").ALL;o.mid=u;o.query=w||v;o.extraQueryParams=y;if(o.masterView===c("MessengerView").MASTER.SUPPORT)return c("MessengerStateProcessor").supportInboxPostprocess(o);return c("MessengerStateProcessor").postprocess(o)}};function l(m){var n=m.match(c("MessengerURIConstants").THREAD_PREFIX+"([^/]+)"+h);return n&&decodeURIComponent(n[1])}f.exports=k}),null);
__d("MercurySingletonProvider",["CurrentUser"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){this.$MercurySingletonProvider1={};this.$MercurySingletonProvider2=i}h.prototype.getForFBID=function(i){if(!this.$MercurySingletonProvider1[i])this.$MercurySingletonProvider1[i]=new this.$MercurySingletonProvider2(i);return this.$MercurySingletonProvider1[i]};h.prototype.get=function(){return this.getForFBID(c("CurrentUser").getID())};h.mock=function(i){throw new Error("MercurySingletonProvider.mock() must only be used in tests.")};f.exports=h}),null);
__d("MercuryDelayedDispatcher",["MercuryDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){this.$MercuryDelayedDispatcher1=j;this.$MercuryDelayedDispatcher2=[];this.$MercuryDelayedDispatcher3=c("MercuryThreadIDMap").getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4=c("MercuryDispatcher").getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher5=c("MercuryServerRequests").getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher6=c("MercuryServerPayloadPreprocessor").getForFBID(this.$MercuryDelayedDispatcher1);this.$MercuryDelayedDispatcher4.subscribe("model-update-completed",function(k,l){return this.$MercuryDelayedDispatcher7()}.bind(this))}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.handleUpdateWaitForThread=function(j,k){var l=this.$MercuryDelayedDispatcher3.getClientIDFromServerIDNow(k);if(l){this.$MercuryDelayedDispatcher8(j);return}this.$MercuryDelayedDispatcher3.getClientIDFromServerID(k,function(){return this.$MercuryDelayedDispatcher2.push({thread_fbid:k,payload:j})}.bind(this));this.$MercuryDelayedDispatcher5.ensureThreadIsFetched(k)};h.prototype.$MercuryDelayedDispatcher7=function(){if(this.$MercuryDelayedDispatcher2&&this.$MercuryDelayedDispatcher2.length){var j=this.$MercuryDelayedDispatcher2.shift(),k=j.thread_fbid,l=j.payload;this.handleUpdateWaitForThread(l,k)}};h.prototype.$MercuryDelayedDispatcher8=function(j){if(j.from_client)this.$MercuryDelayedDispatcher4.handleUpdate(j);else this.$MercuryDelayedDispatcher6.handleUpdate(j)};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("MercuryThreadInformer",["ArbiterMixin","LogHistory","MercuryAssert","MercurySingletonProvider","mapObject","mixin"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=c("LogHistory").getInstance("mercury_informer");h=babelHelpers.inherits(k,c("mixin")(c("ArbiterMixin")));i=h&&h.prototype;k.get=function(){return l.get()};k.getForFBID=function(m){return l.getForFBID(m)};function k(m){__p&&__p();i.constructor.call(this);this.$MercuryThreadInformer1=m;this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4={};this.$MercuryThreadInformer5={};this.$MercuryThreadInformer6=false;this.$MercuryThreadInformer7=false;this.$MercuryThreadInformer8=false;this.$MercuryThreadInformer9={};this.$MercuryThreadInformer10={};this.$MercuryThreadInformer11={};this.$MercuryThreadInformer12=0}k.prototype.updatedThread=function(m){this.$MercuryThreadInformer3[m]=true;this.$MercuryThreadInformer13()};k.prototype.invalidatedThread=function(m){this.$MercuryThreadInformer4[m]=true;this.$MercuryThreadInformer13()};k.prototype.deletedThread=function(m){this.$MercuryThreadInformer2[m]=true;this.$MercuryThreadInformer13()};k.prototype.updatedThreadlist=function(){this.$MercuryThreadInformer6=true;this.$MercuryThreadInformer13()};k.prototype.updatedUnseenState=function(){this.$MercuryThreadInformer7=true;this.$MercuryThreadInformer13()};k.prototype.updatedUnreadState=function(){this.$MercuryThreadInformer8=true;this.$MercuryThreadInformer13()};k.prototype.changedThreadReadState=function(m,n,o){if(!this.$MercuryThreadInformer5[m]||this.$MercuryThreadInformer5[m].timestamp<o)this.$MercuryThreadInformer5[m]={mark_as_read:n,timestamp:o};this.$MercuryThreadInformer13()};k.prototype.receivedMessage=function(m){c("MercuryAssert").isThreadID(m.thread_id);var n=m.thread_id;if(!this.$MercuryThreadInformer9[n])this.$MercuryThreadInformer9[n]=[];this.$MercuryThreadInformer9[n].push(m);this.updatedThread(n)};k.prototype.reorderedMessages=function(m,n){this.$MercuryThreadInformer10[m]={source:n};this.$MercuryThreadInformer13()};k.prototype.updatedMessage=function(m,n,o){if(!this.$MercuryThreadInformer11[m])this.$MercuryThreadInformer11[m]={};this.$MercuryThreadInformer11[m][n]={source:o};this.updatedThread(m)};k.prototype.synchronizeInforms=function(m){this.$MercuryThreadInformer12++;try{m()}catch(n){throw n}finally{this.$MercuryThreadInformer12--;this.$MercuryThreadInformer13()}};k.prototype.listen=function(m,n){return this.subscribe("threads-updated",function(o,p){if(p[m])n(m)})};k.prototype.$MercuryThreadInformer13=function(){__p&&__p();if(!this.$MercuryThreadInformer12){var m=this.$MercuryThreadInformer2,n=this.$MercuryThreadInformer3,o=this.$MercuryThreadInformer4,p=this.$MercuryThreadInformer5,q=this.$MercuryThreadInformer6,r=this.$MercuryThreadInformer7,s=this.$MercuryThreadInformer8,t=this.$MercuryThreadInformer9,u=this.$MercuryThreadInformer10,v=this.$MercuryThreadInformer11;this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4={};this.$MercuryThreadInformer5={};this.$MercuryThreadInformer6=false;this.$MercuryThreadInformer7=false;this.$MercuryThreadInformer8=false;this.$MercuryThreadInformer9={};this.$MercuryThreadInformer10={};this.$MercuryThreadInformer11={};var w=Object.keys(n);if(w.length||q)this.inform("threadlist-updated",w);if(w.length)this.$MercuryThreadInformer14("threads-updated",n);for(var x in o){this.$MercuryThreadInformer14("thread-invalidated",o);break}for(var x in p){this.$MercuryThreadInformer14("thread-read-changed",p);break}for(x in m){this.$MercuryThreadInformer14("threads-deleted",m);break}if(r)this.$MercuryThreadInformer14("unseen-updated",null);if(s)this.$MercuryThreadInformer14("unread-updated",null);for(x in t){this.$MercuryThreadInformer14("messages-received",t);break}for(x in u){this.$MercuryThreadInformer14("messages-reordered",u);break}for(x in v){this.$MercuryThreadInformer14("messages-updated",v);break}}};k.prototype.$MercuryThreadInformer14=function(m,n){if(m==="threads-updated")j.debug(m,JSON.stringify(n));this.inform(m,n)};var l=new(c("MercurySingletonProvider"))(k);f.exports=k}),null);
__d("MercuryDispatcher",["invariant","ArbiterMixin","MessengerState.bs","LogHistory","MercuryActionType","MercuryPayloadSource","MercurySingletonProvider","MercuryThreadInformer","isEmpty","mixin"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("LogHistory").getInstance("mercury_dispatcher");i=babelHelpers.inherits(l,c("mixin")(c("ArbiterMixin")));j=i&&i.prototype;l.getForFBID=function(n){return m.getForFBID(n)};l.get=function(){return m.get()};function l(n){j.constructor.call(this);this.$MercuryDispatcher1=n}l.prototype.handleUpdate=function(n){__p&&__p();this.$MercuryDispatcher2(n);!!n.from_client!==!!n.preprocessed||h(0);delete n.preprocessed;if(!c("isEmpty")(n))c("MercuryThreadInformer").getForFBID(this.$MercuryDispatcher1).synchronizeInforms(function(){__p&&__p();if(n.payload_source===c("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE)this.inform("invalidate-global-state",{});if(n.payload_source===c("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE){var o=n.threads&&n.threads.length>0&&n.threads[0]&&n.threads[0].thread_id;if(o)this.inform("invalidate-thread-state",o)}this.inform("update-thread-ids",n.newlyAddedClientIDs);this.inform("update-participants",n);this.inform("update-threads",n);this.inform("update-unread",n);this.inform("update-threadlist",n);this.inform("update-messages",n);this.inform("update-unseen",n);this.inform("update-typing-state",n);this.inform("update-delivery",n);this.inform("update-roger",n.roger);this.inform("update-blocked-users",n);this.inform("update-ignored-users",n);this.inform("model-update-completed",null);this.inform("update-work-group-threads",n);c("MessengerState.bs").sendJS(this.$MercuryDispatcher1,c("MessengerState.bs").processJSActions(n))}.bind(this))};l.prototype.$MercuryDispatcher2=function(n){__p&&__p();var o=n.payload_source;if(o===c("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS||o===c("MercuryPayloadSource").CLIENT_MARK_THREAD_SEEN)return;var p={from_client:n.from_client,messages:null};if(n.actions){var q=n.actions.filter(function(r){return r.action_type===c("MercuryActionType").USER_GENERATED_MESSAGE||r.action_type===c("MercuryActionType").LOG_MESSAGE}).map(function(r){return{action_type:r.action_type,other_user_fbid:r.other_user_fbid,thread_fbid:r.thread_fbid,message_id:r.message_id}});if(q.length)p.messages=q}k.debug("update:"+o,JSON.stringify(p))};var m=new(c("MercurySingletonProvider"))(l);f.exports=l}),null);
__d("MercuryActionStatus",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({UNSENT:0,SUCCESS:1,UNCONFIRMED:3,FAILED_UNKNOWN_REASON:4,UNABLE_TO_CONFIRM:5,RESENT:6,RESENDING:7,ERROR:10})}),null);
__d("MercuryLocalIDs",["PresenceUtil","randomInt"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={generateMessageID:function j(k){var l=k||Date.now(),m=c("randomInt")(0,4294967295),n=c("PresenceUtil").getSessionID();return"<"+l+":"+m+"-"+n+"@mail.projektitan.com>"},generateThreadID:function j(k){return"root:"+h.generateOfflineThreadingID(k)},generateOfflineThreadingID:function j(k){var l=k||Date.now(),m=c("randomInt")(0,4294967295),n=("0000000000000000000000"+m.toString(2)).slice(-22),o=l.toString(2)+n;return i(o.slice(-63))}};function i(j){__p&&__p();var k="";while(j!="0"){var l=0,m="";for(var n=0;n<j.length;n++){l=2*l+parseInt(j[n],10);if(l>=10){m+="1";l-=10}else m+="0"}k=l.toString()+k;j=m.slice(m.indexOf("1"))}return k}f.exports=h}),null);
__d("MercuryMessageSourceTags",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CHAT:"source:chat",EMAIL:"source:email",MESSENGER:"source:messenger",MOBILE:"source:mobile"})}),null);
__d("MercurySendMessageFields",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"})}),null);
__d("MercuryMessageObject",["BanzaiODS","MercuryActionStatus","MercuryActionType","MercuryIDs","MercuryLocalIDs","MercuryMessageClientState","MercuryMessageSourceTags","MercurySingletonProvider","MercurySourceType","MercuryThreads","MercurySendMessageFields"],(function a(b,c,d,e,f,g){__p&&__p();h.getForFBID=function(l){"use strict";return k.getForFBID(l)};h.get=function(){"use strict";return k.get()};function h(l){"use strict";this.$MercuryMessageObject1=l;this.$MercuryMessageObject2=c("MercuryThreads").getForFBID(l)}h.prototype.constructUserGeneratedMessageObject=function(l,m,n,o,p){__p&&__p();var q=arguments.length<=5||arguments[5]===undefined?null:arguments[5];"use strict";var r=i(this.$MercuryMessageObject1,c("MercuryActionType").USER_GENERATED_MESSAGE,m,n);if(typeof l=="string")l=l.replace(/^\s+/,"").replace(/\s+$/,"");r.body=l;r.has_attachment=false;r.html_body=false;r.attachments=[];r.specific_to_list=o||[];r.creator_info=p;if(q&&q.length>0)r.tags=q;return r};h.prototype.constructStickerMessageObject=function(l,m,n){__p&&__p();var o=arguments.length<=3||arguments[3]===undefined?null:arguments[3];"use strict";var p=i(this.$MercuryMessageObject1,c("MercuryActionType").USER_GENERATED_MESSAGE,m,n);p.has_attachment=true;p.html_body=false;p.attachments=[];p.sticker_id=l;p.specific_to_list=[];if(o&&o.length>0)p.tags=o;return p};h.prototype.constructAttachmentMessageObject=function(l,m){"use strict";var n=i(this.$MercuryMessageObject1,c("MercuryActionType").USER_GENERATED_MESSAGE,l,m);n.attachments=[];n.specific_to_list=[];return n};h.prototype.constructLogMessageObject=function(l,m,n,o){"use strict";var p=i(this.$MercuryMessageObject1,c("MercuryActionType").LOG_MESSAGE,l,m);p.log_message_type=n;p.log_message_data=o;if(o&&o.untypedData&&o.untypedData.ttl)p.ephemeral_ttl_mode=o.untypedData.ttl;return p};h.prototype.constructCTAConfirmationMessageObject=function(l,m,n,o){__p&&__p();var p=arguments.length<=4||arguments[4]===undefined?null:arguments[4];"use strict";var q=this.constructUserGeneratedMessageObject(l,m,n,null,null),r={};if(o)r={quick_replies:o,ignore_for_webhook:false};else r={ignore_for_webhook:true};q.platform_xmd=JSON.stringify(r);if(p&&p.length>0)q.tags=p;return q};h.prototype.normalizeNewMessage=function(l){"use strict";__p&&__p();if(l.status===undefined)l.status=c("MercuryActionStatus").UNSENT;l.offline_threading_id=l.offline_threading_id||c("MercuryLocalIDs").generateOfflineThreadingID(l.timestamp);if(!l.offline_threading_id)c("BanzaiODS").bumpEntityKey("chat.web","invalid_otid_generated");l.message_id=l.message_id||l.offline_threading_id;var m=c("MercuryIDs").getParticipantIDFromUserID(this.$MercuryMessageObject1);l.specific_to_list=l.specific_to_list||[];if(l.specific_to_list.length&&l.specific_to_list.indexOf(m)===-1)l.specific_to_list.push(m);if(!l.thread_id)l.thread_id="root:"+l.offline_threading_id;else{var n=this.$MercuryMessageObject2.getThreadMetaNow(l.thread_id);if(n&&n.ephemeral_ttl_mode!==null&&l.ephemeral_ttl_mode===undefined)l.ephemeral_ttl_mode=n.ephemeral_ttl_mode}if(l.specific_to_list.length==1)l.thread_id="user:"+this.$MercuryMessageObject1;else if(l.specific_to_list.length==2){var o=l.specific_to_list[0]==m?l.specific_to_list[1]:l.specific_to_list[0];l.thread_id=c("MercuryIDs").getThreadIDFromParticipantID(o)}if(!l.specific_to_list.length){var p=c("MercuryIDs").tokenize(l.thread_id),q=p.type,r=p.value;if(q=="user")l.specific_to_list=["fbid:"+r,m]}if(!l[c("MercurySendMessageFields").MANUAL_RETRY_CNT])l[c("MercurySendMessageFields").MANUAL_RETRY_CNT]=0};h.prototype.normalizeResendMessage=function(l){"use strict";l.status=c("MercuryActionStatus").RESENDING;l.timestamp=Date.now();l[c("MercurySendMessageFields").MANUAL_RETRY_CNT]+=1};h.prototype.normalizeAddAttachmentPlaceholder=function(l,m,n){"use strict";if(n.preview_attachments.length>0){l.has_attachment=true;l.preview_attachments=n.preview_attachments}l.client_state=c("MercuryMessageClientState").DO_NOT_SEND_TO_SERVER;l.status=c("MercuryActionStatus").RESENDING;l.upload_id=m};function i(l,m,n,o){var p=j(n)?[c("MercuryMessageSourceTags").CHAT]:[],q=Date.now(),r={action_type:m,thread_id:o,author:c("MercuryIDs").getParticipantIDFromUserID(l),author_email:null,timestamp:q,is_unread:false,is_filtered_content:false,is_filtered_content_bh:false,is_filtered_content_account:false,is_filtered_content_quasar:false,is_filtered_content_invalid_app:false,is_spoof_warning:false,source:n,source_tags:p};return r}function j(l){switch(l){case c("MercurySourceType").CHAT_WEB:case c("MercurySourceType").CHAT_JABBER:case c("MercurySourceType").CHAT_IPHONE:case c("MercurySourceType").CHAT_MEEBO:case c("MercurySourceType").CHAT_ORCA:case c("MercurySourceType").CHAT_TEST:case c("MercurySourceType").CHAT:return true;default:return false}}var k=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("MercuryTagHelper",[],(function a(b,c,d,e,f,g){"use strict";var h={get:function i(j,k){var l=j.find(function(m){return m.startsWith(k)});return l&&l.substr(l.indexOf(":")+1)}};f.exports=h}),null);
__d("EmojiLikeUtils",["EmojiLikeConstants","EmoticonEmojiList","MercuryTagHelper"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(n,o){if(!n.tags)n.tags=[i(o)];else n.tags.push(i(o));return n}function i(n){var o=c("EmojiLikeConstants").TAG_PREFIX_NEW;return o+":"+n}function j(n,o){if(!n.tags)n.tags=[k(o)];else n.tags.push(k(o));return n}function k(n){return c("EmojiLikeConstants").SOURCE_TAG_PREFIX+":"+n}function l(n){return m(n)!=null}function m(n){if(!n.tags)return null;var o=c("MercuryTagHelper").get(n.tags,c("EmojiLikeConstants").TAG_PREFIX_NEW);if(o)return o;return c("MercuryTagHelper").get(n.tags,c("EmojiLikeConstants").TAG_PREFIX_OLD)}f.exports={getEmojiSize:m,isEmojiLike:l,setEmojiSize:h,setEmojiSource:j}}),null);
__d("MercuryAttachmentContentType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({PHOTO:"attach:image",VIDEO:"attach:video",MUSIC:"attach:music",VOICE:"attach:voice",TEXT:"attach:text",MSWORD:"attach:ms:word",MSXLS:"attach:ms:xls",MSPPT:"attach:ms:ppt",ORION:"attach:orion",SHOERACK_INVITATION:"attach:shoerackinvite",UNKNOWN:"attach:unknown"})}),null);
__d("MercuryAttachmentType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ERROR:"error",FILE:"file",PHOTO:"photo",STICKER:"sticker",SHARE:"share",UNKNOWN:"unknown",VIDEO:"video",ANIMATED_IMAGE:"animated_image",EMOJI_LIKE:"emoji_like",GIFT:"gift",THIRDPARTYSTICKER:"third_party_sticker"})}),null);
__d("StoryAttachmentStyle",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",INSPIRATION_PHOTO:"inspiration_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",CANCELED_EVENT:"canceled_event",MINUTIAE_EVENT:"minutiae_event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",ANIMATED_IMAGE_VIDEO:"animated_image_video",ANIMATED_IMAGE_VIDEO_AUTOPLAY:"animated_image_video_autoplay",NOTE:"note",TOPIC:"topic",TOPIC_FOLLOWING_TOPIC:"topic_following_topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",VIDEO_DIRECT_RESPONSE:"video_direct_response",VIDEO_DIRECT_RESPONSE_AUTOPLAY:"video_direct_response_autoplay",VIDEO_SHOP:"video_shop",INSPIRATION_VIDEO:"inspiration_video",MULTI_VIDEOS_STITCHED:"multi_videos_stitched",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",MULTI_SHARE_NON_LINK_VIDEO:"multi_share_non_link_video",MULTI_SHARE_SEARCH_END_CARD:"multi_share_search_end_card",MULTI_SHARE_FIXED_TEXT:"multi_share_fixed_text",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",BIRTHDAY_PERCEPTICONS:"birthday_percepticons",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GAMETIME_LEAGUE:"gametime_league",GAMETIME_PLAY:"gametime_play",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",POST_CHANNEL:"post_channel",TEXT_FOR_COLLAGE:"text_for_collage",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",P2P_PAYMENT:"p2p_payment",P2P_SERVER_BUBBLE:"p2p_server_bubble",INSTANT_ARTICLE:"instant_article",MOMENTS_APP_INVITATION:"moments_app_invitation",MOMENTS_APP_PHOTO_REQUEST:"moments_app_photo_request",RIDE_ORDERED:"ride_ordered",RIDE_RECEIPT:"ride_receipt",BUSINESS_MESSAGE_ITEMS:"business_message_items",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_PROMOTION:"retail_promotion",RETAIL_ITEM:"retail_item",RETAIL_NOW_IN_STOCK:"retail_now_in_stock",RETAIL_RECEIPT:"retail_receipt",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_FOR_SUPPORTED_CARRIER:"retail_shipment_for_supported_carrier",RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:"retail_shipment_for_unsupported_carrier",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",RETAIL_SHIPMENT_TRACKING_EVENT_ETA:"retail_shipment_tracking_event_eta",RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:"retail_shipment_tracking_event_in_transit",RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:"retail_shipment_tracking_event_out_for_delivery",RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:"retail_shipment_tracking_event_delayed",RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:"retail_shipment_tracking_event_delivered",SURVEY:"survey",MESSAGE_LOCATION:"message_location",GROUP_ADD_MEMBERS:"group_add_memebers",GROUP_MEMBER_ADDED:"group_member_added",RTC_CALL_LOG:"rtc_call_log",EVENTS_PENDING_POST_QUEUE:"events_pending_post_queue",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile",ATTRIBUTED_SHARE:"attributed_share",VIDEO_CINEMAGRAPH:"video_cinemagraph",LOCAL_CONTEXT_SHARE:"local_context_share",H_SCROLL:"h_scroll",EGO_HSCROLL:"ego_hscroll",MEDIA_QUESTION:"media_question",RICH_MEDIA:"rich_media",RICH_MEDIA_COLLECTION:"rich_media_collection",SQUARE_IMAGE_SHARE:"square_image_share",RETAIL_AGENT_ITEM_SUGGESTION:"retail_agent_item_suggestion",RETAIL_AGENT_ITEM_RECEIPT:"retail_agent_item_receipt",NOTE_COMPOSED:"note_composed",AVATAR_WITH_BIRTHDAY:"avatar_with_birthday",AIRLINE_FLIGHT_RESCHEDULE_UPDATE_BUBBLE:"airline_flight_reschedule_update_bubble",AIRLINE_CONFIRMATION:"airline_confirmation",AIRLINE_CHECK_IN:"airline_check_in",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_FLIGHT_RESCHEDULE_UPDATE:"airline_flight_reschedule_update",LIGHTBOX_VIDEO:"lightbox_video",GLOBALLY_DELETED_MESSAGE_PLACEHOLDER:"globally_deleted_message_placeholder",GENIE_MESSAGE:"genie_message",MOVIE_BOT_MOVIE_LIST:"movie_bot_movie_list",MOVIE_BOT_MOVIE_SHOWTIME_LIST:"movie_bot_movie_showtime_list",GROUPSMASH_MEDIA:"groupsmash_media",AVATAR_WITH_EGO_ACTION:"avatar_with_ego_action",EVENT_TICKET_DEPRECATED:"event_ticket",VERTICAL_ATTACHMENT_LIST:"vertical_attachment_list",INSTANT_ARTICLE_LEGACY:"instant_article_legacy",FUNDRAISER_PAGE:"fundraiser_page",FINANCIAL_BILL_PAYMENT_REQUEST:"financial_bill_payment_request",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD:"goodwill_throwback_friendversary_polaroids_card",WELCOME_CARD_IMAGE:"welcome_card_image",LARGE_IMAGE_LIKE:"large_image_like",ASK_FRIENDS:"ask_friends",CULTURAL_MOMENT:"cultural_moment",TELEPHONE_CALL_LOG:"telephone_call_log",SUPER_EMOJI:"super_emoji",BOOK:"book",SUBTOPIC_CUSTOMIZATION_QUESTION:"subtopic_customization_question",SUBTOPIC_CUSTOMIZATION_OPTION:"subtopic_customization_option",RESTAURANT:"restaurant",CONNECTION_QUESTION:"connection_question",CONNECTION_QUESTION_OPTION:"connection_question_option",PYMI_ITEM:"pymi_item",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD:"goodwill_throwback_friendversary_collage_card",CITY:"city",AVATAR_WITH_SHARE:"avatar_with_share",LIGHTWEIGHT_PLACE:"lightweight_place",QUOTED_SHARE:"quoted_share",SMS_LOG:"sms_log",CENTERED_TEXT:"centered_text",GOODWILL_THROWBACK_FRIENDVERSARY_DATA_CARD:"goodwill_throwback_friendversary_data_card",GOODWILL_THROWBACK_FACEVERSARY_COLLAGE_CARD:"goodwill_throwback_faceversary_collage_card",GOODWILL_THROWBACK_ANNIVERSARY_COLLAGE_CARD:"goodwill_throwback_anniversary_collage_card",MESSAGE_EVENT:"message_event",MESSAGE_THREAD:"message_thread",QUOTE:"quote",VOTER_REGISTRATION_SHARE:"voter_registration_share",AIRLINE_ITINERARY:"airline_itinerary",AIRLINE_UPDATE:"airline_update",PLACE_LIST:"place_list",IMPLICIT_PLACE_LIST_CONVERSION:"implicit_place_list_conversion",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",MINUTIAE_UNIT:"minutiae_unit",INSTANT_ARTICLE_PHOTO:"instant_article_photo",INSTANT_ARTICLE_VIDEO:"instant_article_video",PHOTO_LINK_SHARE:"photo_link_share",PHOTO_LINK_SHARE_WITH_INSTAGRAM_CONTEXT:"photo_link_share_with_instagram_context",BUSINESS_LOCATION:"business_location",GOODWILL_WEATHER:"goodwill_weather",CULTURAL_MOMENT_HOLIDAY_CARD:"cultural_moment_holiday_card",TRANSACTION_INVOICE:"transaction_invoice",GROUP:"group",COMMENT_PLACE_INFO:"comment_place_info",COMMENT_PRODUCT_INFO:"comment_product_info",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD_IPB:"goodwill_throwback_friendversary_polaroids_card_ipb",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD_IPB:"goodwill_throwback_friendversary_collage_card_ipb",FUNDRAISER_PERSON_TO_CHARITY:"fundraiser_person_to_charity",FUNDRAISER_PERSON_FOR_PERSON:"fundraiser_person_for_person",FUNDRAISER_FOR_STORY:"fundraiser_for_story",MESSAGE_LIVE_LOCATION:"message_live_location",MESSENGER_INVITE:"messenger_invite",MESSENGER_NATIVE_TEMPLATES:"messenger_native_templates",GAMES_INSTANT_PLAY:"games_instant_play",PROFILE_MEDIA:"profile_media",NATIVE_TEMPLATES:"native_templates",NATIVE_TEMPLATES_FOX:"native_templates_fox",NATIVE_TEMPLATES_KEEP_ATTACHED:"native_templates_keep_attached",GOODWILL_THROWBACK_VIDEO_BASIC:"goodwill_throwback_video_basic",COMMERCE_PRODUCT_MINI:"commerce_product_mini",COMMERCE_PRODUCT_MINI_LIST:"commerce_product_mini_list",COMMENT:"comment",MESSENGER_TEAM_BOT_SHARE:"messenger_team_bot_share",LIVE_VIDEO_SCHEDULE:"live_video_schedule",PRODUCT_ITEM:"product_item",PLATFORM_INSTANT_APP:"platform_instant_app",YEAR_OVERVIEW:"year_overview",NATIVE_COMPONENT_FLOW_BOOKING_REQUEST:"native_component_flow_booking_request",FRIEND_REQUEST:"friend_request",MESSENGER_GROUP_JOINABLE_LINK:"messenger_group_joinable_link",SOCIAL_SEARCH_CONVERSION_PROMPT:"social_search_conversion_prompt",MDOTME_USER_LINK:"mdotme_user_link",DYNAMIC_MULTI_SHARE_ITEMS:"dynamic_multi_share_items",EVENT_REMINDER:"event_reminder",INSTANT_GAMES_SHARE_MESSAGE:"instant_games_share_message",MESSENGER_PLATFORM_COMPACT_ITEM:"messenger_platform_compact_item",MESSENGER_PLATFORM_COVER_ITEM:"messenger_platform_cover_item",MULTI_SHARE_NON_LINK_VIDEO_AUTO_SCROLL:"multi_share_non_link_video_auto_scroll",ENDORSEMENT:"endorsement",OFFER_VIEW_LIVE_COUNTDOWN:"offer_view_live_countdown",ENHANCED_LINK_REDDIT_POST:"enhanced_link_reddit_post",MESSENGER_COMMERCE_COVER_ITEM:"messenger_commerce_cover_item",ENHANCED_LINK_YELP_BUSINESS:"enhanced_link_yelp_business",PAGES_PLATFORM_LEAD_GEN:"pages_platform_lead_gen",NATIVE_STORY:"native_story",MFS_BILL_PAY_CREATION_UPDATE:"mfs_bill_pay_creation_update",MFS_BILL_PAY_REFERENCE_CODE_UPDATE:"mfs_bill_pay_reference_code_update",MFS_BILL_PAY_AGENT_CASH_IN_UPDATE:"mfs_bill_pay_agent_cash_in_update",ISSUE_POSITION:"issue_position",PAGES_PLATFORM_BOOKING_MESSAGE:"pages_platform_booking_message",EXTERNAL_GALLERY:"external_gallery",MEME_SHARE:"meme_share",MESSENGER_PLATFORM_ELEMENT:"messenger_platform_element",INSTANT_GAMES_SHARE_SCORE_MESSAGE:"instant_games_share_score_message",MESSENGER_PLATFORM_BUTTON_LIST:"messenger_platform_button_list",BALLOT:"ballot",LIGHTWEIGHT_ACTION:"lightweight_action",TAROT_DIGEST:"tarot_digest",EVENT_TOUR:"event_tour",ADAPTIVE_MEDIA:"adaptive_media",DYNAMIC_GAME_BOARD:"dynamic_game_board",PAYMENT_PLATFORM:"payment_platform",OMNI_M_FLOW:"omni_m_flow",GROUP_QUIZ:"group_quiz",TRIAL_AD:"trial_ad",TEEM_COLLECTIONS:"teem_collections",CRISIS_DONATION:"crisis_donation",CRISIS_STATUS:"crisis_status",CRISIS_SHARE:"crisis_share",CRISIS_MARK_SAFE:"crisis_mark_safe",CRISIS_LISTING:"crisis_listing",VR_CONTENT:"vr_content",VIDEO_RECOMMENDATION_HSCROLL:"video_recommendation_hscroll",VIDEO_TRAILER:"video_trailer",SHOW_PAGE_SHARE:"show_page_share",MFS_ATTACHMENT:"mfs_attachment",GROUP_TASK:"group_task",CHECKLIST:"checklist",VIDEO_RECOMMENDATION_SINGLETON:"video_recommendation_singleton",PAGE_REVIEW_PROMPT:"page_review_prompt",VIDEO_SHOW:"video_show",UNCONNECTED_VIDEO:"unconnected_video",SHOW_SHARE:"show_share",JOB_SEARCH_JOB_APPLICATION:"job_search_job_application",PAGE_MESSENGER_ATTACHMENT:"page_messenger_attachment",CONTACT_YOUR_REP:"contact_your_rep",LIVE_ELECTION_RESULTS:"live_election_results",LOCATION_EXTENSION:"location_extension",PLACE_RECOMMENDATION:"place_recommendation",JOB_SEARCH_JOB_OPENING:"job_search_job_opening",PAGE_MESSAGE_ONLINE_INDICATOR:"page_message_online_indicator",LOCAL_PIVOT:"local_pivot",ORION_REQUEST_NEW:"orion_request_new",PHOTO_WITH_SHIELD:"photo_with_shield",PLAYABLE_AD:"playable_ad",FUN_FACT_PROMPT:"fun_fact_prompt",FUN_FACT_STACK:"fun_fact_stack",FATIGUED_SHARE:"fatigued_share",DISCUSSION_QUESTION:"discussion_question",PARTIES_INVITE:"parties_invite",PROFILE_INTRO_CARD_BIO:"profile_intro_card_bio",PAGES_SHARE:"pages_share",PRODUCT_RECOMMENDATION_LIST:"product_recommendation_list",VISUAL_POLL:"visual_poll",MULTI_PLACE_RECOMMENDATION:"multi_place_recommendation",PAGE_IN_COMMENT:"page_in_comment",MESSENGER_PLATFORM_MEDIA_ATTACHMENT:"messenger_platform_media_attachment",SCHEDULED_VIDEO_ANNOUNCEMENT:"scheduled_video_announcement",HSCROLL_ITEM:"hscroll_item",MESSENGER_CALL_LOG:"messenger_call_log",PAGE_REVIEW_UPDATE:"page_review_update",LOYALTY_CARD_OFFER:"loyalty_card_offer",GOODWILL_GRID:"goodwill_grid",TRAVEL_PLAN:"travel_plan",FIND_PLAYERS:"find_players",ASSET3D:"asset3d",MESSENGER_GROUP_PERSONAL_LINK:"messenger_group_personal_link",FREQUENTLY_ASKED_QUESTION:"frequently_asked_question",STORY_LIST:"story_list",GOODWILL_SHARED_CARD:"goodwill_shared_card",PAYMENT_BUBBLE_VIEW:"PAYMENT_BUBBLE_VIEW",POST_TO_EVENT_CREATE:"post_to_event_create",MONTAGE_DIRECT:"montage_direct",NEO_INVITATION:"NEO_INVITATION",NATIVE_TEMPLATES_LINK_SHARE_TEST:"native_templates_link_share_test",GOODWILL_HSCROLL:"goodwill_hscroll",NEO_KID_INITIATE_FRIENDING:"NEO_KID_INITIATE_FRIENDING",EVENT_MICRO_ATTACHMENT:"event_micro_attachment",SAVED_LIST:"saved_list",LOCAL_GUIDE:"local_guide",MEET_UP_EVENT:"meet_up_event",DONATION:"donation",BREAKING_NEWS:"breaking_news",VIDEO_REQUEST:"video_request",GOODWILL_COLLAGE:"goodwill_collage",LEAD_FORM:"lead_form",LEAD_FORM_USER_INFO:"lead_form_user_info",EVENT_TICKET_ORDER:"event_ticket_order",PROFILE_CHANNEL:"profile_channel",ICE_BREAKER:"ICE_BREAKER",MOVIE:"movie",ALOHA_CALL:"aloha_call",TIP_JAR_PAYMENT:"tip_jar_payment",COMMENT_MESSAGE_INFO:"comment_message_info",CASH_ON_DELIVERY_ORDER:"cash_on_delivery_order",VOTER_REGISTRATION_DRIVE:"voter_registration_drive",LIVING_ROOM:"living_room",ACHIEVEMENT_POST:"achievement_post",M_BIRTHDAY_REMINDER:"m_birthday_reminder",INSIGHTS_CHART:"insights_chart",GROUP_PROACTIVE_FLAGGED_POST_QUEUE:"group_proactive_flagged_post_queue",PYI_ATTACHMENTS:"pyi_attachments",SHOW_CLICK_TO_WATCH_TAB:"show_click_to_watch_tab",SHOW_MASKED:"show_masked",SHOW_CONTINUE_WATCHING:"show_continue_watching",FOX_ALBUM:"fox_album",TOOL_SHARE:"tool_share",PHONE_REMOVED_ACTION_LIST:"phone_removed_action_list",AMP:"amp",LDP_APP_INSTANCE:"ldp_app_instance",PAGE_RECOMMENDATION_V2:"page_recommendation_v2",PLAY_WITH_FRIENDS:"play_with_friends",BLOOD_REQUEST:"blood_request",HIGH_SCHOOL_COMMUNITY_INVITE:"high_school_community_invite",CIVIC_ACTION_POST:"civic_action_post"})}),null);
__d("MercuryAttachment",["cx","EmojiLikeUtils","MercuryAttachmentContentType","MercuryAttachmentType","MercuryAudioType","StoryAttachmentStyle"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=function i(m){return m===Object(m)},j="_1c_u",k=new Set([c("MercuryAttachmentType").ANIMATED_IMAGE,c("MercuryAttachmentType").PHOTO,c("MercuryAttachmentType").VIDEO,c("MercuryAttachmentType").THIRDPARTYSTICKER]),l={getAttachIconClass:function m(n){__p&&__p();switch(n){case c("MercuryAttachmentContentType").PHOTO:return"_y2-";case c("MercuryAttachmentContentType").VIDEO:return"_y2_";case c("MercuryAttachmentContentType").MUSIC:return"_y30";case c("MercuryAttachmentContentType").VOICE:return"_y31";case c("MercuryAttachmentContentType").TEXT:return"_y32";case c("MercuryAttachmentContentType").MSWORD:return"_y33";case c("MercuryAttachmentContentType").MSXLS:return"_y34";case c("MercuryAttachmentContentType").MSPPT:return"_y35"}return"_y36"},getAttachIconClassByMime:function m(n){return this.getAttachIconClass(this.getAttachTypeByMime(n))},getAttachTypeByMime:function m(n){__p&&__p();if(n.startsWith("image"))return c("MercuryAttachmentContentType").PHOTO;else if(n.startsWith("video"))return c("MercuryAttachmentContentType").VIDEO;else if(n.startsWith("audio"))return c("MercuryAttachmentContentType").MUSIC;else if(n.startsWith("text/plain"))return c("MercuryAttachmentContentType").TEXT;else if(n=="application/msword"||n.startsWith("application/vnd.ms-word")||n.startsWith("application/vnd.openxmlformats-officedocument.wordprocessingml"))return c("MercuryAttachmentContentType").MSWORD;else if(n.startsWith("application/vnd.ms-excel")||n.startsWith("application/vnd.openxmlformats-officedocument.spreadsheetml"))return c("MercuryAttachmentContentType").MSXLS;else if(n.startsWith("application/vnd.ms-powerpoint")||n.startsWith("application/vnd.openxmlformats-officedocument.presentationml"))return c("MercuryAttachmentContentType").MSPPT;else return c("MercuryAttachmentContentType").UNKNOWN},convertRaw:function m(n){__p&&__p();var o=[];for(var p=0;p<n.length;p++){var q=n[p];if(q.attach_type===c("MercuryAttachmentType").PHOTO)o.push(q);else if(q.filename){var r=l.getAttachTypeByMime(q.filetype),s={};s.attach_type=c("MercuryAttachmentType").FILE;s.name=q.filename;s.icon_type=r;s.url="";o.push(s)}}return o},get:function m(n){__p&&__p();var o=[];if(n.attachments)o=n.attachments;else if(n.raw_attachments)o=this.convertRaw(n.raw_attachments);var p=c("EmojiLikeUtils").getEmojiSize(n);if(p)o=o.concat([{attach_type:c("MercuryAttachmentType").EMOJI_LIKE,size:p}]);if(!(n.attachments&&n.attachments.length>0)){if(n.sticker_id)return o.concat([{attach_type:c("MercuryAttachmentType").STICKER}]);if(n.preview_attachments&&n.preview_attachments.length>0)return o.concat(n.preview_attachments)}return o},resizeContain:function m(n,o){var p=n.width/n.height,q=o.width/o.height;if(q<p)return{width:Math.ceil(Math.min(n.height*q,o.width)),height:Math.ceil(Math.min(n.height,o.height))};else return{width:Math.ceil(Math.min(n.width,o.width)),height:Math.ceil(Math.min(n.width/q,o.height))}},isBubblePreferred:function m(n){return this.isFileAttachment(n)},isPhotoAttachment:function m(n){return!!(n.attach_type==c("MercuryAttachmentType").PHOTO||n.attach_type==c("MercuryAttachmentType").ANIMATED_IMAGE||n.attach_type==c("MercuryAttachmentType").THIRDPARTYSTICKER||n.attach_type==c("MercuryAttachmentType").FILE&&n.preview_url)},isPhotoGroupAttachment:function m(n){return k.has(n.attach_type)},isSinglePhotoGroupAttachment:function m(n){return!!(n.attachments&&n.attachments.length===1&&n.attachments[0]&&this.isPhotoGroupAttachment(n.attachments[0]))},isVideoAttachment:function m(n){return n.attach_type==c("MercuryAttachmentType").VIDEO},isShareAttachment:function m(n){return n.attach_type==c("MercuryAttachmentType").SHARE},isFileAttachment:function m(n){return n.attach_type==c("MercuryAttachmentType").FILE},isErrorAttachment:function m(n){return n.attach_type==c("MercuryAttachmentType").ERROR},isStickerAttachment:function m(n){return n.attach_type==c("MercuryAttachmentType").STICKER},isEmojiLikeAttachment:function m(n){return n.attach_type===c("MercuryAttachmentType").EMOJI_LIKE},isVoiceAttachment:function m(n){if(!n.metadata)return false;return n.metadata.type===c("MercuryAudioType").AudioClip||n.metadata.type===c("MercuryAudioType").VoiceMessageWithTranscript},hasAttribution:function m(n){return!!n.app_attribution},isLightweightActionAttachment:function m(n){return l.isShareAttachment(n)&&n.share&&n.share.target!=null&&n.share.target.lwa_type!=null},isSingleVideoAttachment:function m(n){var o=this.get(n).filter(i).filter(function(p){return this.isVideoAttachment(p)}.bind(this));return o.length===1},isSharedVideoAttachment:function m(n){var o=n.attach_type===c("MercuryAttachmentType").SHARE&&n.share&&n.share.subattachments&&n.share.subattachments[0];return!!(o&&o.target&&o.target.video_id)},isGenieSharedVideoAttachment:function m(n){return!!(n.attach_type===c("MercuryAttachmentType").SHARE&&n.share&&n.share.style_list.indexOf(c("StoryAttachmentStyle").GENIE_MESSAGE)>-1&&n.share.target&&n.share.target.attachment&&this.isSharedVideoAttachment(n.share.target.attachment))},isSharedVideoAttachmentMessage:function m(n){var o=this.get(n).filter(i).filter(function(p){return this.isSharedVideoAttachment(p)||this.isGenieSharedVideoAttachment(p)}.bind(this));return o.length===1},getVideoElem:function m(n,o){var p=o.getMessageElement(n);if(!p)return null;var q=p.getElementsByClassName(j);return q&&q.length?q[0]:p}};f.exports=l}),null);
__d("MercuryMessageIDs.bs",["bs_curry","KeyedCallbackManager"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=new(c("KeyedCallbackManager"))();function i(k,l){var m=k.filter(function(o){return o.indexOf("id")===-1}),n=function n(o){return c("bs_curry")._1(l,k.map(function(p){var q=o[p];if(q!==undefined)return q;else return p}))};return h.executeOrEnqueue(m,n)}function j(k,l){h.setResource(k,l);return 0}g.getServerIDs=i;g.addServerID=j}),null);
__d("MessagingGiftWrapConstants",[],(function a(b,c,d,e,f,g){"use strict";var h="gift_wrap",i="gift_unwrapped",j="valentines2016";f.exports={TAG_PREFIX:h,UNWRAPPED_TAG:i,VALENTINES_GIFT:j}}),null);
__d("MessengerFluxReduceDispatcher",["ExplicitRegistrationReactDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("ExplicitRegistrationReactDispatcher"));i=h&&h.prototype;function j(){h.apply(this,arguments)}f.exports=new j({strict:false})}),null);
__d("MessengerSharedMediaActions",["MessengerFluxReduceDispatcher","keyMirror"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("keyMirror")({CURRENT_LOADED:null,DELETE_PHOTOS:null,LATEST_LOADED:null,LOAD_CURRENT:null,LOAD_MORE_LATEST:null,LOAD_MORE_PREVIOUS:null,PREVIOUS_LOADED:null}),i="MessengerSharedMedia",j={Types:h,Namespace:i,currentLoaded:function k(l){c("MessengerFluxReduceDispatcher").dispatch({type:h.CURRENT_LOADED,namespace:i,data:l})},deletePhotos:function k(l,m){c("MessengerFluxReduceDispatcher").dispatch({type:h.DELETE_PHOTOS,namespace:i,threadFBID:l,photoFBIDs:m})},loadCurrent:function k(l,m){c("MessengerFluxReduceDispatcher").dispatch({type:h.LOAD_CURRENT,namespace:i,threadFBID:l,photoID:m})},loadMorePrevious:function k(l,m,n){c("MessengerFluxReduceDispatcher").dispatch({type:h.LOAD_MORE_PREVIOUS,namespace:i,threadFBID:l,afterCursor:m,first:n})},loadMoreLatest:function k(l,m,n){c("MessengerFluxReduceDispatcher").dispatch({type:h.LOAD_MORE_LATEST,namespace:i,threadFBID:l,beforeCursor:m,last:n})},previousLoaded:function k(l){c("MessengerFluxReduceDispatcher").dispatch({type:h.PREVIOUS_LOADED,namespace:i,data:l})},latestLoaded:function k(l){c("MessengerFluxReduceDispatcher").dispatch({type:h.LATEST_LOADED,namespace:i,data:l})}};f.exports=j}),null);
__d("MercuryMessages",["invariant","BanzaiODS","ChatReliabilityInstrumentation","EventEmitter","FBJSON","ImmutableObject","LogHistory","MercuryActionStatus","MercuryActionType","MercuryAssert","MercuryAttachment","MercuryDispatcher","MercuryIDs","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySingletonProvider","MercuryMessageActions","MercuryMessageIDs.bs","MessagingGiftWrapConstants","MessengerSharedMediaActions","RangedCallbackManager","MercurySendMessageFields","MercuryServerRequests","MercuryThreadActions","MercuryThreadInformer","MercuryThreads","URI","gkx","isMessengerDotComURI","setImmediate"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=new(c("EventEmitter"))(),j=c("LogHistory").getInstance("mercury_messages");function k(p){switch(p){case c("MercuryPayloadSource").UNKNOWN:case c("MercuryPayloadSource").SERVER_INITIAL_DATA:case c("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO:case c("MercuryPayloadSource").SERVER_THREAD_SYNC:return true}return false}l.getForFBID=function(p){return o.getForFBID(p)};l.get=function(){return o.get()};function l(p){__p&&__p();this.$MercuryMessages1=p;this.$MercuryMessages2=c("MercuryMessageActions").getForFBID(this.$MercuryMessages1);this.$MercuryMessages3=c("MercuryServerRequests").getForFBID(this.$MercuryMessages1);this.$MercuryMessages4=c("MercuryThreadInformer").getForFBID(this.$MercuryMessages1);this.$MercuryMessages5=c("MercuryThreads").getForFBID(this.$MercuryMessages1);this.$MercuryMessages6=c("MercuryThreadActions").getForFBID(this.$MercuryMessages1);this.$MercuryMessages7=c("MercuryDispatcher").getForFBID(this.$MercuryMessages1);this.$MercuryMessages8=false;this.$MercuryMessages9={};this.$MercuryMessages10={};this.$MercuryMessages11={};this.$MercuryMessages12=new Map();this.$MercuryMessages13={};this.$MercuryMessages14={};this.$MercuryMessages7.subscribe("update-messages",function(q,r){__p&&__p();var s=(r.actions||[]).filter(function(u){var v=u.action_type,w=u.thread_id&&(v==c("MercuryActionType").LOG_MESSAGE||v==c("MercuryActionType").USER_GENERATED_MESSAGE||v==c("MercuryActionType").SEND_MESSAGE||v==c("MercuryActionType").DELETE_THREAD||v==c("MercuryActionType").DELETE_MESSAGES),x=u.upload_id&&u.upload_data&&(v==c("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER||v==c("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER),y=v==c("MercuryActionType").REACTION_UPDATE,z=v==c("MercuryActionType").MONTAGE_DIRECT_EXPIRE,A=v==c("MercuryActionType").LIVE_LOCATION_UPDATE,B=u.replaced_message_id&&v==c("MercuryActionType").REPLACE_MESSAGE,C=u.unwrapped_message_id&&v==c("MercuryActionType").UNWRAP_MESSAGE;return w||x||y||A||B||C||z}),t=k(r.payload_source);this.handleUpdates(s,t,r.payload_source,r.from_client);if(r.end_of_history)this.$MercuryMessages15(r.end_of_history,r.payload_source);if(this.$MercuryMessages8){this.$MercuryMessages8=false;i.emit("change")}}.bind(this));this.$MercuryMessages7.subscribe("invalidate-thread-state",function(q,r){this.$MercuryMessages16(r)}.bind(this));this.$MercuryMessages7.subscribe("invalidate-global-state",function(){return this.invalidateGlobalState()}.bind(this));j.debug("constructed",JSON.stringify({fbid:this.$MercuryMessages1}))}l.prototype.getMessagesFromIDs=function(p){return(p||[]).map(function(q){return this.$MercuryMessages17(q)}.bind(this)).filter(function(q){return q})};l.prototype.getServerMessageID=function(p){var q=p;if(this.$MercuryMessages13[p])q=this.$MercuryMessages13[p];return q};l.prototype.hasLoadedNMessages=function(p,q){var r=this.$MercuryMessages18(p);return r.hasReachedEndOfArray()||r.getCurrentArraySize()>=q};l.prototype.hasLoadedExactlyNMessages=function(p,q){var r=this.$MercuryMessages18(p);return r.getCurrentArraySize()==q};l.prototype.invalidateGlobalState=function(){var p=Object.keys(this.$MercuryMessages10);this.$MercuryMessages9={};this.$MercuryMessages10={};this.$MercuryMessages11={};this.$MercuryMessages12=new Map();this.$MercuryMessages13={};p.map(function(q){return this.$MercuryMessages4.invalidatedThread(q)}.bind(this))};l.prototype.getThreadMessagesRange=function(p,q,r,s,t,u){var v=this.$MercuryMessages18(p),w=function(G){s(this.$MercuryMessages19(G))}.bind(this),x=v.executeOrEnqueue(q,r,w),y=v.getUnavailableResources(x),z=this.$MercuryMessages9[p];if(y.length&&!z){var A=v.getCurrentArraySize(),B=this.$MercuryMessages11[p]||0,C=A-B,D=y.length+B,E=this.getCurrentlyLoadedMessages(p),F=E.length?E[0].timestamp:null;this.$MercuryMessages3.fetchThreadMessages(p,C,D,F,t,u)}else this.$MercuryMessages9[p]=false;return x};l.prototype.getThreadMessagesRangeNow=function(p,q,r){var s=this.$MercuryMessages18(p),t=[];for(var u=q;u<q+r;u++){var v=s.getResourceAtIndex(u),w=v&&this.$MercuryMessages17(v);w&&t.push(w)}return t};l.prototype.getThreadMessagesSinceTimestamp=function(p,q){var r=this.$MercuryMessages18(p),s=r.getElementsUntil(q);return this.$MercuryMessages19(s)};l.prototype.hasLoadedAllMessages=function(p){return this.$MercuryMessages18(p).hasReachedEndOfArray()};l.prototype.getCurrentlyLoadedMessages=function(p){var q=this.$MercuryMessages18(p).getAllResources();return this.$MercuryMessages19(q)};l.prototype.unsubscribe=function(p,q){c("MercuryAssert").isThreadID(q);var r=this.$MercuryMessages18(q);r.unsubscribe(p)};l.prototype.$MercuryMessages20=function(p,q){n(q);this.$MercuryMessages12.set(p,new(c("ImmutableObject"))(q))};l.prototype.$MercuryMessages21=function(p,q){__p&&__p();var r=this.$MercuryMessages12.get(p);if(r){var s=r.page_admin_notes?r.page_admin_notes.slice():[],t=false,u=true;for(var v=0;v<s.length;++v)if(s[v].id===q.id){t=true;u=false;break}else if((s[v].id===null||s[v].id===undefined)&&s[v].body===q.body){t=true;s[v]=q}if(!t)s.push(q);if(u){var w={};w.page_admin_notes=s;this.$MercuryMessages22(p,r,w)}}};l.prototype.$MercuryMessages22=function(p,q,r){var s=c("ImmutableObject").set(q,r);this.$MercuryMessages12.set(p,s);return s};l.prototype.$MercuryMessages23=function(p,q,r){__p&&__p();if(p==c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE){var s=this.getThreadMessagesSinceTimestamp(q,r);if(s.length>0){c("BanzaiODS").bumpEntityKey("chat.web","channel.messages_reordered");return true}}else if(p===c("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE||p===c("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE)return true;return false};l.prototype.$MercuryMessages24=function(p,q){__p&&__p();var r=p.action_type;if(q==c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE&&r==c("MercuryActionType").USER_GENERATED_MESSAGE&&p.offline_threading_id&&this.$MercuryMessages13[p.offline_threading_id]===p.offline_threading_id){p.client_message_id=p.offline_threading_id;p.status=c("MercuryActionStatus").SUCCESS;p.action_type=c("MercuryActionType").SEND_MESSAGE;r=p.action_type}if(q===c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE&&r==c("MercuryActionType").USER_GENERATED_MESSAGE){var s=this.$MercuryMessages5.getThreadMetaNow(p.thread_id);if(s&&s.folder)p.folder=s.folder;c("ChatReliabilityInstrumentation").logMESSAGE_RECEIVED(c("FBJSON").stringify({otid:p.offline_threading_id,message_id:p.message_id,other_user_fbid:p.other_user_fbid,viewer_page_fbid:!s||!s.page_thread_info?null:s.page_thread_info.pageID}))}return p};l.prototype.handleUpdates=function(p,q,r,s){__p&&__p();var t=void 0,u={};for(var v=0;v<p.length;v++){var w=this.$MercuryMessages24(p[v],r),x=w.action_type,y=w.message_id?this.$MercuryMessages17(w.message_id):null;if(x==c("MercuryActionType").LOG_MESSAGE)if(this.isLocalMessage(w))continue;if(r==c("MercuryPayloadSource").SERVER_SEARCH){if(!this.$MercuryMessages12.has(w.message_id))this.$MercuryMessages20(w.message_id,w);continue}else if(w.client_state===c("MercuryMessageClientState").SEND_TO_SERVER){this.$MercuryMessages20(w.message_id,w);continue}else if(x==c("MercuryActionType").SEND_MESSAGE){var z=w.client_message_id,A=this.$MercuryMessages17(z);if(z&&A&&w.status){var B=A.status;if(A.status==c("MercuryActionStatus").SUCCESS)continue;if(!u[w.thread_id])u[w.thread_id]=[];this.$MercuryMessages25(w);if(typeof B!==undefined||w.status==c("MercuryActionStatus").FAILED_UNKNOWN_REASON||w.status==c("MercuryActionStatus").UNABLE_TO_CONFIRM||w.status==c("MercuryActionStatus").SUCCESS||w.status==c("MercuryActionStatus").ERROR){var C=this.$MercuryMessages17(z);if(C)this.$MercuryMessages26(w.thread_id,C.message_id,r)}}continue}else if(x==c("MercuryActionType").DELETE_THREAD){this.$MercuryMessages18(w.thread_id).removeAllResources();continue}else if(x==c("MercuryActionType").DELETE_MESSAGES){this.$MercuryMessages27(w.thread_id,w.message_ids,r);c("setImmediate")(function(){this.$MercuryMessages6.updateSnippet(w.thread_id,w.message_ids)}.bind(this));continue}else if(x===c("MercuryActionType").REACTION_UPDATE){if(this.$MercuryMessages28(w))this.$MercuryMessages29(u,w,r);continue}else if(x===c("MercuryActionType").MONTAGE_DIRECT_EXPIRE){if(this.$MercuryMessages30(w))this.$MercuryMessages29(u,w,r);continue}else if(x===c("MercuryActionType").LIVE_LOCATION_UPDATE){if(this.$MercuryMessages31(w))this.$MercuryMessages29(u,w,r);continue}else if(x==c("MercuryActionType").REPLACE_MESSAGE){if(this.$MercuryMessages32(w)){this.$MercuryMessages29(u,w,r);q=true}continue}else if(w.offline_threading_id&&this.$MercuryMessages13[w.offline_threading_id]&&(r!=c("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO||this.$MercuryMessages13[w.offline_threading_id]===w.message_id)||y){if(y&&w.ranges&&w.ranges.length>0){var D=y.message_id;this.$MercuryMessages22(this.$MercuryMessages13[D]||D,y,{ranges:w.ranges});this.$MercuryMessages26(y.thread_id,y.message_id,"link_shim")}continue}else if(x===c("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER){this.$MercuryMessages33(w.upload_id,w.upload_data);continue}else if(x===c("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER){this.$MercuryMessages34(w.upload_id,w.upload_data);continue}else if(x==c("MercuryActionType").UNWRAP_MESSAGE){if(this.$MercuryMessages35(w))this.$MercuryMessages26(w.thread_id,w.unwrapped_message_id,r)}else{if(r===c("MercuryPayloadSource").CLIENT_SEND_MESSAGE){this.$MercuryMessages13[w.message_id]=w.message_id;if(w.thread_id=="root:"+w.offline_threading_id)this.$MercuryMessages18(w.thread_id).setReachedEndOfArray()}if(x==c("MercuryActionType").LOG_MESSAGE&&w.log_message_type==c("MercuryLogMessageType").SERVER_ERROR)this.$MercuryMessages9[w.thread_id]=true;if(w.client_state===c("MercuryMessageClientState").DO_NOT_SEND_TO_SERVER&&w.upload_id)this.$MercuryMessages14[w.upload_id]=w;if(!u[w.thread_id])u[w.thread_id]=[];u[w.thread_id].push(w.message_id);this.$MercuryMessages20(w.message_id,w);if(w.offline_threading_id&&w.offline_threading_id!=w.message_id){this.$MercuryMessages13[w.offline_threading_id]=w.message_id;c("MercuryMessageIDs.bs").addServerID(w.offline_threading_id,w.message_id);if(w.threading_id)c("MercuryMessageIDs.bs").addServerID(w.threading_id,w.message_id)}if(w[c("MercurySendMessageFields").MANUAL_RETRY_CNT]>0){t=this.$MercuryMessages18(w.thread_id);t.resortResources([w.message_id]);this.$MercuryMessages36(w.thread_id,c("MercuryPayloadSource").CLIENT_SEND_MESSAGE)}q=q||this.$MercuryMessages23(r,w.thread_id,w.timestamp);if(!q){var E=this.$MercuryMessages17(w.message_id);if(E)this.$MercuryMessages37(E)}continue}}for(var F in u){t=this.$MercuryMessages18(F);var G=t.getAllResources(),H=G.filter(function(D){var I=this.$MercuryMessages12.get(D);if(!I)return true;return I.action_type==c("MercuryActionType").LOG_MESSAGE&&I.log_message_type==c("MercuryLogMessageType").SERVER_ERROR}.bind(this));t.removeResources(H);if(s)this.$MercuryMessages38(F,u[F]);if(q){t.addResources(u[F]);this.$MercuryMessages36(F,r)}else t.addResourcesWithoutSorting(u[F].reverse(),0);this.$MercuryMessages4.updatedThread(F)}};l.prototype.$MercuryMessages29=function(p,q,r){var s=q.message_id||q.messageId;if(!p[q.thread_id])p[q.thread_id]=[];this.$MercuryMessages18(q.thread_id).removeResources([q.replaced_message_id,q.offline_threading_id]);if(q.action_type!==c("MercuryActionType").REACTION_UPDATE&&q.action_type!==c("MercuryActionType").LIVE_LOCATION_UPDATE&&q.action_type!==c("MercuryActionType").MONTAGE_DIRECT_EXPIRE)p[q.thread_id].push(s);if(q.replaced_message_id)this.$MercuryMessages26(q.thread_id,q.replaced_message_id,r);this.$MercuryMessages26(q.thread_id,s,r)};l.prototype.isFirstMessage=function(p){var q=this.$MercuryMessages18(p.thread_id);if(q.getCurrentArraySize()===0)return false;var r=q.getResourceAtIndex(q.getCurrentArraySize()-1),s=this.$MercuryMessages17(r),t=s&&s.message_id,u=this.$MercuryMessages17(p.message_id),v=u&&u.message_id;if(!t||!v)return false;return q.hasReachedEndOfArray()&&t==v};l.prototype.isLocalMessage=function(p){if(p.offline_threading_id!==null&&p.offline_threading_id===p.message_id)return true;return false};l.prototype.$MercuryMessages27=function(p,q,r){__p&&__p();if(!q.length)return;this.$MercuryMessages39(p,q,r);if(r!==c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE)this.$MercuryMessages3.deleteMessages(p,q);var s=this.$MercuryMessages19(q);for(var t=0;t<s.length;t++){var u=s[t];if(u&&u.has_attachment){var v=u.attachments.map(function(w){if(c("MercuryAttachment").isPhotoAttachment(w)||c("MercuryAttachment").isVideoAttachment(w))return w.metadata.fbid;return null}).filter(function(w){return w!==null});c("MessengerSharedMediaActions").deletePhotos(c("MercuryIDs").getThreadFBIDFromThreadID(u.thread_id),v)}}};l.prototype.$MercuryMessages39=function(p,q,r){var s=q.map(function(u){var v=this.$MercuryMessages17(u);return v&&v.message_id}.bind(this)).filter(function(u){return!!u}),t=this.$MercuryMessages18(p);t.removeResources(s);this.$MercuryMessages36(p,r)};l.prototype.$MercuryMessages25=function(p){__p&&__p();var q=p.client_message_id;if(!q)return false;var r=this.$MercuryMessages17(q);if(!r)return false;var s={};s.status=p.status;if(p.status===c("MercuryActionStatus").SUCCESS||p.error_data)s.error_data=p.error_data;var t=p.message_id;if(this.$MercuryMessages12.has(t)){if(r)this.$MercuryMessages22(t,r,s);return false}if(p.threading_id)s.threading_id=p.threading_id;if(p.timestamp)s.timestamp=p.timestamp;if(p.log_message_data)s.log_message_data=p.log_message_data;if(p.ranges&&p.ranges.length){n(p);s.ranges=p.ranges}if(p.attachments&&p.attachments.length){s.raw_attachments=null;s.attachments=p.attachments}this.$MercuryMessages13[q]=t;c("MercuryMessageIDs.bs").addServerID(q,t);if(r){var u=this.$MercuryMessages22(t,r,s);this.$MercuryMessages12.set(q,new(c("ImmutableObject"))());if(m(u))this.$MercuryMessages11[u.thread_id]--}return true};l.prototype.$MercuryMessages28=function(p){var q,r=p.messageId,s=p.reaction,t=p.userId,u=this.$MercuryMessages17(r);if(!u)return false;var v=babelHelpers["extends"]({},u.reactions,(q={},q[t]=s,q));if(!s)delete v[t];this.$MercuryMessages22(r,u,{reactions:v});return true};l.prototype.$MercuryMessages30=function(p){__p&&__p();if(!c("gkx")("AT5MAotH6BG7mXo4DyZnW3seA7_jf32c8tGX1llmkbXJ5ui_oKs0jpz-iYum9Gkv1o7pv5ZMvW9WlaNx_vA1ZSmAhi0Rjb62jJA5vu2Oz81AxQ"))return false;var q=p.messageId,r=this.$MercuryMessages17(q);if(!r||!r.attachments||r.attachments.length!==1)return false;var s=r.attachments[0];if(!s||!s.share)return false;var t=s.share.media;if(!t)return false;var u=s.share.target;if(!u||!u.message_state)return false;var v=babelHelpers["extends"]({},s,{share:babelHelpers["extends"]({},s.share,{media:babelHelpers["extends"]({},t,{image:null,source:null}),target:babelHelpers["extends"]({},u,{message_state:"EXPIRED",blob_media:null,image:null})})});this.$MercuryMessages22(q,r,{attachments:[v]});return true};l.prototype.$MercuryMessages31=function(p){__p&&__p();var q=p.messageId,r=p.liveLocation,s=this.$MercuryMessages17(q);if(!s||!s.attachments||s.attachments.length!==1)return false;var t=s.attachments[0];if(!t||!t.share)return false;var u=t.share.target;if(!u||!u.live_location_id)return false;var v=babelHelpers["extends"]({},t,{share:babelHelpers["extends"]({},t.share,{target:babelHelpers["extends"]({},r,{live_location_id:u.live_location_id})})});this.$MercuryMessages22(q,s,{attachments:[v]});return true};l.prototype.$MercuryMessages32=function(p){__p&&__p();var q=p.replaced_message_id;if(!q)return false;var r=this.$MercuryMessages17(q);if(!r)return false;var s=p.message_id,t={};if(p.status)t.status=p.status;if(p.timestamp&&s!==q)t.timestamp=p.timestamp;if(p.log_message_data)t.log_message_data=p.log_message_data;if(p.ranges&&p.ranges.length){n(p);t.ranges=p.ranges}if(p.meta_ranges)t.meta_ranges=p.meta_ranges;if(p.attachments&&p.attachments.length){t.raw_attachments=null;t.attachments=p.attachments}if(p.body&&p.body!==r.body)t.body=p.body;if(p.platform_xmd&&p.platform_xmd!==r.platform_xmd)t.platform_xmd=p.platform_xmd;if(p.profile_ranges&&p.profile_ranges!==r.profile_ranges)t.profile_ranges=p.profile_ranges;if(Object.keys(t).length===0)return false;c("MercuryMessageIDs.bs").addServerID(s,s);this.$MercuryMessages22(s,r,t);if(q!==s){this.$MercuryMessages12["delete"](q);if(r.message_id&&this.$MercuryMessages12.has(r.message_id))this.$MercuryMessages12["delete"](r.message_id)}return true};l.prototype.$MercuryMessages35=function(p){var q=this.$MercuryMessages17(p.unwrapped_message_id);if(!q||!q.tags)return false;var r=q.tags.slice(0);r.push(c("MessagingGiftWrapConstants").UNWRAPPED_TAG);var s={tags:r};this.$MercuryMessages22(p.unwrapped_message_id,q,s);return true};l.prototype.getNumberLocalMessages=function(p){return this.$MercuryMessages11[p]||0};l.prototype.$MercuryMessages33=function(p,q){var r=this.$MercuryMessages40(p,q);delete r.preview_attachments;this.$MercuryMessages3.sendNewMessage(r)};l.prototype.$MercuryMessages34=function(p,q){var r=this.$MercuryMessages40(p,q);this.$MercuryMessages39(r.thread_id,[r.message_id]);if(this.$MercuryMessages11[r.thread_id])this.$MercuryMessages11[r.thread_id]--};l.prototype.$MercuryMessages40=function(p,q){__p&&__p();var r=this.$MercuryMessages14[p];r||h(0);r.image_ids=q.image_ids;r.file_ids=q.file_ids;r.audio_ids=q.audio_ids;r.gif_ids=q.gif_ids;r.video_ids=q.video_ids;r.client_state=c("MercuryMessageClientState").SEND_TO_SERVER;delete this.$MercuryMessages14[p];return r};l.prototype.$MercuryMessages26=function(p,q,r){this.$MercuryMessages8=true;this.$MercuryMessages4.updatedMessage(p,q,r)};l.prototype.$MercuryMessages37=function(p){this.$MercuryMessages8=true;this.$MercuryMessages4.receivedMessage(p)};l.prototype.$MercuryMessages36=function(p,q){this.$MercuryMessages8=true;this.$MercuryMessages4.reorderedMessages(p,q)};l.prototype.$MercuryMessages16=function(p){__p&&__p();if(!this.$MercuryMessages10[p])return;var q=this.$MercuryMessages10[p].getAllResources();q.forEach(function(r){__p&&__p();var s=this.$MercuryMessages17(r),t=undefined;if(s)t=s.offline_threading_id;this.$MercuryMessages12["delete"](r);if(t){var u=this.$MercuryMessages13[t];if(u)this.$MercuryMessages12["delete"](u);delete this.$MercuryMessages13[t]}delete this.$MercuryMessages13[r]}.bind(this));delete this.$MercuryMessages10[p]};l.addListener=function(p,q){return i.addListener(p,q)};l.prototype.$MercuryMessages17=function(p){var q=p;if(this.$MercuryMessages13[p])q=this.$MercuryMessages13[p];return this.$MercuryMessages12.get(q)};l.prototype.$MercuryMessages18=function(p){if(!this.$MercuryMessages10[p])this.$MercuryMessages10[p]=new(c("RangedCallbackManager"))(function(q){var r=this.$MercuryMessages17(q);return r&&r.timestamp}.bind(this),function(q,r){return r-q});return this.$MercuryMessages10[p]};l.prototype.$MercuryMessages15=function(p,q){p.forEach(function(r){var s=this.$MercuryMessages18(r);s.setReachedEndOfArray();this.$MercuryMessages36(r,q)}.bind(this))};l.prototype.$MercuryMessages19=function(p){var q=p.reduce(function(r,s){var t=this.$MercuryMessages17(s);if(t)r.push(t);return r}.bind(this),[]);return q.reverse()};l.prototype.$MercuryMessages38=function(p,q){var r=q.filter(function(s){return m(this.$MercuryMessages17(s))}.bind(this));if(!this.$MercuryMessages11[p])this.$MercuryMessages11[p]=0;this.$MercuryMessages11[p]+=r.length};function m(p){var q=p.action_type;if(q==c("MercuryActionType").USER_GENERATED_MESSAGE)return true;switch(p.log_message_type){case c("MercuryLogMessageType").SUBSCRIBE:case c("MercuryLogMessageType").UNSUBSCRIBE:case c("MercuryLogMessageType").SERVER_ERROR:case c("MercuryLogMessageType").LIVE_LISTEN:return false;default:return true}}function n(p){__p&&__p();if(!p.ranges)return;p.ranges.forEach(function(q){if(!q.entity||q.entity.external||!q.entity.url)return;var r=new(c("URI"))(q.entity.url);if(c("isMessengerDotComURI")(c("URI").getRequestURI())&&!r.getDomain()){r.setProtocol("https").setDomain("www.facebook.com");q.entity.url=r.toString()}})}var o=new(c("MercurySingletonProvider"))(l);f.exports=l}),null);
__d("MercuryParticipantFetcher",["LogHistory","MercuryIDs","MercuryPayloadSource","MercuryServerPayloadPreprocessor","ShortProfiles","clearTimeout","setImmediate","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("LogHistory").getInstance("short_profiles");function i(k){this.$MercuryParticipantFetcher4=c("MercuryServerPayloadPreprocessor").getForFBID(k);this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2=new Set();this.$MercuryParticipantFetcher3=new Set();this.$MercuryParticipantFetcher5=setInterval(this.$MercuryParticipantFetcher7.bind(this),20*1e3)}i.prototype.fetch=function(k){this.$MercuryParticipantFetcher8(k);this.$MercuryParticipantFetcher7()};i.prototype.fetchMulti=function(k){if(k.length){k.forEach(function(l){return this.$MercuryParticipantFetcher8(l)}.bind(this));this.$MercuryParticipantFetcher7()}};i.prototype.$MercuryParticipantFetcher8=function(k){if(!this.$MercuryParticipantFetcher3.has(k))this.$MercuryParticipantFetcher2.add(k)};i.prototype.$MercuryParticipantFetcher7=function(){__p&&__p();if(this.$MercuryParticipantFetcher1||this.$MercuryParticipantFetcher2.size===0)return;this.$MercuryParticipantFetcher1=true;c("setImmediate")(function(){__p&&__p();this.$MercuryParticipantFetcher1=false;this.$MercuryParticipantFetcher2.forEach(function(k){return this.$MercuryParticipantFetcher3.add(k)}.bind(this));this.$MercuryParticipantFetcher9(this.$MercuryParticipantFetcher2,function(k){k.forEach(function(l){return this.$MercuryParticipantFetcher3["delete"](l.id)}.bind(this));this.$MercuryParticipantFetcher10(k);if(this.$MercuryParticipantFetcher6)c("clearTimeout")(this.$MercuryParticipantFetcher6)}.bind(this));this.$MercuryParticipantFetcher11();this.$MercuryParticipantFetcher2.clear()}.bind(this))};i.prototype.$MercuryParticipantFetcher11=function(){this.$MercuryParticipantFetcher6=c("setTimeoutAcrossTransitions")(function(){this.$MercuryParticipantFetcher3.forEach(function(k){return this.$MercuryParticipantFetcher2.add(k)}.bind(this));this.$MercuryParticipantFetcher3.clear()}.bind(this),11*1e3)};i.prototype.$MercuryParticipantFetcher9=function(k,l){__p&&__p();var m=[];k.forEach(function(n){var o=c("MercuryIDs").tokenize(n),p=o.type,q=o.value;p==="fbid"&&m.push(q)});if(m.length>0){c("ShortProfiles").getMulti(m,function(n){var o=[];for(var p in n)o.push(j(n[p],p));l(o);if(o.length!==m.length)h.error("server_fetch_participant_count_error",JSON.stringify({expectedIDs:m,receivedIDs:Object.keys(n)}))});h.debug("client_fetch_participants",JSON.stringify({userIDs:m}))}};i.prototype.$MercuryParticipantFetcher10=function(k){this.$MercuryParticipantFetcher4.handleUpdate({participants:k,from_client:false,payload_source:c("MercuryPayloadSource").SERVER_FETCH_PARTICIPANTS})};function j(k,l){__p&&__p();var m=babelHelpers["extends"]({gender:k.gender,fbid:k.id||l,href:k.uri,id:c("MercuryIDs").getParticipantIDFromUserID(k.id||l),image_src:k.thumbSrc,name:k.name,short_name:k.firstName,employee:k.employee,is_employee_away:k.is_employee_away,type:k.type,vanity:k.vanity,is_friend:k.is_friend,is_messenger_user:k.is_messenger_user,is_coworker:k.is_coworker},{});if(k.officeStatus){m.officeStatus=k.officeStatus;m.officeStatusEndDate=k.officeStatusEndDate;m.officeStatusComment=k.officeStatusComment;m.officeStatusLocation=k.officeStatusLocation}if(k.timezone||k.timezone===0)m.timezone=k.timezone;if(k.personal_id)m.personal_id=k.personal_id;if(k.work_id)m.work_id=k.work_id;if(k.roomLocation)m.room_location=k.roomLocation;return m}f.exports=i}),null);
__d("ImageSourceType",[],(function a(b,c,d,e,f,g){var h=Object.freeze({PROFILE_PICTURE:"profile_picture",IMAGE:"image"});f.exports=h}),null);
__d("PhotoResizeModeConst",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CONTAIN:"s",COVER:"p"})}),null);
__d("ImageSourceRequest",["CurrentUser","ImageSourceType","KeyedCallbackManager","PhotoResizeModeConst","MercuryServerDispatcher"],(function a(b,c,d,e,f,g){__p&&__p();function h(){"use strict";this._request={fbid:null,type:null,width:null,height:null,resize_mode:null};this._callback=null}h.prototype.setFBID=function(l){"use strict";this._request.fbid=l;return this};h.prototype.setType=function(l){"use strict";if(![c("ImageSourceType").PROFILE_PICTURE,c("ImageSourceType").IMAGE].includes(l))throw new TypeError("ImageSourceRequest.setType: invalid type "+l);this._request.type=l;return this};h.prototype.setDimensions=function(l,m){"use strict";this._request.width=l;this._request.height=m;return this};h.prototype.setResizeMode=function(l){"use strict";if(![c("PhotoResizeModeConst").COVER,c("PhotoResizeModeConst").CONTAIN].includes(l))throw new TypeError("ImageSourceRequest.setResizeMode: invalid resize mode "+l);this._request.resize_mode=l;return this};h.prototype.setCallback=function(l){"use strict";this._callback=l;return this};h.prototype.send=function(){"use strict";__p&&__p();if(!this._request.fbid||!this._request.width||!this._request.height||!this._request.type||!this._request.resize_mode||!this._callback)throw new Error("ImageSourceRequest: You must set all the fields");var l=j(),m=k(this._request);l.executeOrEnqueue(m,this._callback);if(l.getUnavailableResourcesFromRequest(m).length===1){c("MercuryServerDispatcher").trySend("/ajax/image_source.php",{requests:[this._request]});return true}return false};var i=null;function j(){__p&&__p();if(i)return i;var l=new(c("KeyedCallbackManager"))();i=l;c("MercuryServerDispatcher").registerEndpoints({"/ajax/image_source.php":{request_user_id:c("CurrentUser").getID(),mode:c("MercuryServerDispatcher").BATCH_DEFERRED_MULTI,batch_function:function m(n,o){var p;(p=n.requests).push.apply(p,o.requests);return n},handler:function m(n,o){var p=o.getData().requests;for(var q=0;q<p.length;++q)l.setResource(k(p[q]),n[q])}}});return l}function k(l){return[l.fbid,l.type,l.width,l.height,l.resize_mode].join("|")}f.exports=h}),null);
__d("MercuryParticipants",["fbt","CurrentUser","EventEmitter","ImageSourceRequest","ImageSourceType","ImmutableObject","KeyedCallbackManager","MercuryAssert","MercuryIDs","MercuryParticipantFetcher","MercuryParticipantTypes","MercuryParticipantsConstants","MercuryDispatcher","MercuryVanityIDMap.bs","PhotoResizeModeConst","createObjectFrom"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i="change";function j(l){__p&&__p();this.$MercuryParticipants1=l;this.$MercuryParticipants2=new(c("EventEmitter"))();this.$MercuryParticipants3=new(c("KeyedCallbackManager"))();this.$MercuryParticipants4=new(c("MercuryParticipantFetcher"))(this.$MercuryParticipants1);this.$MercuryParticipants5=c("MercuryDispatcher").getForFBID(this.$MercuryParticipants1);this.$MercuryParticipants5.subscribe("update-participants",function(m,n){if(n.participants&&n.participants.length>0)this.$MercuryParticipants6(n.participants)}.bind(this));this.$MercuryParticipants5.subscribe("invalidate-global-state",function(){this.$MercuryParticipants7()}.bind(this))}j.prototype.addListener=function(l,m){return this.$MercuryParticipants2.addListener(l,m)};j.prototype.getIDFromVanityOrFBID=function(l){if(!l)return null;if(c("MercuryVanityIDMap.bs").hasVanity(l))return c("MercuryVanityIDMap.bs").getID(l);if(/^\d+$/.test(l))return c("MercuryIDs").getParticipantIDFromUserID(l);return undefined};j.prototype.getNow=function(l){return this.$MercuryParticipants8(l)};j.prototype.getOrFetch=function(l){var m=this.$MercuryParticipants8(l);if(!m)this.$MercuryParticipants4.fetch(l);return m};j.prototype.get=function(l,m){c("MercuryAssert").isParticipantID(l);return this.$MercuryParticipants9([l],function(n){m(n[l])})};j.prototype.getMulti=function(l,m){return this.$MercuryParticipants9(l,m)};j.prototype.getBigImageMulti=function(l,m){__p&&__p();var n=arguments.length<=2||arguments[2]===undefined?c("MercuryParticipantsConstants").BIG_IMAGE_SIZE:arguments[2];c("MercuryAssert").allParticipantIDs(l);var o=false,p=this.$MercuryParticipants9(l,function(q){__p&&__p();var r={},s=0,t=new Set(),u=function(w,y){s++;r[w]=y;if(s===l.length){if(!o)m(r);if(t.size>0)this.$MercuryParticipants10(t)}}.bind(this),v=function(w,y){var z=this.$MercuryParticipants3.getResource(w);if(!z)return;this.$MercuryParticipants3.setResource(w,c("ImmutableObject").set(z,{big_image_src:y.uri}));t.add(w);u(w,y.uri)}.bind(this);for(var w in q){var x=q[w];if(!x.big_image_src)new(c("ImageSourceRequest"))().setFBID(c("MercuryIDs").getUserIDFromParticipantID(w)).setType(c("ImageSourceType").PROFILE_PICTURE).setDimensions(n,n).setResizeMode(c("PhotoResizeModeConst").COVER).setCallback(v.bind(null,w)).send();else u(x.id,x.big_image_src)}}.bind(this));return{remove:function q(){o=true;p.remove()}}};j.prototype.getOrderedBigImageMulti=function(l,m){return this.getBigImageMulti(l,function(n){m(l.map(function(o){return n[o]}))})};j.prototype.$MercuryParticipants9=function(l,m){__p&&__p();c("MercuryAssert").allParticipantIDs(l);var n=this.$MercuryParticipants3.executeOrEnqueue(l,m),o=this.$MercuryParticipants3.getUnavailableResources(n).filter(function(p){__p&&__p();var q=c("MercuryIDs").tokenize(p),r=q.type,s=q.value;if(r==="email"){this.$MercuryParticipants11(p,s);return false}if(r==="name"){this.$MercuryParticipants12(p,s);return false}return true}.bind(this));this.$MercuryParticipants4.fetchMulti(o);return this.$MercuryParticipants13(n)};j.prototype.$MercuryParticipants8=function(l){var m=this.$MercuryParticipants3.getResource(l);if(!m){var n=c("MercuryIDs").tokenize(l),o=n.type,p=n.value;if(o==="email")m=this.$MercuryParticipants11(l,p);if(o==="name")m=this.$MercuryParticipants12(l,p)}return m};j.prototype.$MercuryParticipants11=function(l,m){var n=new(c("ImmutableObject"))(k(l,m));this.$MercuryParticipants3.setResource(l,n);return n};j.prototype.$MercuryParticipants12=function(l,m){var n=new(c("ImmutableObject"))({gender:c("MercuryParticipantsConstants").UNKNOWN_GENDER,href:null,id:l,image_src:c("MercuryParticipantsConstants").EMAIL_IMAGE,big_image_src:c("MercuryParticipantsConstants").EMAIL_IMAGE,name:m,short_name:m,employee:false});this.$MercuryParticipants3.setResource(l,n);return n};j.prototype.$MercuryParticipants10=function(l){this.$MercuryParticipants2.emit(i,l)};j.prototype.$MercuryParticipants6=function(l){var m=l.map(function(n){return n.id});l=l.map(function(n){if(n.vanity)c("MercuryVanityIDMap.bs").set(n.vanity,n.id);var o=this.$MercuryParticipants3.getResource(n.id);return o?c("ImmutableObject").set(o,n):new(c("ImmutableObject"))(this.$MercuryParticipants14(n))}.bind(this));this.$MercuryParticipants3.addResourcesAndExecute(c("createObjectFrom")(m,l));this.$MercuryParticipants10(new Set(m))};j.prototype.$MercuryParticipants14=function(l){var m=l.type===c("MercuryParticipantTypes").USER||l.type===c("MercuryParticipantTypes").FRIEND;if(!m)return l;if(!l.name&&!l.href&&!l.vanity){var n=this.getDefaultName();l.name=n;l.short_name=n}return l};j.prototype.$MercuryParticipants13=function(l){return{remove:function(){this.$MercuryParticipants3.unsubscribe(l)}.bind(this)}};j.prototype.$MercuryParticipants7=function(){this.$MercuryParticipants3=new(c("KeyedCallbackManager"))()};j.prototype.getDefaultName=function(){return h._("Ng\u01b0\u1eddi d\u00f9ng Facebook")};function k(l,m){return{gender:c("MercuryParticipantsConstants").UNKNOWN_GENDER,href:null,id:l,image_src:c("MercuryParticipantsConstants").EMAIL_IMAGE,big_image_src:c("MercuryParticipantsConstants").EMAIL_IMAGE,name:m,short_name:m,employee:false,fbid:undefined,accepts_messenger_user_feedback:undefined,is_business_enabled:undefined,is_messenger_platform_bot:undefined,is_employee_away:undefined,is_friend:undefined,is_messenger_user:undefined,is_verified:undefined,type:undefined,vanity:undefined,timezone:undefined,personal_id:undefined,work_id:undefined}}f.exports=new j(c("CurrentUser").getID())}),null);
__d("MercurySendErrorLogger",["Banzai","BanzaiLogger"],(function a(b,c,d,e,f,g){var h=c("BanzaiLogger").create({retry:true}),i=c("Banzai").isEnabled("mercury_send_error_logging"),j={log:function k(l){if(!i)return;var m={message_id:l.message_id,timestamp_client:Date.now(),error_type:l.error_data.type,error_code:l.error_data.code,error_description:l.error_data.description,is_transient:l.error_data.is_transient};h.log("MercurySendErrorLoggerConfig",m)}};f.exports=j}),null);
__d("MercuryServerPayloadPreprocessor",["invariant","MessengerEnvironment","MercuryIDs","MercuryActionStatus","MercuryActionType","MercuryAttachment","MercuryDispatcher","MercurySendErrorLogger","MercurySingletonProvider","MercuryThreadIDMap","URI"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(k){this.$MercuryServerPayloadPreprocessor1=k;this.$MercuryServerPayloadPreprocessor2=c("MercuryThreadIDMap").getForFBID(this.$MercuryServerPayloadPreprocessor1);this.$MercuryServerPayloadPreprocessor3=c("MercuryDispatcher").getForFBID(this.$MercuryServerPayloadPreprocessor1)}i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};i.prototype.handleUpdate=function(k){__p&&__p();var l={};!k.from_client||h(0);(k.threads||[]).forEach(function(x){this.$MercuryServerPayloadPreprocessor4(x,l);var y=this.$MercuryServerPayloadPreprocessor2.getServerIDFromClientIDNow(x.thread_id);e(["MercuryServerRequests"],function(z){var A=z.getForFBID(this.$MercuryServerPayloadPreprocessor1);A.markThreadFetched(x.thread_id);if(y)A.markThreadFetched(y);A.updateLastActionTimestamp(x.timestamp)}.bind(this))}.bind(this));(k.work_top_named_threads||[]).forEach(function(x){this.$MercuryServerPayloadPreprocessor4(x,l);var y=this.$MercuryServerPayloadPreprocessor2.getServerIDFromClientIDNow(x.thread_id);e(["MercuryServerRequests"],function(z){var A=z.getForFBID(this.$MercuryServerPayloadPreprocessor1);A.markThreadFetched(x.thread_id);if(y)A.markThreadFetched(y);A.updateLastActionTimestamp(x.timestamp)}.bind(this))}.bind(this));(k.ordered_threadlists||[]).forEach(function(x){var y=x.thread_fbids||[];y=y.concat(x.other_user_fbids||[]);x.thread_ids=y.map(function(z){return this.$MercuryServerPayloadPreprocessor2.getClientIDFromServerIDNow(z.toString())}.bind(this))}.bind(this));if(k.delivery_receipts){var m={};for(var n=k.delivery_receipts,o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var q;if(o){if(p>=n.length)break;q=n[p++]}else{p=n.next();if(p.done)break;q=p.value}var r=q,s=r.other_user_fbid?c("MercuryIDs").getThreadIDFromUserID(r.other_user_fbid):this.$MercuryServerPayloadPreprocessor2.getClientIDFromServerIDNow(r.thread_fbid);if(s)m[s]=r.time}k.delivery_receipts=m}k.actions=k.actions||[];k.actions.forEach(function(x){__p&&__p();if(x.action_type===c("MercuryActionType").SEND_MESSAGE&&x.status===c("MercuryActionStatus").ERROR)c("MercurySendErrorLogger").log(x);var y=null,z=null;if(x.other_user_fbid){z=c("MercuryIDs").getThreadIDFromUserID(x.other_user_fbid);y=x.other_user_fbid}else if(x.thread_fbid){z=c("MercuryIDs").getThreadIDFromThreadFBID(x.thread_fbid);y=x.thread_fbid}else if(x.thread_id){z=c("MercuryIDs").getThreadIDFromThreadFBID(x.thread_id);y=x.thread_id}else if(x.status&&x.status!=c("MercuryActionStatus").SUCCESS&&x.client_thread_id)z=x.client_thread_id;else h(0);y=y&&y.toString();x.thread_id=this.$MercuryServerPayloadPreprocessor2.hasClientIDForServerID(y)?this.$MercuryServerPayloadPreprocessor2.getClientIDFromServerIDNow(y):z;if(x.action_type==c("MercuryActionType").SEND_MESSAGE&&x.client_thread_id&&y){x.thread_id=x.client_thread_id;this.$MercuryServerPayloadPreprocessor2.forceSetServerIDToClientID(y,x.client_thread_id);l[y]=x.client_thread_id}x.thread_id||h(0);if(!k.payload_source||!k.payload_source.startsWith("server"))e(["MercuryServerRequests"],function(A){A.getForFBID(this.$MercuryServerPayloadPreprocessor1).updateLastActionTimestamp(x.timestamp)}.bind(this))}.bind(this));this.$MercuryServerPayloadPreprocessor5(k);this.$MercuryServerPayloadPreprocessor6(k);if(k.end_of_history){var t=[];for(var u=0;u<k.end_of_history.length;u++){var v=k.end_of_history[u];if(v.type=="user")t.push("user:"+v.fbid);else if(v.type=="thread"&&this.$MercuryServerPayloadPreprocessor2.hasClientIDForServerID(v.fbid))t.push(this.$MercuryServerPayloadPreprocessor2.getClientIDFromServerIDNow(v.fbid))}k.end_of_history=t}if(k.roger){var w={};Object.keys(k.roger).forEach(function(x){__p&&__p();var y=Object.keys(k.roger[x]),z=void 0;if(x)z=this.$MercuryServerPayloadPreprocessor2.getClientIDFromServerIDNow(x);else if(y.length===1)z=c("MercuryIDs").getThreadIDFromUserID(y[0]);if(z){var A=k.roger[x];w[z]={};for(var B in A)if(Object.prototype.hasOwnProperty.call(A,B)){var C=c("MercuryIDs").getParticipantIDFromUserID(B);w[z][C]=A[B]}}}.bind(this));k.roger=w}k.newlyAddedClientIDs=l;k.preprocessed=true;this.$MercuryServerPayloadPreprocessor3.handleUpdate(k)};i.prototype.$MercuryServerPayloadPreprocessor4=function(k,l){__p&&__p();var m=k.other_user_fbid?k.other_user_fbid:k.thread_fbid;m||h(0);var n=this.$MercuryServerPayloadPreprocessor2.getClientIDFromServerIDNow(m);if(!n){n=k.other_user_fbid?c("MercuryIDs").getThreadIDFromUserID(k.other_user_fbid):c("MercuryIDs").getThreadIDFromThreadFBID(k.thread_fbid);this.$MercuryServerPayloadPreprocessor2.setServerIDToClientID(m,n);this.$MercuryServerPayloadPreprocessor2.setDeprecatedServerIDToClientID(k.thread_id,n);l[m]=n}k.thread_id=n};i.prototype.$MercuryServerPayloadPreprocessor5=function(k){__p&&__p();k.actions.forEach(function(l){if(l.action_type===c("MercuryActionType").USER_GENERATED_MESSAGE){l.attachments=l.attachments||[];l.attachments.forEach(function(m){if(c("MercuryAttachment").isShareAttachment(m)&&c("MessengerEnvironment").messengerui){var n=new(c("URI"))(m.share.uri);if(!n.getDomain())m.share.uri=n.setDomain("facebook.com").setSubdomain(c("URI").getRequestURI().getSubdomain()).setProtocol("https").toString()}})}})};i.prototype.$MercuryServerPayloadPreprocessor6=function(k){__p&&__p();k.actions.forEach(function(l){__p&&__p();if(l.action_type!==c("MercuryActionType").USER_GENERATED_MESSAGE)return;var m=l;if(!m.has_attachment||!m.attachments)return;for(var n=m.attachments.length-1;n>=0;n-=1){var o=m.attachments[n];if(!o.share||!o.share.style_list||o.share.style_list[0]!="genie_message")continue;if(o.share.target.genie_id)m.author=c("MercuryIDs").getParticipantIDFromUserID(o.share.target.genie_id);if(o.share.target&&!o.share.target.attachment){m.attachments.splice(n,1);m.has_attachment=m.attachments.length>0}}})};var j=new(c("MercurySingletonProvider"))(i);f.exports=i}),null);
__d("MercuryErrorType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SERVER:1,TRANSPORT:2,TIMEOUT:3})}),null);
__d("MercuryGlobalActionType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({MARK_ALL_READ:"mga-type:mark-all-read",MARK_ALL_SEEN:"mga-type:mark-all-seen"})}),null);
__d("MercuryServerSendMessageQueueOptions",[],(function a(b,c,d,e,f,g){function h(i,j,k,l,m,n){"use strict";this.success_handler=i;this.error_handler=j;this.transport_error_handler=k;this.timeout_handler=l;this.timeout=m;this.connection_retries=n}f.exports=h}),null);
__d("MercurySyncConstants",[],(function a(b,c,d,e,f,g){"use strict";var h=Object.freeze({ARBITER_EVENT_INVALID_STATE:"SYNC:INVALID_STATE",ARBITER_EVENT_INVALID_STATE_RETRY:"SYNC:INVALID_STATE_RETRY",ARBITER_EVENT_INVALID_STATE_RECOVER:"SYNC:INVALID_STATE_RECOVER",ARBITER_EVENT_SERVER_REQUESTS_FAIL:"NET:SERVER_REQUESTS_FAIL",ARBITER_EVENT_SERVER_REQUESTS_RECOVER:"NET:SERVER_REQUESTS_RECOVER"});f.exports=h}),null);
__d("MercurySyncDeltaHolder",["MercurySingletonProvider"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.$MercurySyncDeltaHolder2=new Map();this.$MercurySyncDeltaHolder3=[];this.$MercurySyncDeltaHolder1=0}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.peek=function(){this.$MercurySyncDeltaHolder3=this.$MercurySyncDeltaHolder3.sort(function(j,k){return j-k});return this.$MercurySyncDeltaHolder3[0]};h.prototype.getTop=function(){this.$MercurySyncDeltaHolder3=this.$MercurySyncDeltaHolder3.sort(function(j,k){return j-k});return this.$MercurySyncDeltaHolder3.reverse()[0]};h.prototype.pop=function(){this.$MercurySyncDeltaHolder3=this.$MercurySyncDeltaHolder3.sort(function(l,m){return l-m});if(this.$MercurySyncDeltaHolder3.length===0)return undefined;var j=this.$MercurySyncDeltaHolder3.shift(),k=this.$MercurySyncDeltaHolder2.get(j);this.$MercurySyncDeltaHolder2["delete"](j);return{seqID:j,delta:k}};h.prototype.push=function(j,k){if(this.$MercurySyncDeltaHolder2.has(j))return;this.$MercurySyncDeltaHolder2.set(j,k);this.$MercurySyncDeltaHolder3.push(j)};h.prototype.getLastSeqID=function(){return this.$MercurySyncDeltaHolder1};h.prototype.updateLastSeqID=function(j){this.$MercurySyncDeltaHolder1=j};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("XMercuryUnseenThreadIDsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/mercury/unseen_thread_ids/",{})}),null);
__d("XMessagingChangeMentionsMuteModeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/mercury/change_mentions_mute_thread/",{})}),null);
__d("XMessagingChangeReactionsMuteModeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/mercury/change_reactions_mute_thread/",{})}),null);
__d("MercuryServerRequests",["errorCode","invariant","Promise","Arbiter","AsyncResponse","BanzaiODS","ChannelConstants","ChatReliabilityInstrumentation","CurrentUser","FBJSON","EventProfiler","LogHistory","MercuryActionStatus","MercuryActionType","MercuryAPIArgsSource","MercuryAssert","MercuryConfig","MercuryDispatcher","MercuryErrorType","MercuryGlobalActionType","MercuryIDs","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySendErrorLogger","MercuryServerPayloadPreprocessor","MercuryServerRequestsConfig","MercuryServerSendMessageQueueRouter","MercuryServerURIs","MercurySingletonProvider","MercurySourceType","MercurySyncDeltaHolder","MercurySyncConstants","MercuryThreadIDMap","MercuryMessageIDs.bs","MessagingConfig","MessagingTag","MercuryServerSendMessageQueueOptions","MercuryServerDispatcher","XMercuryUnseenThreadIDsController","XMessagingChangeMentionsMuteModeController","XMessagingChangeReactionsMuteModeController","createObjectFrom","gkx","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("LogHistory").getInstance("mercury_server"),k=c("MercuryAPIArgsSource").MERCURY,l=30*1e3,m=true;function n(y){return y.getError()?"_"+y.getError():""}function o(y,z){__p&&__p();var A=babelHelpers["extends"]({},y),B=void 0;if(z.threads){if(!A.threads)A.threads={};for(B in z.threads)A.threads[B]=Object.keys(c("createObjectFrom")((A.threads[B]||[]).concat(z.threads[B]||[])))}if(z.messages){if(!A.messages)A.messages={};for(B in z.messages){if(!A.messages[B])A.messages[B]={};for(var C in z.messages[B])if(A.messages[B][C])A.messages[B][C]=s(A.messages[B][C],z.messages[B][C]);else A.messages[B][C]=z.messages[B][C]}}A.client=y.client||z.client;return A}function p(y,z){var A=Object.assign(c("createObjectFrom")(y.folders,true),c("createObjectFrom")(z.folders,true)),B=y.client||z.client;return{folders:Object.keys(A),client:B}}function q(y,z){for(var A in z)if(y[A]&&typeof y[A]==="object")y[A]=s(y[A],z[A]);else if(z[A]&&typeof z[A]==="object"){var B={};Object.assign(B,z[A]);y[A]=B}return y}function r(y,z){return z}function s(y,z){var A=y.offset<z.offset?y.offset:z.offset,B=y.offset+y.limit,C=z.offset+z.limit,D=B>C?B:C,E=D-A,F=y.timestamp>z.timestamp?y.timestamp:z.timestamp;return{offset:A,limit:E,timestamp:F}}function t(y,z){var A=y.client||z.client,B={ids:{},client:A};Object.assign(B.ids,y.ids,z.ids);return B}function u(y,z){__p&&__p();var A={},B=void 0,C=y.client||z.client;delete y.client;delete z.client;for(B in y)Object.assign(A,c("createObjectFrom")(y[B],B));for(B in z)Object.assign(A,c("createObjectFrom")(z[B],B));var D={client:C};for(var E in A){B=A[E];if(!D[B])D[B]=[];D[B].push(E)}return D}function v(y,z){var A=y.client||z.client,B=c("createObjectFrom")(y.ids,true),C=c("createObjectFrom")(z.ids,true),D=Object.assign(B,C);return{ids:Object.keys(D),client:A}}function w(y){__p&&__p();this.$MercuryServerRequests1=y;this.$MercuryServerRequests2=0;this.$MercuryServerRequests3={};this.$MercuryServerRequests4={};this.$MercuryServerRequests9=new Set();this.__threadIDMap=c("MercuryThreadIDMap").getForFBID(this.$MercuryServerRequests1);this.$MercuryServerRequests5=c("MercuryDispatcher").getForFBID(this.$MercuryServerRequests1);this.$MercuryServerRequests6=c("MercuryServerPayloadPreprocessor").getForFBID(this.$MercuryServerRequests1);this.$MercuryServerRequests7=new(c("MercuryServerSendMessageQueueOptions"))(function(z,A){this.__handleUpdate(z,A)}.bind(this),function(z){return this.$MercuryServerRequests10(z)}.bind(this),function(z){this.$MercuryServerRequests11(z)}.bind(this),function(z){return this.$MercuryServerRequests12(z)}.bind(this),c("MercuryServerRequestsConfig").sendMessageTimeout,c("MessagingConfig").SEND_CONNECTION_RETRIES);this.$MercuryServerRequests8=c("MercurySyncDeltaHolder").getForFBID(this.$MercuryServerRequests1);this.$MercuryServerRequests13()}w.getForFBID=function(y){return x.getForFBID(y)};w.get=function(){return x.get()};w.prototype.fetchThreadlistInfo=function(y,z){__p&&__p();var A=arguments.length<=2||arguments[2]===undefined?c("MessagingTag").INBOX:arguments[2],B=arguments[3],C=arguments.length<=4||arguments[4]===undefined?k:arguments[4],D=arguments[5];if(m){m=false;c("EventProfiler").tagCurrentActiveInteractionsAs("FirstMercuryThreadFetch")}var E=B?c("MercuryServerDispatcher").IMMEDIATE:null;if(c("MercuryConfig").MessengerInboxRequests&&!E)E=c("MercuryServerDispatcher").BATCH_DEFERRED_MULTI;var F={client:C};F[A]={offset:y,limit:z,filter:B,before:D};this.__sendRequest(c("MercuryServerURIs").THREADLIST_INFO,F,E)};w.prototype.fetchUnseenThreadIDs=function(){var y=arguments.length<=0||arguments[0]===undefined?c("MessagingTag").INBOX:arguments[0],z=arguments.length<=1||arguments[1]===undefined?k:arguments[1];this.__sendRequest(c("XMercuryUnseenThreadIDsController").getURIBuilder().getURI().toString(),{})};w.prototype.fetchUnreadThreadIDs=function(y){var z=arguments.length<=1||arguments[1]===undefined?k:arguments[1];this.__sendRequest(c("MercuryServerURIs").UNREAD_THREADS,{folders:[y],client:z})};w.prototype.fetchThreadData=function(y){__p&&__p();var z=arguments.length<=1||arguments[1]===undefined?k:arguments[1];c("MercuryAssert").allThreadID(y);var A={threads:{},client:z},B=[],C=[];y.forEach(function(E){__p&&__p();if(this.$MercuryServerRequests3[E])return;this.$MercuryServerRequests3[E]=true;var F=this.__threadIDMap.getServerIDFromClientIDNow(E),G=c("MercuryIDs").tokenize(E);if(G.type=="user"){B.push(G.value);A.threads.user_ids=B}else if(G.type=="thread"){if(F)C.push(F);else C.push(G.value);A.threads.thread_fbids=C}else if(G.type=="root"){if(F){C.push(F);A.threads.thread_fbids=C}}else if(G.type!="pending")throw new Error("Unknown thread type",G)}.bind(this));this.$MercuryServerRequests5.inform("fetch-thread-data",A);if(A.threads.user_ids)A.threads.user_ids.forEach(function(E){if(!E){j.error("empty user id",JSON.stringify(B));c("ChatReliabilityInstrumentation").logERROR("Invalid user ID sent to thread_info.php: "+JSON.stringify(B))}});if(A.threads.thread_fbids)A.threads.thread_fbids.forEach(function(E){if(!E)c("ChatReliabilityInstrumentation").logERROR("Invalid FBID sent to thread_info.php: "+JSON.stringify(y))});for(var D in A.threads){this.__sendRequest(c("MercuryServerURIs").THREAD_INFO,A);break}};w.prototype.ensureThreadIsFetched=function(y){__p&&__p();var z=arguments.length<=1||arguments[1]===undefined?k:arguments[1];if(!this.__threadIDMap.getClientIDFromServerIDNow(y)&&!this.$MercuryServerRequests3[y]){if(!y){c("ChatReliabilityInstrumentation").logERROR("Ensure invalid FBID sent to thread_info.php");j.error("attempting to fetch empty thread_fbid. Bad idea!");return}this.$MercuryServerRequests3[y]=true;this.__sendRequest(c("MercuryServerURIs").THREAD_INFO,{threads:{thread_fbids:[y]},client:z})}};w.prototype.fetchThreadMessages=function(y,z,A,B,C){__p&&__p();var D=arguments.length<=5||arguments[5]===undefined?k:arguments[5];c("MercuryAssert").isThreadID(y);var E=void 0,F=void 0,G=c("MercuryIDs").tokenize(y),H=this.__threadIDMap.getServerIDFromClientIDNow(y),I=false;if(H){E=H;F=G.type=="user"?"user_ids":"thread_fbids"}else{E=G.value;switch(G.type){case"user":F="user_ids";I=true;break;case"thread":F="thread_fbids";break}}var J={messages:{},threads:{},client:D};if(F){J.messages[F]={};J.messages[F][E]={offset:z,timestamp:B,limit:A};if(I)J.threads[F]=[E];this.__sendRequest(c("MercuryServerURIs").THREAD_INFO,J,C)}else this.__threadIDMap.getServerIDFromClientID(y,function(K){J.messages.thread_fbids={};J.messages.thread_fbids[K]={offset:z,timestamp:B,limit:A};this.__sendRequest(c("MercuryServerURIs").THREAD_INFO,J,C)}.bind(this))};w.prototype.handleThreadInfoError=function(y,z){__p&&__p();var A,B=this,C=y.getData(),D=[];if(C.messages){for(var E in C.messages.thread_fbids){var F=this.__threadIDMap.getClientIDFromServerIDNow(E);if(F)D.push(this.$MercuryServerRequests14(F))}for(var G in C.messages.user_ids)D.push(this.$MercuryServerRequests14("user:"+G));for(var H in C.messages.group_ids)D.push(this.$MercuryServerRequests14("group:"+H))}if(D.length)this.$MercuryServerRequests5.handleUpdate({actions:D,from_client:true,payload_source:c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});if(C.threads&&(C.threads.user_ids||C.threads.thread_fbids||C.threads.group_ids||C.threads.thread_ids)){var I=5,J=true;if(!C.retry_count){C.retry_count=0;if(C.messages)delete C.messages}else if(C.retry_count>=I&&(!z||!c("gkx")("AT6272W7G37c2zZOpPDUPGXaehXUPvo7_ZqAqdSAoKzgP5DQ8Luz0w5hQkLZeaPa8UmuuAXTSUI8FctXnbHnbKTw"))){J=false;(C.threads.thread_ids||[]).concat(C.threads.thread_fbids||[]).forEach(function(L){if(L in this.$MercuryServerRequests3)delete this.$MercuryServerRequests3[L]},this)}[].concat(C.threads.thread_ids||[],C.threads.thread_fbids||[],C.threads.user_ids||[],C.threads.group_ids||[]).forEach(function(L){if(L)this.$MercuryServerRequests9.add(L);else c("ChatReliabilityInstrumentation").logERROR("lost a thread id somehow")}.bind(this));if(J){var K=Math.pow(2,Math.min(C.retry_count,I))*1e3;c("setTimeoutAcrossTransitions")(function(){j.log("retry_thread","{}");this.__sendRequest(c("MercuryServerURIs").THREAD_INFO,C)}.bind(this),K);C.retry_count++}if(this.$MercuryServerRequests9.size)(function(){var L=[];B.$MercuryServerRequests9.forEach(function(M){return L.push(M)});j.debug("failed threads",JSON.stringify(L));c("Arbiter").inform(c("MercurySyncConstants").ARBITER_EVENT_SERVER_REQUESTS_FAIL,L)})()}};w.prototype.markFolderAsRead=function(y){this.__sendRequest(c("MercuryServerURIs").MARK_FOLDER_READ,{folder:y});var z=[{action_type:c("MercuryGlobalActionType").MARK_ALL_READ,folder:y}];this.$MercuryServerRequests5.handleUpdate({global_actions:z,from_client:true,payload_source:c("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS})};w.prototype.changeThreadReadStatus=function(y,z,A,B,C,D){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(E){var F,G={ids:(F={},F[E]=z,F),source:A,watermarkTimestamp:B,shouldSendReadReceipt:C,commerce_last_message_type:D};j.log("initiate_change_read_status",JSON.stringify({thread_id:y,thread_fbid:E,mark_as_read:z,watermarkTimestamp:B}));this.__sendRequest(c("MercuryServerURIs").CHANGE_READ_STATUS,G)}.bind(this))};w.prototype.changeThreadArchivedStatus=function(y,z,A){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(B){var C={ids:{},source:A};C.ids[B]=z;this.__sendRequest(c("MercuryServerURIs").CHANGE_ARCHIVED_STATUS,C)}.bind(this))};w.prototype.changeThreadPageFollowUpStatus=function(y,z,A){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(B){var C={ids:{},source:A};C.ids[B]=z;this.__sendRequest(c("MercuryServerURIs").CHANGE_PAGE_FOLLOW_UP_STATUS,C)}.bind(this))};w.prototype.changeThreadFolder=function(y,z){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(A){var B={};B[z]=[A];this.__sendRequest(c("MercuryServerURIs").MOVE_THREAD,B)}.bind(this))};w.prototype.changeMutingOnThread=function(y,z){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(A){this.__sendRequest(c("MercuryServerURIs").CHANGE_MUTE_THREAD,{thread_fbid:A,mute_settings:z,payload_source:k})}.bind(this))};w.prototype.changeMentionsMutingOnThread=function(y,z){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(A){this.__sendRequest(c("XMessagingChangeMentionsMuteModeController").getURIBuilder().getURI(),{thread_fbid:A,mentions_mute_mode:z,payload_source:k})}.bind(this))};w.prototype.changeReactionsMutingOnThread=function(y,z){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(A){this.__sendRequest(c("XMessagingChangeReactionsMuteModeController").getURIBuilder().getURI(),{thread_fbid:A,reactions_mute_mode:z,payload_source:k})}.bind(this))};w.prototype.markThreadSpam=function(y,z){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(A){this.__sendRequest(c("MercuryServerURIs").MARK_SPAM,{id:A,source:z})}.bind(this))};w.prototype.unmarkThreadSpam=function(y,z){c("MercuryAssert").isThreadID(y);this.__threadIDMap.getServerIDFromClientID(y,function(A){this.__sendRequest(c("MercuryServerURIs").UNMARK_SPAM,{id:A,source:z})}.bind(this))};w.prototype.deleteThread=function(y,z){this.deleteThreads([y],z)};w.prototype.deleteThreads=function(y,z){c("Promise").all(y.map(function(A){c("MercuryAssert").isThreadID(A);return new(c("Promise"))(function(B){return this.__threadIDMap.getServerIDFromClientID(A,B)}.bind(this))}.bind(this))).then(function(A){this.__sendRequest(c("MercuryServerURIs").DELETE_THREAD,{ids:A,source:z})}.bind(this)).done()};w.prototype.deleteMessages=function(y,z){c("MercuryMessageIDs.bs").getServerIDs(z||[],function(A){this.__sendRequest(c("MercuryServerURIs").DELETE_MESSAGES,{message_ids:A})}.bind(this))};w.prototype.sendDeliveryReceipts=function(y,z){c("MercuryMessageIDs.bs").getServerIDs(y||[],function(A){this.__sendRequest(c("MercuryServerURIs").DELIVERY_RECEIPTS,{message_ids:A,thread_ids:z})}.bind(this))};w.prototype.sendNewMessage=function(y){__p&&__p();var z=arguments.length<=1||arguments[1]===undefined?k:arguments[1];if(!y.offline_threading_id)c("BanzaiODS").bumpEntityKey("chat.web","missing_otid_on_send");if(y.client_state&&y.client_state!==c("MercuryMessageClientState").SEND_TO_SERVER)return;var A=c("MercuryIDs").tokenize(y.thread_id),B=A.type,C=babelHelpers["extends"]({},y);C.thread_id=null;if(B=="user"){C.other_user_fbid=A.value;this.$MercuryServerRequests15(C,z)}else if(B=="thread"){C.thread_fbid=A.value;this.$MercuryServerRequests15(C,z)}else if(B=="root"&&A.value==C.offline_threading_id){C.client_thread_id=y.thread_id;this.$MercuryServerRequests15(C,z)}else{c("MercuryIDs").isLocalThread(y.thread_id)||i(0);this.__threadIDMap.getServerIDFromClientID(y.thread_id,function(D){C.thread_fbid=D;this.$MercuryServerRequests15(C,z)}.bind(this))}c("ChatReliabilityInstrumentation").logMESSAGE_SEND_START(c("FBJSON").stringify({otid:C.offline_threading_id,message_id:C.message_id,other_user_fbid:C.other_user_fbid,viewer_page_fbid:!C.creator_info?null:C.creator_info.pageID}))};w.prototype.$MercuryServerRequests15=function(y,z){c("Arbiter").inform(c("ChannelConstants").ATTEMPT_RECONNECT);this.$MercuryServerRequests4[y.message_id]=Date.now();c("MercuryServerSendMessageQueueRouter").getForFBID(this.$MercuryServerRequests1).enqueue(y.other_user_fbid||y.thread_fbid||y.client_thread_id,this.$MercuryServerRequests7,z,y)};w.prototype.__getSendMessageQueueOptions=function(){return this.$MercuryServerRequests7};w.prototype.markSeen=function(){var y=this.$MercuryServerRequests2;this.__sendRequest(c("MercuryServerURIs").MARK_SEEN,{seen_timestamp:y})};w.prototype.$MercuryServerRequests16=function(y,z,A,B){__p&&__p();var C=y.getData(),D=C.message_batch||[C];j.debug("handle_send_message_error_common",JSON.stringify({reliability_error_status:A,request_error_status:z,error_data:B,message_list:D}));var E=D.map(function(G){var H={action_type:c("MercuryActionType").SEND_MESSAGE,other_user_fbid:G.other_user_fbid,thread_fbid:G.thread_fbid,client_message_id:G.message_id,message_id:G.message_id,client_thread_id:G.client_thread_id,status:z,error_data:B};return H});E.forEach(function(G){if(G.action_type===c("MercuryActionType").SEND_MESSAGE&&G.status===c("MercuryActionStatus").ERROR)this.__logMercurySendError(G)},this);var F={actions:E,payload_source:c("MercuryPayloadSource").CLIENT_HANDLE_ERROR};this.$MercuryServerRequests6.handleUpdate(F)};w.prototype.handleSendMessageError=function(y){__p&&__p();var z=y.getPayload(),A=null,B=null;if(z&&z.error_payload){A=c("MercuryActionStatus").UNCONFIRMED;B="send_error"}else{A=c("MercuryActionStatus").ERROR;B="request_error"+n(y)}var C=y.error;if(C===1404102)c("AsyncResponse").verboseErrorHandler(y);var D=/<.*>/.test(y.getErrorDescription())?y.getErrorSummary():y.getErrorDescription();this.$MercuryServerRequests16(y.getRequest(),A,B,{type:c("MercuryErrorType").SERVER,code:y.getError(),description:D,is_transient:y.isTransient()})};w.prototype.handleSendMessageTransportError=function(y){this.$MercuryServerRequests16(y.getRequest(),c("MercuryActionStatus").ERROR,"transport_error"+n(y),{type:c("MercuryErrorType").TRANSPORT,code:y.getError(),is_transient:true})};w.prototype.handleSendMessageTimeout=function(y){this.$MercuryServerRequests16(y,c("MercuryActionStatus").ERROR,"transport_timeout",{type:c("MercuryErrorType").TIMEOUT,is_transient:true})};w.prototype.getLastActionTimestamp=function(){return this.$MercuryServerRequests2};w.prototype.__logMercurySendError=function(y){c("MercurySendErrorLogger").log(y)};w.prototype.updateLastActionTimestamp=function(y){var z=Date.now()-1e3*60*60*24;if(y&&y>z)this.$MercuryServerRequests2=Math.max(this.$MercuryServerRequests2,y)};w.prototype.markThreadFetched=function(y){delete this.$MercuryServerRequests3[y];if(this.$MercuryServerRequests9["delete"](y)&&!this.$MercuryServerRequests9.size){j.debug("no_failed_threads","{}");c("Arbiter").inform(c("MercurySyncConstants").ARBITER_EVENT_SERVER_REQUESTS_RECOVER)}};w.prototype.$MercuryServerRequests14=function(y){return{action_type:c("MercuryActionType").LOG_MESSAGE,thread_id:y,message_id:y,timestamp:Date.now(),is_unread:false,source:c("MercurySourceType").UNKNOWN,log_message_body:"",log_message_type:c("MercuryLogMessageType").SERVER_ERROR,log_message_data:{}}};w.prototype.__getForAsyncRequest=function(y){var z=y.getData(),A=z.request_user_id?z.request_user_id:c("CurrentUser").getID();return w.getForFBID(A)};w.prototype.__handleUpdate=function(y,z){this.__getForAsyncRequest(z).$MercuryServerRequests6.handleUpdate(y)};w.prototype.$MercuryServerRequests17=function(y){var z=this.__getForAsyncRequest(y);z.handleThreadInfoError(y)};w.prototype.$MercuryServerRequests18=function(y){var z=this.__getForAsyncRequest(y);z.handleThreadInfoError(y,true)};w.prototype.$MercuryServerRequests10=function(y){var z=this.__getForAsyncRequest(y.getRequest());z.handleSendMessageError(y)};w.prototype.$MercuryServerRequests11=function(y){var z=this.__getForAsyncRequest(y.getRequest());z.handleSendMessageTransportError(y)};w.prototype.$MercuryServerRequests12=function(y){var z=this.__getForAsyncRequest(y);z.handleSendMessageTimeout(y)};w.prototype.$MercuryServerRequests13=function(){__p&&__p();var y,z=null;if(c("MercuryServerRequestsConfig").msgrRegion)z={name:"X-MSGR-Region",value:c("MercuryServerRequestsConfig").msgrRegion};var A=(y={},y[c("MercuryServerURIs").THREAD_INFO]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_DEFERRED_MULTI,customHeader:z,batch_function:o,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this),error_handler:function(E){return this.$MercuryServerRequests17(E.getRequest())}.bind(this),timeout_handler:function(E){return this.$MercuryServerRequests18(E)}.bind(this),timeout:l},y[c("MercuryServerURIs").MARK_FOLDER_READ]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").CHANGE_READ_STATUS]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){this.__handleUpdate(E,F);var G=(E.threads||[]).map(function(H){return H&&H.thread_id});j.log("response_change_read_status",JSON.stringify({threads:G}))}.bind(this)},y[c("MercuryServerURIs").MARK_SEEN]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:z,batch_function:r,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").THREADLIST_INFO]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE_UNIQUE,customHeader:z,batch_function:q,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").MARK_SPAM]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").UNMARK_SPAM]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").UNREAD_THREADS]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE_UNIQUE,customHeader:z,batch_function:p,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").CHANGE_ARCHIVED_STATUS]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:z,batch_function:t,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").CHANGE_PAGE_FOLLOW_UP_STATUS]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:z,batch_function:t,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").DELETE_THREAD]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:z,batch_function:v,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").DELETE_MESSAGES]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").DELIVERY_RECEIPTS]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").MOVE_THREAD]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:z,batch_function:u,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y[c("MercuryServerURIs").CHANGE_MUTE_THREAD]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)},y),B=c("XMercuryUnseenThreadIDsController").getURIBuilder().getURI().toString();A[B]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)};var C=c("XMessagingChangeMentionsMuteModeController").getURIBuilder().getURI().toString();A[C]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)};var D=c("XMessagingChangeReactionsMuteModeController").getURIBuilder().getURI().toString();A[D]={request_user_id:this.$MercuryServerRequests1,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:z,handler:function(E,F){return this.__handleUpdate(E,F)}.bind(this)};c("MercuryServerDispatcher").registerEndpoints(A)};w.prototype.__sendRequest=function(y,z,A){if(this.$MercuryServerRequests8)switch(y){case c("MercuryServerURIs").THREADLIST_INFO:case c("MercuryServerURIs").THREAD_INFO:z.cachius_min_seq_id=this.$MercuryServerRequests8.getLastSeqID();break;default:break}c("MercuryServerDispatcher").trySend(y,z,A,this.$MercuryServerRequests1)};w.prototype.__getFBID=function(){return this.$MercuryServerRequests1};var x=new(c("MercurySingletonProvider"))(w);f.exports=w}),null);
__d("MercuryThreadIDMap",["KeyedCallbackManager","MercuryAssert","MercuryIDs","MercurySingletonProvider"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){this.$MercuryThreadIDMap1=j;this.$MercuryThreadIDMap2=new(c("KeyedCallbackManager"))();this.$MercuryThreadIDMap3=new(c("KeyedCallbackManager"))()}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.setServerIDToClientID=function(j,k){var l=this.getClientIDFromServerIDNow(j);if(l){l!==k;return}this.forceSetServerIDToClientID(j,k)};h.prototype.forceSetServerIDToClientID=function(j,k){this.$MercuryThreadIDMap2.setResource(j,k);this.$MercuryThreadIDMap3.setResource(k,j)};h.prototype.setDeprecatedServerIDToClientID=function(j,k){if(j)this.$MercuryThreadIDMap2.setResource(j,k)};h.prototype.getClientIDFromServerIDNow=function(j){return this.$MercuryThreadIDMap2.getResource(j)};h.prototype.getClientIDFromServerID=function(j,k){this.$MercuryThreadIDMap2.executeOrEnqueue(j,k);e(["MercuryServerRequests"],function(l){l.getForFBID(this.$MercuryThreadIDMap1).ensureThreadIsFetched(j)}.bind(this))};h.prototype.getServerIDFromClientIDNow=function(j){return this.$MercuryThreadIDMap3.getResource(j)};h.prototype.getServerIDFromClientID=function(j,k){c("MercuryAssert").isThreadID(j);var l=this.$MercuryThreadIDMap3.executeOrEnqueue(j,k);e(["MercuryServerRequests"],function(m){var n=this.$MercuryThreadIDMap3.getUnavailableResources(l),o=c("MercuryIDs").tokenize(j);if(n.length&&o.type!="root")m.getForFBID(this.$MercuryThreadIDMap1).fetchThreadData(n)}.bind(this))};h.prototype.hasClientIDForServerID=function(j){return!!this.getClientIDFromServerIDNow(j)};h.prototype.convertThreadIDIfAvailable=function(j){var k=this.getClientIDFromServerIDNow(j);return k||j};h.prototype.canLinkExternally=function(j){c("MercuryAssert").isThreadID(j);var k=c("MercuryIDs").tokenize(j);return k.type=="user"||!!this.getServerIDFromClientIDNow(j)};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("MercuryDisplayTimeFilterMessageRenderer",["fbt"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i={renderFilteredContent:function j(k){if(k.is_filtered_content_bh)return h._("Tin nh\u1eafn n\u00e0y \u0111\u00e3 b\u1ecb x\u00f3a v\u00ec ch\u1ee9a li\u00ean k\u1ebft b\u1ecb ch\u1eb7n ho\u1eb7c c\u00f3 h\u1ea1i.");if(k.is_filtered_content_account)return h._("Tin nh\u1eafn n\u00e0y \u0111\u00e3 t\u1ea1m th\u1eddi b\u1ecb x\u00f3a v\u00ec t\u00e0i kho\u1ea3n c\u1ee7a ng\u01b0\u1eddi g\u1eedi c\u1ea7n ph\u1ea3i \u0111\u01b0\u1ee3c x\u00e1c minh.");if(k.is_filtered_content_quasar)return h._("Tin nh\u1eafn n\u00e0y \u0111\u00e3 b\u1ecb x\u00f3a v\u00ec c\u00f3 ch\u1ee9a n\u1ed9i dung b\u1ecb ch\u1eb7n ho\u1eb7c c\u00f3 h\u1ea1i.");if(k.is_filtered_content_invalid_app)return h._("Tin nh\u1eafn n\u00e0y \u0111\u00e3 b\u1ecb x\u00f3a v\u00ec \u1ee9ng d\u1ee5ng g\u1eedi tin nh\u1eafn b\u1ecb ch\u1eb7n g\u1eedi tin.");return h._("Tin nh\u1eafn n\u00e0y \u0111\u00e3 t\u1ea1m th\u1eddi b\u1ecb x\u00f3a v\u00ec t\u00e0i kho\u1ea3n c\u1ee7a ng\u01b0\u1eddi g\u1eedi c\u1ea7n \u0111\u01b0\u1ee3c x\u00e1c minh ho\u1eb7c t\u00e0i kho\u1ea3n \u0111\u00f3 \u0111\u00e3 b\u1ecb x\u00e1c \u0111\u1ecbnh l\u00e0 l\u1ea1m d\u1ee5ng.")}};f.exports=i}),null);
__d("MercuryGiftSnippetRenderer",["fbt"],(function a(b,c,d,e,f,g,h){"use strict";var i={renderText:function j(k,l){return k?h._("B\u1ea1n \u0111\u00e3 g\u1eedi m\u1ed9t tin nh\u1eafn valentine."):h._("{name} \u0111\u00e3 g\u1eedi m\u1ed9t tin nh\u1eafn valentine.",[h._param("name",l)])}};f.exports=i}),null);
__d("MercurySyncDeltaTypes",[],(function a(b,c,d,e,f,g){"use strict";var h={AdminAddedToGroupThread:"AdminAddedToGroupThread",AdminRemovedFromGroupThread:"AdminRemovedFromGroupThread",AdminTextMessage:"AdminTextMessage",ChangeViewerStatus:"ChangeViewerStatus",DeliveryReceipt:"DeliveryReceipt",ForcedFetch:"ForcedFetch",MarkRead:"MarkRead",MarkUnread:"MarkUnread",MarkFolderSeen:"MarkFolderSeen",MessageDelete:"MessageDelete",NewMessage:"NewMessage",NoOp:"NoOp",PagesManagerEvent:"PagesManagerEvent",ParticipantLeftGroupThread:"ParticipantLeftGroupThread",ParticipantsAddedToGroupThread:"ParticipantsAddedToGroupThread",ReadReceipt:"ReadReceipt",ReplaceMessage:"ReplaceMessage",RTCEventLog:"RTCEventLog",ThreadAction:"ThreadAction",ThreadDelete:"ThreadDelete",ThreadFolder:"ThreadFolder",ThreadMuteSettings:"ThreadMuteSettings",ThreadName:"ThreadName",JoinableMode:"JoinableMode",ApprovalMode:"ApprovalMode",ApprovalQueue:"ApprovalQueue",ClientPayload:"ClientPayload",GenieMessage:"GenieMessage",MontageMessage:"MontageMessage",RtcCallData:"RtcCallData"};f.exports=h}),null);
__d("MercurySyncFakeDFFSender",["Arbiter","ChannelConstants","MercurySingletonProvider","MercurySyncDeltaTypes"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("ChannelConstants").getArbiterType(c("ChannelConstants").FAKE_DFF);i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){this.$MercurySyncFakeDFFSender1=k}i.prototype.sendGlobalDFF=function(){c("Arbiter").inform(h,{obj:{delta:{"class":c("MercurySyncDeltaTypes").ForcedFetch},queue:this.$MercurySyncFakeDFFSender1}})};i.prototype.sendThreadDFF=function(k,l){c("Arbiter").inform(h,{obj:{delta:{"class":c("MercurySyncDeltaTypes").ForcedFetch,threadKey:{otherUserFbId:k,threadFbId:l}},queue:this.$MercurySyncFakeDFFSender1}})};i.prototype.sendMessageDFF=function(k,l,m){c("Arbiter").inform(h,{obj:{delta:{"class":c("MercurySyncDeltaTypes").ForcedFetch,threadKey:{otherUserFbId:k,threadFbId:l},messageId:m},queue:this.$MercurySyncFakeDFFSender1}})};var j=new(c("MercurySingletonProvider"))(i);f.exports=i}),null);
__d("MessengerThreadCannotReplyReason",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({BLOCKED:"blocked",COMPOSER_DISABLED_BOT:"composer_disabled_bot",HAS_EMAIL_PARTICIPANT:"has_email_participant",OBJECT_ORIGINATED:"object_originated",READ_ONLY:"read_only",VIEWER_NOT_SUBSCRIBED:"viewer_not_subscribed",RECIPIENTS_NOT_LOADABLE:"recipients_not_loadable",RECIPIENTS_UNAVAILABLE:"recipients_unavailable",RECIPIENTS_INVALID:"recipients_invalid",RECIPIENTS_INACTIVE_WORK_ACC:"recipients_inactive_work_account",MONTAGE_NOT_AUTHOR:"montage_not_author"})}),null);
__d("MercuryThreadInfo",["MercuryIDs","MessengerThreadCannotReplyReason"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={canReply:function j(k){return!!(k.is_subscribed&&(k.can_reply===undefined||k.can_reply)&&!k.has_email_participant&&!k.read_only)},getMuteSetting:function j(k){return!k.mute_until?undefined:k.mute_until},isEmptyLocalThread:function j(k){return c("MercuryIDs").tokenize(k.thread_id).type==="root"&&!k.timestamp},isMuted:function j(k){return h.getMuteSetting(k)!==undefined},areMentionsMuted:function j(k){return k.mentions_mute_mode===1},areReactionsMuted:function j(k){return k.reactions_mute_mode===1},isNewEmptyLocalThread:function j(k){return!!(h.isEmptyLocalThread(k)&&k.participants&&k.participants.length===0)},showComposer:function j(k){return!!(k.is_subscribed&&(k.can_reply||!k.cannot_reply_reason||k.cannot_reply_reason===c("MessengerThreadCannotReplyReason").BLOCKED)&&!k.has_email_participant&&!k.read_only)},isColdOpen:function j(k){return!!(k.is_canonical_user&&(k.message_count===0||!k.timestamp))}};function i(j){return j+"@facebook.com"}f.exports=h}),null);
__d("MessagingGenericAdminTextType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ALOHA_AUTOCONNECT_INVITED:"aloha_autoconnect_invited",ALOHA_CONTACT_ADDED:"aloha_contact_added",ALOHA_CONTACT_ADDED_TO_ALOHA_PROXY_USER:"aloha_contact_added_to_aloha_proxy_user",ALOHA_CONTACT_REMOVED:"aloha_contact_removed",ALOHA_INVITE_OWNER_ACCEPT:"aloha_invite_owner_accept",ALOHA_INVITE_OWNER_DECLINE:"aloha_invite_owner_decline",ALOHA_MEDIA_ADDED:"aloha_media_added",ALOHA_MEDIA_SENT:"aloha_media_sent",ALOHA_VISUAL_MEDIA_SENT:"aloha_visual_media_sent",ALOHA_OWNER_INVITED:"aloha_owner_invited",ALOHA_PROXY_USER_NAME_SET:"aloha_proxy_user_name_set",ALOHA_PROXY_USER_PROFILE_PHOTO_SET:"aloha_proxy_user_profile_photo_set",ALOHA_WIFI_CREDENTIALS_SET:"aloha_wifi_credentials_set",MADE_POLL_VOTE:"made_poll_vote",ALOHA_USER_JOINED_CALL_ON_ALOHA:"aloha_user_joined_call_on_aloha",ALOHA_CALL_ENDED_ON_ALOHA:"aloha_call_ended_on_aloha",GROUP_POLL:"group_poll",GENERIC_NEW_CONNECTION:"generic_new_connection",CONFIRM_FRIEND_REQUEST:"confirm_friend_request",THREAD_CUSTOMIZATION_UPSELL:"thread_customization_upsell",PHONE_CONTACT_UPLOAD:"phone_contact_upload",RELATIONSHIP_CREATED:"relationship_created",ACCEPT_PENDING_THREAD:"accept_pending_thread",RAMP_UP_WELCOME_MESSAGE:"ramp_up_welcome_message",CHANGE_THREAD_THEME:"change_thread_theme",CHANGE_THREAD_ICON:"change_thread_icon",GROUP_THREAD_CREATED:"group_thread_created",THREAD_EPHEMERAL_SEND_MODE:"thread_ephemeral_send_mode",INVITE_ACCEPTED:"invite_accepted",MESSENGER_INVITE_SENT:"messenger_invite_sent",TURN_ON_PUSH:"turn_on_push",JOURNEY_PROMPT_COLOR:"journey_prompt_color",JOURNEY_PROMPT_LIKE:"journey_prompt_like",JOURNEY_PROMPT_NICKNAME:"journey_prompt_nickname",JOURNEY_PROMPT_SETUP:"journey_prompt_setup",CHANGE_THREAD_NICKNAME:"change_thread_nickname",NOTIFY_GROUP_MAYORSHIP:"notify_group_mayorship",PROMPT_GROUP_MAYORSHIP_CUSTOMIZATION:"prompt_group_mayorship_customization",MESSAGE_COUNT_MILESTONE_MESSAGE:"message_count_milestone_message",BOT_THREAD_SUBSCRIPTION:"bot_thread_subscription",RTC_CALL_LOG:"rtc_call_log",RTC_INSTANT_VIDEO_LIFECYCLE:"rtc_instant_video_lifecycle",JOURNEY_PROMPT_BOT:"journey_prompt_bot",RIDE_ORDERED_MESSAGE:"ride_ordered_message",DESTINATION_ETA_MESSAGE:"destination_eta_message",RIDE_ARRIVED_MESSAGE:"ride_arrived_message",JOURNEY_PROMPT_NEW_SETUP:"journey_prompt_new_setup",LIGHTWEIGHT_EVENT_CREATE:"lightweight_event_create",LIGHTWEIGHT_EVENT_DELETE:"lightweight_event_delete",LIGHTWEIGHT_EVENT_NOTIFY:"lightweight_event_notify",LIGHTWEIGHT_EVENT_NOTIFY_BEFORE_EVENT:"lightweight_event_notify_before_event",LIGHTWEIGHT_EVENT_RSVP:"lightweight_event_rsvp",LIGHTWEIGHT_EVENT_UPDATE:"lightweight_event_update",LIGHTWEIGHT_EVENT_UPDATE_LOCATION:"lightweight_event_update_location",LIGHTWEIGHT_EVENT_UPDATE_TIME:"lightweight_event_update_time",LIGHTWEIGHT_EVENT_UPDATE_TITLE:"lightweight_event_update_title",SAFETY_LOCATION_REQUEST_SENT:"safety_location_request_sent",SAFETY_LOCATION_REQUEST_RESPONDED:"safety_location_request_responded",SAFETY_LOCATION_REQUEST_DENIED:"safety_location_request_denied",AD_MANAGE_MESSAGE:"ad_manage_message",AD_REPLY_MESSAGE:"ad_reply_message",TAGGED_PHOTO:"tagged_photo",GAME_SCORE:"game_score",INSTANT_GAME_UPDATE:"instant_game_update",INSTANT_GAME_BOT_INTRO:"instant_game_bot_intro",MEDIA_SUBSCRIPTION_MANAGE:"media_subscription_manage",M_AI_SURVEY:"m_ai_survey",PHONE_NUMBER_LOOKUP_NOTICE:"phone_number_lookup_notice",MESSENGER_PRECHECKED_PLUGIN:"messenger_prechecked_plugin",ADD_CONTACT:"add_contact",PRODUCT_INVOICE_RECEIPT_REJECTED:"product_invoice_receipt_rejected",PRODUCT_INVOICE_PAID:"product_invoice_paid",PRODUCT_INVOICE_VOIDED:"product_invoice_voided",PRODUCT_INVOICE_SHIPPED:"product_invoice_shipped",PRODUCT_INVOICE_PAYMENT_EXPIRED:"product_invoice_payment_expired",PRODUCT_INVOICE_RECEIPT_UPLOADED:"product_invoice_receipt_uploaded",CHANGE_JOINABLE_SETTING:"change_joinable_setting",CHANGE_THREAD_ADMINS:"change_thread_admins",CHANGE_THREAD_APPROVAL_MODE:"change_thread_approval_mode",CAPY_SESSION_BEGIN:"capy_session_begin",CAPY_SESSION_BOT_BEGIN:"capy_session_bot_begin",CAPY_SESSION_END:"capy_session_end",CAPY_AGENT_JOIN:"capy_agent_join",CAPY_AGENT_DUMPED:"capy_agent_dumped",CAPY_SESSION_WAIT_TIME:"capy_session_wait_time",GROUP_SMS_PARTICIPANT_JOINED:"group_sms_participant_joined",GROUP_SMS_PARTICIPANT_CAPPED:"group_sms_participant_capped",SMS_PHONE_NUMBER_CHECK:"sms_phone_number_check",MESSENGER_BOT_REVIEW_SENT:"messenger_bot_review_sent",MESSENGER_CODE_SCAN:"messenger_code_scan",MESSENGER_LIVECHAT_PLUGIN_OPEN:"messenger_livechat_plugin_open",MINGLE_MATCH_SUCCESS:"mingle_match_success",MINGLE_PARTICIPANT_MATCHED:"mingle_participant_matched",MN_ACCOUNT_LINKING_TEXT:"mn_account_linking_text",MN_ACCOUNT_UNLINKING_TEXT:"mn_account_unlinking_text",MN_ACCOUNT_FORCED_UNLINKING_TEXT:"mn_account_forced_unlinking_text",MN_REF_SEND_TEXT:"mn_ref_send_text",ADS_WELCOME_MSG:"ads_welcome_msg",THREAD_JOINABLE_PROMOTION_TEXT:"thread_joinable_promotion_text",PAGES_PLATFORM_REQUEST_TEXT:"pages_platform_request_text",MESSENGER_NEW_USER_GET_STARTED:"messenger_new_user_get_started",SMS_PHONE_NUMBER_TOGGLE:"sms_phone_number_toggle",PAGES_PLATFORM_CREATE_APPOINTMENT:"Pages_Platform_create_appointment",INTERNAL_CAREER_JOBSY_REACHOUT_CONNECTED:"internal_career_jobsy_reachout_connected",JOINABLE_GROUP_THREAD_CREATED:"joinable_group_thread_created",JOINABLE_ROOM_CREATED_WITH_CO_CREATORS:"joinable_room_created_with_co_creators",PAGES_PLATFORM_ACCEPT_APPOINTMENT:"pages_platform_accept_appointment",PAGES_PLATFORM_REFERRAL_CONFIRMED_APPOINTMENT:"pages_platform_referral_confirmed_appointment",PAGES_PLATFORM_DECLINE_APPOINTMENT:"pages_platform_decline_appointment",PAGES_PLATFORM_USER_CANCEL:"pages_platform_user_cancel",PAGES_PLATFORM_ADMIN_CANCEL:"pages_platform_admin_cancel",MESSENGER_OMNIM_CREATE_FLOW:"messenger_omnim_create_flow",MESSENGER_OMNIM_UPDATE_FLOW:"messenger_omnim_update_flow",MESSENGER_OMNIM_UPDATE_FLOW_STATE:"messenger_omnim_update_flow_state",MESSENGER_GROUP_DESCRITPION_UPDATE:"messenger_group_description_update",MESSENGER_EXTENSION_ADD_CART:"messenger_extension_add_cart",MESSENGER_EXTENSION_ADD_FAVORITE:"messenger_extension_add_favorite",MESSENGER_AD_CONTEXT:"messenger_ad_context",PAGES_PLATFORM_APPOINTMENT_REMINDER:"pages_platform_appointment_reminder",PAGES_PLATFORM_ADMIN_DECLINE:"pages_platform_admin_decline",POKE_RECEIVED:"poke_received",MESSENGER_STATION_SUBSCRIPTION:"messenger_station_subscription",MESSENGER_USER_ALSO_ON_MESSENGER:"messenger_user_also_on_messenger",MESSENGER_INBOX2_BIRTHDAY_BUMP:"messenger_inbox2_birthday_bump",MESSENGER_RESPOND_REMINDER_CONFIRMATION:"messenger_respond_reminder_confirmation",MESSENGER_RESPOND_REMINDER:"messenger_respond_reminder",MESSENGER_RESPOND_REMINDER_USER_CANCEL:"messenger_respond_reminder_user_cancel",MESSENGER_RESPOND_REMINDER_CANCEL_SUGGESTION:"messenger_respond_reminder_cancel_suggestion",STARTED_SHARING_VIDEO:"started_sharing_video",LIVE_VIDEO_CHAT:"live_video_chat",PARTICIPANT_JOINED_GROUP_CALL:"participant_joined_group_call",MESSENGER_ONLY_PHONE_JOINED_WITH_NEW_ACCOUNT:"messenger_only_phone_joined_with_new_account",PAGES_COMMERCE_PAYMENT_ENABLED:"pages_commerce_payment_enabled",GROUP_PAYMENT_REQUEST:"group_payment_request",P2P_CALL_ESCALATED_TO_GROUP_CALL:"p2p_call_escalated_to_group_call",INVITED_TO_ESCALATED_P2P_CALL:"invited_to_escalated_p2p_call",EVENT_UPCOMING:"event_upcoming",PAGES_VISITOR_POST_SEND_MESSAGE_UPSELL:"pages_visitor_post_send_message_upsell",PAGES_LOW_MESSAGE_RESPONSE_RATE:"pages_low_message_response_rate",PAGES_START_CALL:"pages_start_call",PARTIES_INVITE:"parties_invite",PAGES_JOIN_LOYALTY_PROGRAM:"pages_join_loyalty_program",WORK_INVITE_CLAIMED:"work_invite_claimed",P2P_PAYMENT_REQUEST_REMINDER:"p2p_payment_request_reminder",PHOTO_TAG_BUMP:"photo_tag_bump",MESSENGER_CALL_UPGRADE_LEGACY_CLIENT:"messenger_call_upgrade_legacy_client",DIRECTED_WALL_POST:"directed_wall_post",MESSENGER_CALL_LOG:"messenger_call_log",P2P_PAYMENT_MONEY_RAIN_GAME_ENTRY_POINT:"p2p_payment_money_rain_game_entry_point",MESSENGER_MONTAGE_MENTIONS:"messenger_montage_mentions",PAGES_MESSAGING_BLOCK_WORDS:"pages_messaging_block_words",ALOHA_CALL_INVITE:"aloha_call_invite",SHIPPO_TRACKING_UPDATES:"shippo_tracking_updates",NEO_APPROVED_CONNECTION_ADDED:"neo_approved_connection_added",CHANGE_FAVORITE_COLOR:"change_favorite_color",MARKETPLACE_ITEM_CHANGED:"marketplace_item_changed",SERVICES_VERTICAL_REDEEMED_REFERRAL:"services_vertical_redeemed_referral",SERVICES_VERTICAL_OPT_OUT_REQUESTS:"services_vertical_opt_out_requests",SERVICES_VERTICAL_OPT_OUT_REQUESTS_SUCCESS:"services_vertical_opt_out_requests_success",SERVICES_VERTICAL_LEAD_GEN_SURVEY:"services_vertical_lead_gen_survey",SERVICES_VERTICAL_LEAD_GEN_SURVEY_EDIT:"services_vertical_lead_gen_survey_edit",PAGES_MARK_AS_PAID:"pages_mark_as_paid",MIGRATED_TO_WORKPLACE:"migrated_to_workplace",MESSENGER_GROUP_EVENT_STATUS_UPDATE:"messenger_group_event_status_update",NEO_APPROVED_USER_REMOVED_FROM_GROUP:"neo_approved_user_removed_from_group",LIVE_CHAT_SUPPORT_AGENT_JOIN:"live_chat_support_agent_join",LIVE_CHAT_SUPPORT_SESSION_BEGIN:"live_chat_support_session_begin",LIVE_CHAT_SUPPORT_SESSION_END:"live_chat_support_session_end",MONTAGE_DIRECT_KEEP:"montage_direct_keep",MONTAGE_DIRECT_EXPIRE:"montage_direct_expire",CHSBOT_CONVERSATION_ENDED:"chsbot_conversation_ended",CHSBOT_LIVE_CHAT_SUPPORT_AGENT_BEGIN:"chsbot_live_chat_support_agent_begin",CHSBOT_LIVE_CHAT_SUPPORT_AGENT_END:"chsbot_live_chat_support_agent_end",CHSBOT_LIVE_PHONE_SUPPORT_AGENT_CALLING:"chsbot_live_phone_support_agent_calling",CHSBOT_SUPPORT_REQUESTED:"chsbot_support_requested",MESSENGER_SUBSCRIBE_TO_UPDATES:"messenger_subscribe_to_updates",MESSENGER_UNSUBSCRIBE_FROM_UPDATES:"messenger_unsubscribe_from_updates",MESSENGER_BLOCK_MESSAGES:"messenger_block_messages",MESSENGER_UNBLOCK_MESSAGES:"messenger_unblock_messages",MESSENGER_TURN_ON_MESSAGES:"messenger_turn_on_messages",MESSENGER_TURN_OFF_MESSAGES:"messenger_turn_off_messages",THANKS_FOR_SHARING_MESSAGE_CONTEXT:"thanks_for_sharing_message_context",GROUP_ADMIN_MODEL_NUX:"group_admin_model_nux",MESSENGER_PAYMENT_INCENTIVE_INFO:"messenger_payment_incentive_info",MESSENGER_PLATFORM_PERSONA:"messenger_platform_persona",MESSENGER_GROUP_SYNC_OPT_IN:"messenger_group_sync_opt_in",MESSENGER_GROUP_SYNC_OPT_OUT:"messenger_group_sync_opt_out",MENTORSHIP_MATCH:"mentorship_match",PAGES_CALL_DEFLECTION_UPSELL:"pages_call_deflection_upsell",RTC_PHOTOBOOTH:"rtc_photobooth",DELAYED_PHONE_NUMBER_MATCH:"delayed_phone_number_match",AUTOMATIC_TRANSLATION_ENABLED:"automatic_translation_enabled",AUTOMATIC_TRANSLATION_DISABLED:"automatic_translation_disabled",MESSENGER_ROOM_MIGRATION:"messenger_room_migration"})}),null);
__d("MessagingGiftWrapChecker",["MercuryConfig","MercuryTagHelper","MessagingGiftWrapConstants"],(function a(b,c,d,e,f,g){"use strict";var h={shouldRenderWithGiftWrap:function k(l){return!!(l.tags&&i(l.tags)&&!j(l.tags))}};function i(k){return c("MercuryTagHelper").get(k,c("MessagingGiftWrapConstants").TAG_PREFIX)===c("MessagingGiftWrapConstants").VALENTINES_GIFT}function j(k){return!!c("MercuryTagHelper").get(k,c("MessagingGiftWrapConstants").UNWRAPPED_TAG)}f.exports=h}),null);
__d("MessengerGroupsSyncStatus",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({PENDING_OPT_IN:"PENDING_OPT_IN",OPT_IN:"OPT_IN",PENDING_OPT_OUT:"PENDING_OPT_OUT",OPT_OUT:"OPT_OUT",UNSET:"UNSET",UNSUPPORTED:"UNSUPPORTED"})}),null);
__d("XGroupsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groups/{idorvanity}/{?view}/{?post_id}/",{idorvanity:{type:"String",required:true},view:{type:"Enum",enumType:1},post_id:{type:"Int"},rule_id:{type:"Int"},ref:{type:"String"},source_id:{type:"String"},notif_t:{type:"String"},nux:{type:"Enum",enumType:1},tip_id:{type:"Int"},member_tag_id:{type:"FBID"},inner_tab:{type:"String"},section:{type:"Enum",enumType:1},thread_id:{type:"String"},autopopup_create_chat_dialog:{type:"Bool",defaultValue:false},sorting_setting:{type:"String"},multi_events:{type:"String"},stories:{type:"Exists",defaultValue:false},queue:{type:"Enum",enumType:1},composer_prefill:{type:"String"},comment_id:{type:"Int"},reply_comment_id:{type:"Int"}})}),null);
__d("MercuryThreads",["invariant","ChatReliabilityInstrumentation","EventEmitter","EventReminderConstants","MercuryDisplayTimeFilterMessageRenderer","ImmutableObject","KeyedCallbackManager","LogHistory","MercuryActionType","MercuryAssert","MercuryAttachment","MercuryDispatcher","MercuryGiftSnippetRenderer","MercuryGlobalActionType","MercuryIDs","MercuryLocalIDs","MercuryLoggingHelper","MercuryLogMessageType","MercuryParticipants","MercuryPayloadSource","MercuryServerRequests","MercurySingletonProvider","MercurySyncFakeDFFSender","MercuryThreadInfo","MercuryThreadInformer","MessagingGenericAdminTextType","MessagingGiftWrapChecker","MessagingTag","PageCommItemStatus","MessengerGroupsSyncStatus","XGroupsController","URI","emptyFunction","ifRequired","requireWeak","setImmediate"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("EventReminderConstants").GuestStates,j=new(c("EventEmitter"))(),k=c("LogHistory").getInstance("mercury_threads"),l=new Set();function m(o){__p&&__p();this.$MercuryThreads1=o;this.$MercuryThreads2=c("MercuryServerRequests").getForFBID(this.$MercuryThreads1);this.$MercuryThreads3=c("MercuryThreadInformer").getForFBID(this.$MercuryThreads1);this.$MercuryThreads4=c("MercuryIDs").getParticipantIDFromUserID(this.$MercuryThreads1);this.$MercuryThreads5=c("MercuryDispatcher").getForFBID(this.$MercuryThreads1);this.$MercuryThreads6=c("MercurySyncFakeDFFSender").getForFBID(this.$MercuryThreads1);this.$MercuryThreads7=false;this.$MercuryThreads8=new(c("KeyedCallbackManager"))();this.$MercuryThreads9=new Set();this.$MercuryThreads10=false;this.$MercuryThreads11=new Set();this.$MercuryThreads12=new Set();this.$MercuryThreads13()}m.getForFBID=function(o){return n.getForFBID(o)};m.get=function(){return n.get()};m.prototype.getThreadMetaNow=function(o){c("MercuryAssert").isThreadID(o);var p=this.$MercuryThreads8.getResource(o);if(p&&!p.participants){c("ChatReliabilityInstrumentation").logERROR("participants are null!",{thread_id:o});this.$MercuryThreads6.sendThreadDFF(null,o);return new(c("ImmutableObject"))(babelHelpers["extends"]({},p,{participants:[]}))}return p};m.prototype.getOrFetch=function(o){var p=this.getThreadMetaNow(o);if(!p&&!this.$MercuryThreads12.has(o))this.$MercuryThreads11.add(o);if(this.$MercuryThreads11.size>0&&!this.$MercuryThreads10)this.$MercuryThreads14();return p};m.prototype.$MercuryThreads14=function(){__p&&__p();if(this.$MercuryThreads10)return;this.$MercuryThreads10=true;c("setImmediate")(function(){this.$MercuryThreads10=false;this.$MercuryThreads11.forEach(function(o){return this.$MercuryThreads12.add(o)}.bind(this));this.getMultiThreadMeta(Array.from(this.$MercuryThreads11),function(o){for(var p in o)Object.prototype.hasOwnProperty.call(o,p)&&this.$MercuryThreads12["delete"](p)}.bind(this));this.$MercuryThreads11.clear()}.bind(this))};m.prototype.getThreadMeta=function(o,p,q){return this.getMultiThreadMeta([o],function(r){return p(r[o])},q)};m.prototype.getMultiThreadMeta=function(o,p,q){__p&&__p();c("MercuryAssert").allThreadID(o);var r=this.$MercuryThreads8.executeOrEnqueue(o,p),s=this.$MercuryThreads8.getUnavailableResources(r);if(s.length){var t=[];for(var u=0;u<s.length;u++){var v=s[u],w=c("MercuryIDs").tokenize(v),x=w.type,y=w.value;if(x=="user"){var z=c("MercuryIDs").getParticipantIDFromUserID(y);this.createNewLocalThread(v,z===this.$MercuryThreads4?[this.$MercuryThreads4]:[this.$MercuryThreads4,z])}t.push(v)}if(t.length)this.$MercuryThreads2.fetchThreadData(t,q)}return r};m.addListener=function(o,p){return j.addListener(o,p)};m.prototype.unsubscribe=function(o){this.$MercuryThreads8.unsubscribe(o)};m.prototype.getCanonicalThreadToParticipant=function(o,p,q,r){var s=c("MercuryIDs").getThreadIDFromParticipantID(o);!!s||h(0);var t=this.$MercuryThreads8.getResource(s);if(t==undefined){t=this.createNewLocalThread(s,this.$MercuryThreads4===o?[this.$MercuryThreads4]:[this.$MercuryThreads4,o],p);!r&&this.$MercuryThreads2.fetchThreadData([s],q)}return t};m.prototype.createNewLocalThread=function(o,p,q){var r=this.$MercuryThreads8.getResource(o);if(!r){var s=c("MercuryIDs").tokenize(o),t=s.type,u=s.value;r=new(c("ImmutableObject"))({thread_id:o,participants:Array.from(p),admin_ids:[],name:"",snippet:"",snippet_sender:null,unread_count:q?q:0,message_count:0,image_src:null,timestamp:null,other_user_fbid:t==="user"?u:null,is_canonical_user:t=="user",is_canonical:this.$MercuryThreads15(p),is_subscribed:true,folder:c("MessagingTag").INBOX,is_archived:false,is_page_follow_up:false});this.$MercuryThreads8.setResource(o,r)}return r};m.prototype.createNewLocalThreadGenerateID=function(){var o=c("MercuryLocalIDs").generateThreadID();this.createNewLocalThread(o,[]);return o};m.prototype.isEmptyLocalThread=function(o){var p=this.$MercuryThreads8.getResource(o);if(!p)return false;return c("MercuryThreadInfo").isEmptyLocalThread(p)};m.prototype.isNewEmptyLocalThread=function(o){var p=this.$MercuryThreads8.getResource(o);if(!p)return false;return c("MercuryThreadInfo").isNewEmptyLocalThread(p)};m.prototype.$MercuryThreads16=function(o,p){__p&&__p();if(!o||!o.length)return;var q=new Map(),r=new Map(),s=new Map(),t=[];for(var u=0;u<o.length;u++){var v=o[u],w=v.action_type;if(w==c("MercuryActionType").LOG_MESSAGE&&v.log_message_type==c("MercuryLogMessageType").SERVER_ERROR)continue;var x=!p&&!!(v.thread_fbid||v.other_user_fbid||v.is_from_iris),y=v.thread_id;c("MercuryAssert").isThreadID(y);var z=this.$MercuryThreads8.getResource(y);if(!z&&!x&&w===c("MercuryActionType").USER_GENERATED_MESSAGE){z=this.$MercuryThreads17(v);if(!z.participants||!z.participants.length){k.debug("missing_local_participants",JSON.stringify(c("MercuryLoggingHelper").obfuscateMessage(v)));c("ChatReliabilityInstrumentation").logERROR("missing_local_participants",{thread_id:y});z=new(c("ImmutableObject"))(babelHelpers["extends"]({},z,{participants:[]}));var A=v.other_user_fbid,B=v.thread_fbid;if(A||B)this.$MercuryThreads6.sendThreadDFF(A,B);else continue}this.$MercuryThreads8.setResource(y,z)}if(!z)continue;if(w==c("MercuryActionType").LOG_MESSAGE||w==c("MercuryActionType").USER_GENERATED_MESSAGE)x=!p;if(z.server_timestamp&&v.timestamp<z.server_timestamp&&x)continue;if(z.server_timestamp&&w===c("MercuryActionType").USER_GENERATED_MESSAGE&&v.offline_threading_id&&v.author!==c("MercuryIDs").getParticipantIDFromUserID(this.$MercuryThreads1))if(l.has(v.offline_threading_id))continue;else l.add(v.offline_threading_id);if(!s.has(y))s.set(y,babelHelpers["extends"]({},z));else k.error("skipping thread metadata update",JSON.stringify({have:s.get(y),skipped:z}));var C=s.get(y);!!C||h(0);this.$MercuryThreads18(C,v,p);var D=q.get(y);if(w==c("MercuryActionType").USER_GENERATED_MESSAGE&&(!D||v.timestamp>D.timestamp))q.set(y,v);if(w==c("MercuryActionType").USER_GENERATED_MESSAGE||w==c("MercuryActionType").LOG_MESSAGE)if(v&&v.timestamp&&(!r.has(y)||v.timestamp>r.get(y).timestamp))r.set(y,v)}s.forEach(function(E,F){__p&&__p();var G=r.get(F),D=q.get(F);if(D)this.$MercuryThreads19(E,D);else if(G&&G.log_message_body){var H=babelHelpers["extends"]({},G,{body:G.log_message_body});this.$MercuryThreads19(E,H)}var I=E.timestamp;if(G&&!G.skip_bump_thread){if(G.timestamp>I)Object.assign(E,{timestamp:G.timestamp});var J=E.server_timestamp;if(!p&&G.timestamp>J)E.server_timestamp=G.timestamp}var K=new(c("ImmutableObject"))(E);if((!K.participants||!K.participants.length)&&!this.isEmptyLocalThread(K.thread_id)){var L=(o||[]).map(c("MercuryLoggingHelper").obfuscateMessage),M={update:c("MercuryLoggingHelper").obfuscateThread(K),actions:L};k.error("bad metadata update no_participants",JSON.stringify(M));c("ChatReliabilityInstrumentation").logERROR("refusing to set thread metadata with no participants",M);return}this.$MercuryThreads8.setResource(F,K);t.push(c("MercuryLoggingHelper").obfuscateThread(K))}.bind(this),this);t.length&&this.$MercuryThreads7&&k.debug("threads_updated",JSON.stringify({threads:t}))};m.prototype.$MercuryThreads18=function(o,p,q){__p&&__p();var r=p.action_type;if(r==c("MercuryActionType").USER_GENERATED_MESSAGE||r==c("MercuryActionType").LOG_MESSAGE){if(p.is_unread||p.skip_bump_thread)if(!(o.unread_count===0&&p.skip_bump_thread))if(p.timestamp>o.server_timestamp)o.unread_count++;o.message_count++;o.is_archived=false}switch(r){case c("MercuryActionType").DELETE_THREAD:o.message_count=0;this.$MercuryThreads20(p.thread_id);break;case c("MercuryActionType").USER_GENERATED_MESSAGE:if(o.unread_count===0&&p.author===this.$MercuryThreads4&&p.timestamp>=o.last_read_timestamp)o.last_read_timestamp=p.timestamp;if(p.offline_threading_id!==p.message_id){o.last_message_timestamp=p.timestamp;if(p.comm_status!=null)o.last_message_id=p.message_id}if(p.comm_status!=null)if(o.comm_status&&o.comm_status.toUpperCase()!==c("PageCommItemStatus").FOLLOW_UP)o.comm_status=p.comm_status;if(p.creator_info&&p.creator_info.pageID===this.$MercuryThreads1)o.folder=p.folder;this.$MercuryThreads21(o,p.author);break;case c("MercuryActionType").SEND_MESSAGE:var s=p.log_message_type;if(s==c("MercuryLogMessageType").THREAD_IMAGE){o.image_src=p.log_message_data.image?p.log_message_data.image.preview_url:null;this.$MercuryThreads22(p.thread_id)}if(s!==c("MercuryLogMessageType").SUBSCRIBE&&s!==c("MercuryLogMessageType").UNSUBSCRIBE)o.snippet_attachments=p.attachments;break;case c("MercuryActionType").LOG_MESSAGE:var s=p.log_message_type;if(s==c("MercuryLogMessageType").SUBSCRIBE&&!q){this.$MercuryThreads23(o,p.log_message_data.added_participants);this.$MercuryThreads22(p.thread_id)}else if(s==c("MercuryLogMessageType").UNSUBSCRIBE&&!q){this.$MercuryThreads24(o,p.log_message_data.removed_participants);this.$MercuryThreads22(p.thread_id)}else if(s==c("MercuryLogMessageType").THREAD_IMAGE){if(!q)o.image_src=p.log_message_data.image?p.log_message_data.image.preview_url:null}else if(s==c("MercuryLogMessageType").THREAD_NAME){if(o.name!==p.log_message_data.name)this.$MercuryThreads22(p.thread_id);o.name=p.log_message_data.name}else if(s===c("MercuryLogMessageType").GENERIC_ADMIN_TEXT)this.$MercuryThreads25(o,p);break;case c("MercuryActionType").CHANGE_READ_STATUS:var t=this.$MercuryThreads26(o,p,p.mark_as_read);if(t)o.last_read_timestamp=o.last_message_timestamp;var u=!o.read_only&&o.folder===c("MessagingTag").INBOX;if(t&&q)this.$MercuryThreads2.changeThreadReadStatus(o.thread_id,p.mark_as_read,p.source,o.last_read_timestamp,u,o.last_message_type);break;case c("MercuryActionType").CHANGE_ARCHIVED_STATUS:if(o.is_archived!=p.archived){o.is_archived=p.archived;if(o.comm_status!=null)o.comm_status=p.archived?c("PageCommItemStatus").DONE:c("PageCommItemStatus").TODO;this.$MercuryThreads22(p.thread_id)}break;case c("MercuryActionType").CHANGE_PAGE_FOLLOW_UP_STATUS:if(o.is_page_follow_up!=p.is_page_follow_up){o.is_page_follow_up=p.is_page_follow_up;this.$MercuryThreads22(p.thread_id)}break;case c("MercuryActionType").CHANGE_FOLDER:if(o.folder!=p.new_folder){o.folder=p.new_folder;if(o.comm_status!=null)if(p.new_folder===c("MessagingTag").OTHER)o.comm_status=c("PageCommItemStatus").SPAM;else if(p.new_folder===c("MessagingTag").INBOX)o.comm_status=c("PageCommItemStatus").TODO;this.$MercuryThreads22(p.thread_id)}break;case c("MercuryActionType").DELETE_MESSAGES:if(q){o.snippet="...";o.snippet_attachments=null;o.snippet_sender=null;this.$MercuryThreads22(p.thread_id)}else if(p.message_ids){o.message_count-=p.message_ids.length;c("ifRequired")("MercuryMessages",function(A){__p&&__p();A=A.getForFBID(this.$MercuryThreads1);for(var B=p.message_ids,C=Array.isArray(B),D=0,B=C?B:B[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var E;if(C){if(D>=B.length)break;E=B[D++]}else{D=B.next();if(D.done)break;E=D.value}var F=E,G=A.getMessagesFromIDs([F]),H=G[0];if(H&&H.timestamp>o.last_read_timestamp)o.unread_count=Math.max(0,o.unread_count-1)}this.$MercuryThreads22(p.thread_id)}.bind(this),c("emptyFunction"))}break;case c("MercuryActionType").UPDATE_SNIPPET:c("ifRequired")("MercuryMessages",function(A){__p&&__p();A=A.getForFBID(this.$MercuryThreads1);var B=0,C=1,D=A.getThreadMessagesRangeNow(p.thread_id,B,C),E=D[0];if(E){o.snippet=E.body;o.snippet_attachments=E.attachments;o.snippet_sender=E.author}else{o.snippet="...";o.snippet_attachments=null;o.snippet_sender=null;A.getThreadMessagesRange(p.thread_id,B,C,function(F){if(F.length)this.$MercuryThreads5.handleUpdate({from_client:true,actions:[{thread_id:p.thread_id,action_type:c("MercuryActionType").UPDATE_SNIPPET,deleted_ids:p.deleted_ids}]})}.bind(this))}this.$MercuryThreads22(p.thread_id)}.bind(this),c("emptyFunction"));break;case c("MercuryActionType").CHANGE_MUTE_SETTINGS:if(Object.prototype.hasOwnProperty.call(p,"reactions_mute_mode"))o.reactions_mute_mode=p.reactions_mute_mode;else if(Object.prototype.hasOwnProperty.call(p,"mentions_mute_mode"))o.mentions_mute_mode=p.mentions_mute_mode;else o.mute_until=!p.mute_until?undefined:p.mute_until;this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").BLOCK_STATUS_CHANGED:o.can_reply=p.canViewerReply;this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").ADD_PARTICIPANTS:this.$MercuryThreads23(o,p.participants);this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").CHANGE_FLAG:this.$MercuryThreads27(o,p.mark_as_flag);this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").MOVE_PENDING_TO_INBOX:this.$MercuryThreads28(o);this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").UPDATE_CUSTOM_LIKE:o.custom_like_icon=p.custom_like;this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").ADD_GROUP_ADMINS:o.admin_ids=o.admin_ids.concat(p.added_admin_ids.filter(function(A){return o.admin_ids.indexOf(A)===-1}));this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").REMOVE_GROUP_ADMINS:o.admin_ids=o.admin_ids.filter(function(A){return p.removed_admin_ids.indexOf(A)===-1});this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").JOINABLE_MODE:o.joinable_mode=p.joinable_mode;this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").APPROVAL_MODE:o.approval_mode=p.approval_mode;this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").APPROVAL_QUEUE:if(p.added_id&&o.approval_queue_ids&&o.approval_queue_ids.indexOf(p.added_id)===-1)o.approval_queue_ids=o.approval_queue_ids.concat(p.added_id);if(p.removed_id&&o.approval_queue_ids)o.approval_queue_ids=o.approval_queue_ids.filter(function(A){return p.removed_id!==A});if(p.added_group_id&&o.group_approval_queue&&!o.group_approval_queue.find(function(A){p.added_group_id.requester.id===A.requesterId}))o.group_approval_queue=o.group_approval_queue.concat([p.added_group_id]);if(p.removed_group_id&&o.group_approval_queue)o.group_approval_queue=o.group_approval_queue.filter(function(A){return p.removed_group_id!==A.requester.id});this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").IS_PIN_PROTECTED:o.is_pin_protected=p.is_pin_protected;this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").UPDATE_RTC_CALL_DATA:var v=p.initiator_fbid||(o.rtc_call_data?o.rtc_call_data.initiator_fbid:undefined);o.rtc_call_data=new(c("ImmutableObject"))({call_state:p.call_state,server_info_data:p.server_info_data,initiator_fbid:v});this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").UPDATE_COMM_STATUS:this.$MercuryThreads29(o,p.comm_status);this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").UPDATE_COMM_ITEM_OWNER:var w=void 0;if(p.id===null)w={nodes:[]};else w={nodes:[{admin:{id:p.id,name:p.name,profile_picture:{uri:p.profile_pic_uri}}}]};o.comm_item_owners=w;this.$MercuryThreads22(o.thread_id);break;case c("MercuryActionType").EVENT_RSVP_CHANGED:var x=o.participants_event_status.filter(function(A){return A.participant_id!==p.actor_fbid});x.push({participant_id:p.actor_fbid.toString(),event_status:p.rsvp_status});o.participants_event_status=x;this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED:o.group_sync_status=p.groups_sync_status_string;this.$MercuryThreads22(p.thread_id);break;case c("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE:if(p.groups_sync_action===c("MessengerGroupsSyncStatus").OPT_IN){var y=new(c("URI"))(document.URL),z=c("XGroupsController").getURIBuilder().setString("idorvanity",p.fb_group_id).getURI().setDomain(y.getDomain().replace("messenger.com","facebook.com")).setPort(y.getPort()).setProtocol("https");o.group_sync_fb_url=z.toString()}else o.group_sync_fb_url=null;this.$MercuryThreads22(p.thread_id);break}};m.prototype.$MercuryThreads25=function(o,p){__p&&__p();var q,r=this;if(p.log_message_data&&p.log_message_data.untypedData)(function(){__p&&__p();var s=p.log_message_data.untypedData,event=o.lightweight_event;switch(p.log_message_data.message_type){case c("MessagingGenericAdminTextType").THREAD_EPHEMERAL_SEND_MODE:var t=parseInt(s.ttl,10);if(t!==null&&o.ephemeral_ttl_mode!==t){o.ephemeral_ttl_mode=t;r.$MercuryThreads22(p.thread_id)}break;case c("MessagingGenericAdminTextType").CHANGE_THREAD_NICKNAME:var u={};for(var v in o.custom_nickname){if(v==s.participant_id&&s.nickname.trim().length==0)continue;u[v]=o.custom_nickname[v]}if(s.nickname.trim().length>0)u[s.participant_id]=s.nickname;o.custom_nickname=u;r.$MercuryThreads22(p.thread_id);break;case c("MessagingGenericAdminTextType").CHANGE_THREAD_ICON:c("requireWeak")("MercuryThreadActions",function(z){z.getForFBID(this.$MercuryThreads1).updateCustomLike(p.thread_id,s.thread_icon)}.bind(r));break;case c("MessagingGenericAdminTextType").CHANGE_THREAD_THEME:var w=s.theme_color;if(w&&w.length>0)o.custom_color="#".concat(w.substring(2));else o.custom_color=null;r.$MercuryThreads22(p.thread_id);break;case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_CREATE:var x={};o.participants.map(function(z){var A=c("MercuryIDs").getUserIDFromParticipantID(z);if(A)x[A]=A===s.event_creator_id?i.GOING:i.INVITED},r);o.lightweight_event={track_rsvp:s.event_track_rsvp,title:s.event_title,event_time:parseInt(s.event_time,10),location_name:s.event_location_name,event_members:x,oid:s.event_id,event_type:s.event_type};r.$MercuryThreads22(p.thread_id);break;case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TIME:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TITLE:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_LOCATION:if(event)o.lightweight_event=r.$MercuryThreads30(s,event,event.event_members);r.$MercuryThreads22(p.thread_id);break;case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_RSVP:if(event&&event.event_members){var y=r.$MercuryThreads31(event.event_members,s);o.lightweight_event=r.$MercuryThreads30(s,event,y)}r.$MercuryThreads22(p.thread_id);break;case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_DELETE:case c("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_NOTIFY:o.lightweight_event=null;r.$MercuryThreads22(p.thread_id);break}})()};m.prototype.$MercuryThreads31=function(o,p){var q={};for(var r in o)q[r]=o[r];q[p.guest_id]=p.guest_status;return q};m.prototype.$MercuryThreads30=function(o,event,p){return{track_rsvp:event.track_rsvp,title:o.event_title===undefined?event.title:o.event_title,event_time:o.event_time===undefined?event.event_time:parseInt(o.event_time,10),location_name:o.event_location_name===undefined?event.location_name:o.event_location_name,event_members:p===undefined?event.event_members:p,oid:event.oid,event_type:event.event_type}};m.prototype.$MercuryThreads17=function(o){var p=c("MercuryIDs").tokenize(o.thread_id),q=p.type,r=p.value,s=q==="user",t=s||o.specific_to_list&&this.$MercuryThreads15(o.specific_to_list),u=t||s?this.$MercuryThreads32(o):o.specific_to_list;return new(c("ImmutableObject"))({thread_id:o.thread_id,participants:u,name:null,snippet:o.body,snippet_attachments:[],snippet_sender:o.author,unread_count:0,message_count:0,image_src:null,timestamp:o.timestamp,other_user_fbid:s?r:null,is_canonical_user:s,is_canonical:t,is_subscribed:true,folder:c("MessagingTag").INBOX,is_archived:false,is_page_follow_up:false})};m.prototype.$MercuryThreads26=function(o,p,q){__p&&__p();if(p.timestamp)this.$MercuryThreads33(o.thread_id,q,p.timestamp);if(!o||!o.thread_id||!o.participants)return false;if(!o.timestamp){this.$MercuryThreads9.add(o.thread_id);return false}var r=!o.unread_count;if(q==r)return false;o.unread_count=q?0:1;this.$MercuryThreads22(o.thread_id);return true};m.prototype.$MercuryThreads34=function(o){var p=this.$MercuryThreads8.getAllResources();for(var q in p)if(Object.prototype.hasOwnProperty.call(p,q)){var r=p[q];if(r.folder==o){this.$MercuryThreads8.setResource(q,c("ImmutableObject").setProperty(r,"unread_count",0));this.$MercuryThreads22(q)}}};m.prototype.$MercuryThreads23=function(o,p){__p&&__p();var q=new Set(o.participants);o.participants=Array.from(o.participants||[]);p.forEach(function(r){if(!q.has(r)){o.participants.push(r);if(r===this.$MercuryThreads4){o.is_subscribed=true;o.can_reply=true;o.cannot_reply_reason=null;this.$MercuryThreads6.sendThreadDFF(undefined,o.thread_fbid)}}}.bind(this))};m.prototype.$MercuryThreads24=function(o,p){__p&&__p();var q=new Set(p);if(o&&!o.participants)c("ChatReliabilityInstrumentation").logERROR("participants are null in thread_info!",{thread_info:o});else o.participants=o.participants.filter(function(r){return!q.has(r)});if(o&&!o.admin_ids)c("ChatReliabilityInstrumentation").logERROR("admin_ids are null in thread_info!",{thread_info:o});else o.admin_ids=o.admin_ids.filter(function(r){return!q.has(r)});if(q.has(this.$MercuryThreads4))o.is_subscribed=false;this.$MercuryThreads2.fetchThreadData([o.thread_id])};m.prototype.$MercuryThreads21=function(o,p){if(!o.participants){var q=JSON.stringify({thread_info:o,participant:p});k.error("missing_participants",q);return}var r=o.participants.indexOf(p);if(r>0)o.participants=[p].concat(o.participants.slice(0,r),o.participants.slice(r+1))};m.prototype.$MercuryThreads19=function(o,p){__p&&__p();var q=p.body,r=p.subject,s="";if(r){r=r.toLowerCase();if(q.slice(0,r.length).toLowerCase()==r)s=q;else if(q)s=r+" \xb7 "+q;else s=r}else s=q;if(p.is_filtered_content)s=c("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(p);if(c("MessagingGiftWrapChecker").shouldRenderWithGiftWrap(p)){var t=p.author,u=t==this.$MercuryThreads4,v=null;if(!u){v=o.custom_nickname&&o.custom_nickname[c("MercuryIDs").getUserIDFromParticipantID(t)];if(!v){var w=c("MercuryParticipants").getNow(t);if(w!=null)v=w.short_name}}s=c("MercuryGiftSnippetRenderer").renderText(u,v)}o.snippet=s;if(p.raw_attachments&&p.raw_attachments.length>0){var x=c("MercuryAttachment").convertRaw(p.raw_attachments);o.snippet_attachments=x}else o.snippet_attachments=p.attachments;if(p.log_message_type)o.snippet_sender=null;else o.snippet_sender=p.author};m.prototype.$MercuryThreads27=function(o,p){o.page_thread_info=babelHelpers["extends"]({},o.page_thread_info,{flagged:p})};m.prototype.$MercuryThreads29=function(o,p){o.comm_status=p};m.prototype.$MercuryThreads28=function(o){if(o.folder!==c("MessagingTag").PENDING)return;o.folder=c("MessagingTag").INBOX};m.prototype.$MercuryThreads15=function(o){return o.filter(function(p){return p!=this.$MercuryThreads4}.bind(this)).length<=1};m.prototype.$MercuryThreads13=function(){__p&&__p();this.$MercuryThreads5.subscribe("invalidate-thread-state",function(o,p){return this.$MercuryThreads35(p)}.bind(this));this.$MercuryThreads5.subscribe("invalidate-global-state",function(o,p){return this.$MercuryThreads36()}.bind(this));this.$MercuryThreads5.subscribe("update-threads",function(o,p){__p&&__p();var q=(p.actions||[]).filter(function(r){return r.thread_id});if(p.threads&&p.payload_source==c("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO)p.threads.forEach(function(r){var s=r.thread_id;if(this.$MercuryThreads9.has(s)){this.$MercuryThreads9["delete"](s);if(r.unread_count)this.$MercuryThreads2.changeThreadReadStatus(r.thread_id,true)}}.bind(this));this.$MercuryThreads37(p.threads);this.$MercuryThreads16(q,p.from_client);p.threads&&p.threads.forEach(function(r){this.$MercuryThreads22(r.thread_id)}.bind(this));if(p.global_actions)p.global_actions.forEach(function(r){if(r.action_type==c("MercuryGlobalActionType").MARK_ALL_READ)this.$MercuryThreads34(r.folder)}.bind(this));if(this.$MercuryThreads7){this.$MercuryThreads7=false;j.emit("change")}}.bind(this))};m.prototype.$MercuryThreads37=function(o){if(!o||!o.length)return;var p={},q=[];o.forEach(function(r){var s=new(c("ImmutableObject"))(r);p[r.thread_id]=s;q.push(c("MercuryLoggingHelper").obfuscateThread(s))});q.length&&k.debug("threads_added",JSON.stringify({threads:q}));this.$MercuryThreads8.addResourcesAndExecute(p)};m.prototype.$MercuryThreads22=function(o){this.$MercuryThreads7=true;this.$MercuryThreads3.updatedThread(o)};m.prototype.$MercuryThreads20=function(o){this.$MercuryThreads7=true;this.$MercuryThreads3.deletedThread(o)};m.prototype.$MercuryThreads33=function(o,p,q){this.$MercuryThreads7=true;this.$MercuryThreads3.changedThreadReadState(o,p,q)};m.prototype.$MercuryThreads35=function(o){this.$MercuryThreads8.setResource(o,undefined)};m.prototype.$MercuryThreads36=function(){this.$MercuryThreads7=false;this.$MercuryThreads8=new(c("KeyedCallbackManager"))();this.$MercuryThreads9=new Set();this.$MercuryThreads10=false;this.$MercuryThreads11=new Set();this.$MercuryThreads12=new Set()};m.prototype.$MercuryThreads32=function(o){if(o.specific_to_list)return o.specific_to_list;var p=c("MercuryIDs").tokenize(o.thread_id),q=p.type,r=p.value;if(!r||q!=="user")return[this.$MercuryThreads4];return[c("MercuryIDs").getParticipantIDFromUserID(r),this.$MercuryThreads4]};var n=new(c("MercurySingletonProvider"))(m);f.exports=m}),null);
__d("MercuryServerSendMessageQueueSimulatedError",["AsyncRequest","AsyncResponse"],(function a(b,c,d,e,f,g){var h=9999,i={create:function j(k){var l=new(c("AsyncRequest"))(this.endpoint_uri).setData({message_batch:[k],client:this.client}),m=new(c("AsyncResponse"))(l,{});Object.assign(m,{error:h,silentError:false,transientError:true,request:l});return m}};f.exports=i}),null);
__d("MNCommerceBubbleType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({FB_RETAIL_RECEIPT:1,FB_RETAIL_CANCELLATION:2,FB_RETAIL_SHIPMENT:3,FB_RETAIL_SHIPMENT_TRACKING_EVENT_ETA:4,FB_RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:5,FB_RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:6,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:7,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:8,FB_RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:9,FB_RETAIL_SHIPMENT_ETA:10,FB_RETAIL_NOW_IN_STOCK:11,FB_RETAIL_AGENT_ITEM_SUGGESTION:12,FB_RETAIL_AGENT_ITEM_RECEIPT:13,FB_RETAIL_PROMOTIONAL_MSG:14})}),null);
__d("MNCommerceCallToActionType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({OPEN_NATIVE:1,OPEN_URL:2,OPEN_CANCEL_RIDE_MUTATION:3,POSTBACK:4,ACCOUNT_LINK:5,MANAGE_MESSAGES:6,SHARE:7,PAYMENT:8,FACEBOOK_REPORT_A_PROBLEM:9,SUBSCRIPTION_PRESELECT:10,NAVIGATION:11,EXTENSIBLE_SHARE:12,OPEN_REACT_NATIVE_MINI_APP:13,OPEN_PAGE_ABOUT:14,OPEN_BRANDED_CAMERA:15,OPEN_THREAD:16})}),null);
__d("P2PTransferStatus",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({PENDING_SENDER_MANUAL_REVIEW:1,PENDING_SENDER_VERIFICATION:2,CANCELED_SENDER_RISK:3,PENDING_RECIPIENT_NUX:4,CANCELED_DECLINED:5,PENDING_RECIPIENT_VERIFICATION:6,PENDING_RECIPIENT_MANUAL_REVIEW:7,PENDING_RECIPIENT_PROCESSING:8,PENDING_PUSH_FAIL:9,CANCELED_RECIPIENT_RISK:10,CANCELED_SYSTEM_FAIL:11,CANCELED_EXPIRED:12,COMPLETED:13,INTERMEDIATE_PROCESSING:14,PENDING_SENDER_INITED:15,CANCELED_SAME_CARD:16,PENDING_SENDER_VERIFICATION_PROCESSING:17,PENDING_RECIPIENT_VERIFICATION_PROCESSING:18,CANCELED_SENDER_CANCEL:19,PENDING_SENDER_IDV_REVIEW:20,PENDING_RECEIVER_IDV_REVIEW:21})}),null);
__d("PaymentModulesClient",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DONATION_P4P:"donation_p4p",MOR_DONATIONS:"mor_donations",INSTANT_EXPERIENCES:"instant_experiences",BUSINESS_PLATFORM_COMMERCE:"business_platform_commerce",MESSENGER_OMNIM:"messenger_omnim",MESSENGER_PLATFORM:"messenger_platform",PAGES_COMMERCE:"pages_commerce",SHIPPING_LABEL:"shipping_label",SYNCHRONOUS_COMPONENT_FLOW:"synchronous_component_flow",PAGES_SOLUTION:"pages_solution",CHECKOUT_EXPERIENCES:"checkout_experiences",MOBILE_TOP_UP:"mobile_top_up",MOCK:"mock"})}),null);
__d("ServicesCalendarSyncType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CLIENT_ONLY:"client_only",NO_CALENDAR_SYNC:"no_calendar_sync",SERVER_CONTINUOUS:"server_continuous",SERVER_SINGLE:"server_single"})}),null);
__d("MessengerStoryAttachmentTransformer.bs",["fbt","URI","bs_array","Utils.bs","bs_string","bs_caml_array","bs_caml_format","CurrentUser","bs_js_primitive","FundsAvailability","bs_js_null_undefined","P2PTransferStatus","MNCommerceBubbleType","PaymentModulesClient","MercuryAttachmentType","bs_caml_builtin_exceptions","P2PPaymentRequestStatus","ServicesCalendarSyncType","MNCommerceCallToActionType","LeadGenInfoFieldTypes"],(function aa(ba,a,ca,da,ea,b,c){"use strict";__p&&__p();function d(B){return a("bs_array").map(function(C){var D=C.user_confirmation,E=D==null?[null,null,null,null,false]:[D.cancel_button_label,D.continue_button_label,D.confirmation_message,D.confirmation_title,true],F=C.payment_metadata;return{action_link:C.action_link,action_type:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("MNCommerceCallToActionType")[C.action_open_type])),action_objects:C.action_objects,title:C.title,confirmation_cancel_label:E[0],confirmation_continue_label:E[1],confirmation_message:E[2],confirmation_title:E[3],id:C.id,is_disabled:C.is_disabled,is_mutable_by_server:C.is_mutable_by_server,payment_metadata:F==null?{payment_module_config:null,total_price:null}:{payment_module_config:F.payment_module_config,total_price:F.total_price},render_style:C.render_style,webview_metadata:{fallback_url:C.webview_metadata.fallback_url,messenger_extensions:C.webview_metadata.messenger_extensions,webview_height_ratio:C.webview_metadata.webview_height_ratio,webview_share_button:C.webview_metadata.webview_share_button},should_show_user_confirmation:E[4],page_id:C.page_id}},B)}function e(B){return a("bs_array").map(function(C){var D=C.url,E=D==null?null:new(a("URI"))(D).getUnqualifiedURI().toString();return{title:C.title,uri:E}},B)}function fa(B){if(!(B==null)&&B!=="")return"#"+a("bs_string").sub(B,2,B.length-2|0);else return null}function ga(B){if(B==null)return null;else return{url:B.uri,src:B.uri,width:B.width,height:B.height}}function f(B,C){var D=C.cover_photo,E;if(D==null)E=[null,null,null];else{var F=D.photo.image,G=F==null?[null,null]:[F.uri,{height:F.height,width:F.width}];E=[D.photo.id,G[0],G[1]]}var H=C.location,I=H==null?[null,null]:[H.latitude,H.longitude],J=C.overall_star_rating;return{address:C.address.single_line_full_address,category:C.top_category_name,coverPhotoID:E[0],coverPhotoURL:E[1],coverPhotoDimensions:E[2],latitude:I[0],longitude:I[1],name:C.name,rating:J==null?null:J.value,pageID:C.id,priceRange:C.price_range_description,viewerID:B}}function g(B){var C=B.group_commerce_item_seller,D=B.primary_photo,E;if(D==null)E=null;else{var F=D.image;E=F==null?null:F.uri}return{caption:B.group_commerce_item_description.text,desc:B.group_commerce_item_description.text,owner_id:C==null?null:C.id,price:B.formatted_price.text,text:B.group_commerce_item_description.text,title:B.group_commerce_item_title,thumb_url:E,url:B.url}}function h(B){return{app_name:B.application_name,artists:B.artist_names,audio_url:B.audio_url,duration_ms:B.duration_ms,title:B.music_title}}function i(B){var C=B.payment;return{id:B.id,desc:B.desc,display_total_cost:B.total_cost,merchant_name:B.merchant_name,target_url:B.target_url,thumb_url:B.thumb_url,raw_amount:B.raw_amount,payment_id:C==null?null:C.id,total_cost:{amount:a("bs_caml_format").caml_float_of_string(B.price_amount),currency:B.price_currency},name:B.name}}function j(B){return{fundraiserID:B.fundraiserID,canDonate:B.canDonate,hasViewerDonated:B.hasViewerDonated,fundraiserDetailedProgressText:B.fundraiserDetailedProgressText,fundraiserSubtitleText:B.fundraiserSubtitleText,focusedCoverPhoto:B.focusedCoverPhoto}}function k(B){return{id:B.id,name:B.name,desc:B.desc,thumb_url:B.thumb_url,item_url:B.item_url,title:B.name,text:B.desc,source:B.source,image_aspect_ratio:B.image_aspect_ratio,metalines:{metaline_1:B.first_metaline,metaline_2:B.second_metaline,metaline_3:B.third_metaline},default_action:B.default_action,call_to_actions:d(B.call_to_actions)}}function l(B){__p&&__p();var C=function C($){var E=$.page_call_to_action;if(E==null)return undefined;else return E.id},D=function D($){var E=$.page_call_to_action;if(E==null)return false;else{var F=E.component_flow_service_config;if(F==null)return false;else return true}},E=B.page,F=E==null?[undefined,undefined,undefined,false]:[E.id,a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("ServicesCalendarSyncType")[E.calendar_sync_type])),C(E),D(E)],G=B.native_component_flow_request,H;if(G==null)H=null;else{var I=G.page,J=G.page,K=G.page,L;if(K==null)L=undefined;else{var M=K.profile_picture;L=M==null?undefined:M.uri}var N=G.suggested_time_range,O=G.product_item,P=G.product_item,Q=G.product_item,R=G.product_item,S;if(R==null)S=undefined;else{var T=R.profile_picture;S=T==null?undefined:T.uri}var U=G.user,V=G.user,W=G.job_application,X=G.user,Y;if(X==null)Y=undefined;else{var ha=X.profile_picture;Y=ha==null?undefined:ha.uri}H={additionalInfo:G.additional_info,archivedStatus:G.archived_status,availability:G.availability,hasSavedToCalendar:G.has_saved_to_calendar,requestFlowType:G.request_flow_type,generalInfo:G.service_general_info,id:G.id,pageID:I==null?undefined:I.id,pageName:J==null?undefined:J.name,pageProfilePic:L,preferredTimeRange:N==null?null:{end:N.end,start:N.start},price:O==null?null:O.experimental_freeform_price,duration:P==null?null:P.duration_in_seconds,requestAdminApprovalType:G.request_admin_approval_type,requestedTime:G.requested_time,serviceName:Q==null?null:Q.name,serviceProfilePic:S,specialRequest:G.special_request,status:G.booking_status_value,statusLabel:G.status,userID:U==null?undefined:U.id,username:V==null?undefined:V.short_name,jobApplicationID:W==null?undefined:W.id,userProfilePic:Y}}var ia=B.message_bubble_type,Z;switch(ia){case"CANCELLED":Z=["Cancelled",c._("\u0110a\u0303 hu\u0309y")];break;case"DECLINED":Z=["Declined",c._("\u0110\u00e3 t\u1eeb ch\u1ed1i")];break;case"REQUESTED":Z=["Requested",c._("\u0110\u00e3 y\u00eau c\u1ea7u")];break;case"SCHEDULEED":Z=["Scheduled",c._("\u0110\u00e3 l\u00ean l\u1ecbch")];break;default:throw[a("bs_caml_builtin_exceptions").invalid_argument,"Erroneous target status"]}return{id:B.id,pageID:F[0],calendarSyncType:F[1],ctaID:F[2],hasServiceConfig:F[3],userID:B.user.id,status:Z[0],statusLabel:Z[1],viewerID:a("CurrentUser").getAccountID(),requestMetadata:H}}function m(B){return{live_location_id:B.live_location_id,is_expired:B.is_expired,expiration_time:B.expiration_time,sender:B.sender,coordinate:B.coordinate,location_title:B.location_title,sender_destination:B.sender_destination,stop_reason:B.stop_reason}}function n(B){var C=B.first_metaline;return{desc:B.description,id:B.id,image_aspect_ratio:B.image_aspect_ratio,item_url:B.target_url,metalines:C==null?{}:{metaline_1:C},name:B.name,source:B.source_name,text:B.description,thumb_url:B.image_url,title:B.name,default_action:B.default_action,call_to_actions:d(B.call_to_actions),media_blob_attachments:B.media_blob_attachments}}function o(B){var C=a("bs_array").map(n,B.business_items.nodes),D=d(B.call_to_actions);return{message:B.message,call_to_actions:D,items:C}}function p(B){return{message:B.message,call_to_actions:d(B.call_to_actions),items:a("bs_array").map(n,B.promotion_items.nodes)}}function q(B){var C=B.structured_address.streets,D=B.partner_logo;return{account_holder_name:B.account_holder_name,adjustments:a("bs_array").map(function(E){return{adjustment_type:E.adjustment_type,display_adjustment_amount:E.adjustment_amount}},B.adjustments),cancellation_url:B.cancellation_url,items:a("bs_array").map(n,B.items.nodes),merchant_name:B.merchant_name,messenger_commerce_bubble_type:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("MNCommerceBubbleType")[B.messenger_commerce_bubble_type])),order_id:B.order_id,order_time:B.order_time,order_url:B.order_url,payment_method:B.payment_method,receipt_id:B.receipt_id,recipient_name:B.recipient_name,shipping_cost:B.shipping_cost,shipping_method:B.shipping_method,status:B.status,structured_address:{city:B.structured_address.city,state:B.structured_address.state,country:B.structured_address.country,postal_code:B.structured_address.postal_code,street_1:a("bs_caml_array").caml_array_get(C,0),street_2:a("bs_caml_array").caml_array_get(C,1)},subtotal:B.subtotal,total_cost:B.total_cost,total_tax:B.total_tax,partner_logo:D==null?undefined:D.uri}}function r(B,C){return{payment_modules_client:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("PaymentModulesClient")[C.payment_modules_client])),is_viewer_seller:C.is_viewer_seller,payment_snippet:C.payment_snippet,item_list:a("bs_array").map(function(D){return{item_id:D.item_id,name:D.name,subtitle:D.subtitle,description:D.description,unit_price:D.unit_price,image_urls:a("bs_array").map(function(E){return E.uri},D.images),quantity:D.quantity}},C.item_list),components:C.components,payment_call_to_actions:C.payment_call_to_actions,click_action:C.click_action,actor_id:B,invoicer_id:C.invoicer_id}}var s=function s(B){__p&&__p();var C=a("LeadGenInfoFieldTypes"),D={},E=[];for(var F=B.field_data_list,G=Array.isArray(F),H=0,F=G?F:F[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var I;if(G){if(H>=F.length)break;I=F[H++]}else{H=F.next();if(H.done)break;I=H.value}var J=I,K=J.field_type,L=J.label,M=J.values;if(K===C.CUSTOM||K===C.ZIP)E.push({label:L,values:M});else D[K]={label:L,values:M}}D.questions=E;return D};function t(B,C){var D=C.invite_recipient,E=D==null?null:D.id,F=C.invite_sender,G=F==null?null:F.id;return{quick_invite_id:C.id,recipient_id:E,sender_id:G,is_viewer_recipient:B===E}}function u(B){var C=function C(F){if(F==null)return null;else return F.uri},D=B.listing_category,E=D==null?[null,null]:[D.offer_image,D.request_image];return{listingType:B.listing_type,mapURI:C(B.map_image),offerURI:C(E[0]),requestURI:C(E[1])}}function v(B){return{sender:B.sender,receiver:B.receiver,transfer_id:B.transfer_id,bubbleView:B.bubble_view}}function w(B){__p&&__p();var C=B.receiver_profile,D;if(C==null)D=null;else{var E=C.profile_picture;D={id:C.id,name:C.short_name,full_name:C.name,picture:E==null?null:E.uri,profile_url:C.url}}var F=B.sender,G;if(F==null)G={};else{var H=F.profile_picture;G={id:F.id,name:F.name,full_name:F.full_name,picture:H==null?null:H.uri,profile_uri:F.url}}var I=B.transfer_context,J;if(I==null)J=[null,null,null];else{var K=I.transfer_theme;J=[I.memoText,a("bs_array").map(function(N){var C=N.image;if(C==null)return null;else return C.uri},I.memo_images),K==null?null:K.id]}var L=B.platform_item,M=L==null?null:{name:L.name,description:L.description,image:a("bs_array").map(function(N){var C=N.image;if(C==null)return null;else return C.uri},L.photos),refURL:L.url};return{sender:G,amountWithSymbol:B.transaction_amount.formatted_amount,status:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("P2PTransferStatus")[B.transfer_status])),receiver:D,transfer_id:B.transfer_id,completedTime:B.completedTime,updatedTime:B.updatedTime,creationTime:B.creationTime,amount:B.transaction_amount.amount,memoText:J[0],memoPhotoURLs:J[1],themeID:J[2],discountAmount:B.amount_fb_discount.formatted,fundsAvailability:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("FundsAvailability")[B.funds_availability])),groupThreadFBID:B.group_thread_fbid,platform_item:M,statusDescription:{markup:B.status_description},bubbleView:B.bubble_view,currencyCode:B.currency_amount.currency}}function x(B){__p&&__p();var C=B.requester,D;if(C==null)D=undefined;else{var E=C.profile_picture;D={id:C.id,name:C.short_name,full_name:C.name,picture:E==null?null:E.uri,profile_url:C.url}}var F=B.requestee,G;if(F==null)G=undefined;else{var H=F.profile_picture;G={id:F.id,name:F.short_name,full_name:F.name,picture:H==null?null:H.uri,profile_url:F.url}}var I=a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("P2PPaymentRequestStatus")[B.request_status])),J=B.transfer,K=J==null?[null,""]:[w(J),J.id],L=B.request_theme;return{amount:B.transaction_amount.amount,amountWithSymbol:B.amount.formatted,requestee:G,requester:D,currentStatus:I,currency:B.amount.currency,creationTime:B.creation_time,groupThreadFBID:B.group_thread_fbid,id:B.id,memoText:B.memo_text,themeID:L==null?null:L.id,transfer:K[0],transferID:K[1],updatedTime:B.updated_time,bubbleView:B.bubble_view,statusDescription:{markup:B.status_description}}}function y(B){var C=x({amount:B.amount,transaction_amount:B.transaction_amount,requester:B.requester,requestee:B.requestee,request_status:B.request_status,request_theme:B.request_theme,id:B.id,memo_text:B.memo_text,transfer:B.transfer,creation_time:B.creation_time,group_thread_fbid:B.group_thread_fbid,updated_time:B.updated_time,bubble_view:B.bubble_view,status_description:B.status_description}),D={individualRequests:a("bs_array").map(x,B.individual_requests)};return Object.assign(C,D)}function z(B,C){__p&&__p();var D=C.media,E=D==null?null:D.animated_image,F=D==null?null:D.image,G={};a("bs_array").iter(function(U){var H=U.value;G[U.key]=H==null?null:H.text;return 0},C.properties);var H=C.target,I;if(H==null)I=null;else switch(H.tag|0){case 0:I=u(H[0]);break;case 1:I=v(H[0]);break;case 2:I=w(H[0]);break;case 3:I=y(H[0]);break;case 4:I=r(B,H[0]);break;case 7:I=p(H[0]);break;case 8:I=o(H[0]);break;case 10:I=s(H[0]);break;case 11:I=m(H[0]);break;case 12:I=t(B,H[0]);break;case 13:I=l(H[0]);break;case 14:var J=H[0],K=J.genie_sender,L=K==null?[null,null]:[K.messaging_actor.id,K.messaging_actor.name],M=L[0],N=J.story_attachment,O=N==null?null:A(B,{legacy_attachment_id:M,story_attachment:{action_links:N.action_links,messaging_attribution:N.messaging_attribution,messenger_call_to_actions:N.messenger_call_to_actions,deduplication_key:N.deduplication_key,description:N.description,media:N.media,properties:N.properties,source:N.source,style_list:N.style_list,title_with_entities:N.title_with_entities,url:N.url,subattachments:[],target:null}});I={genie_id:M,genie_name:L[1],attachment:O};break;case 16:I=h(H[0]);break;case 18:I=k(H[0]);break;case 19:I=i(H[0]);break;case 20:I=j(H[0]);break;case 21:I=q(H[0]);break;case 23:I=g(H[0]);break;case 24:I=f(B,H[0]);break;default:I=H[0]}var P=C.target,Q=!(P==null)&&P.tag===7?0:null,R=C.description,S=C.source,T=C.title_with_entities;return{description:R==null?null:R.text,media:{animated_image:E==null?null:E.uri,animated_image_size:E==null?{height:null,width:null}:{height:E.height,width:E.width},image:F==null?null:F.uri,image_size:F==null?{height:null,width:null}:{height:F.height,width:F.width},duration:D==null?null:D.playable_duration,playable:D==null?null:D.is_playable,source:D==null?null:D.playable_url},source:S==null?null:S.text,style_list:C.style_list,title:T==null?null:T.text,action_links:e(C.action_links),messaging_attribution:C.messaging_attribution,messenger_ctas:a("bs_array").map(function(U){return{id:U.id,page_id:a("Utils.bs").$pipe$unknown(a("bs_js_primitive").null_undefined_to_opt(U.page_id),""),action_title:U.title,action_url:U.action_link,action_open_type:a("bs_js_null_undefined").fromOption(a("bs_js_primitive").undefined_to_opt(a("MNCommerceCallToActionType")[U.action_open_type])),is_high_confidence:a("Utils.bs").$pipe$unknown(a("bs_js_primitive").null_undefined_to_opt(U.is_high_confidence),false),is_mutable_by_server:U.is_mutable_by_server,native_url:U.native_url,is_disabled:U.is_disabled,webview_metadata:{fallback_url:U.webview_metadata.fallback_url,messenger_extensions:U.webview_metadata.messenger_extensions,webview_height_ratio:U.webview_metadata.webview_height_ratio,webview_share_button:U.webview_metadata.webview_share_button}}},C.messenger_call_to_actions),properties:G,uri:C.url,deduplication_key:C.deduplication_key,target:I,label:Q}}function A(B,C){var D=C.story_attachment,E;if(D==null)E=null;else{var F={share_id:C.legacy_attachment_id,subattachments:a("bs_array").map(function(H){return z(B,H)},D.subattachments)},G={description:D.description,media:D.media,source:D.source,style_list:D.style_list,title_with_entities:D.title_with_entities,properties:D.properties,url:D.url,deduplication_key:D.deduplication_key,action_links:D.action_links,messaging_attribution:D.messaging_attribution,messenger_call_to_actions:D.messenger_call_to_actions,target:D.target};E=Object.assign(F,z(B,G))}return{app_attribution:null,attach_type:a("MercuryAttachmentType").SHARE,name:null,url:null,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:null,metadata:null,share:E,thumbnail_url:null}}b._getCallToActions=d;b._getActionLinks=e;b._getColor=fa;b._getLogo=ga;b._getPageTarget=f;b._getGroupCommerceProductItemTarget=g;b._getExternalSongTarget=h;b._getAgentSuggestionItemTarget=i;b._getFundraiserTarget=j;b._getRetailItemTarget=k;b._getPagesPlatformBookingMessageTarget=l;b._getMessageLiveLocationTarget=m;b._getBusinessRetailItem=n;b._getMessengerBusinessMessageTarget=o;b._getMessengerRetailPromotionTarget=p;b._getMessengerRetailReceiptTarget=q;b._getPagesPlatformAttachmentTarget=r;b._getPagesPlatformLeadGenInfoTarget=s;b._getQuickInviteTarget=t;b._getCrisisListingTarget=u;b._getMoneyTransferTarget=v;b._getP2PTransferTarget=w;b._getP2PTransferRequestTarget=x;b._getP2PTransferRequestWithIndividualRequests=y;b.transformStoryAttachment=z;b.getExtensibleAttachmentPayload=A}),null);
__d("MessengerAttachmentTransformer.bs",["fbt","bs_array","bs_caml_primitive","MercuryAttachmentType","MercuryAttachmentContentType","MessengerStoryAttachmentTransformer.bs"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(q){__p&&__p();if(q.is_malicious)return{app_attribution:null,icon_type:c("MercuryAttachmentContentType").UNKNOWN,metadata:null,name:null,preview_height:null,preview_url:null,preview_width:null,rel:null,share:null,thumbnail_url:null,url:null,attach_type:c("MercuryAttachmentType").ERROR,error_msg:h._("T\u1ec7p \u0111\u00ednh k\u00e8m n\u00e0y \u0111\u00e3 b\u1ecb \u0111\u00e1nh d\u1ea5u l\u00e0 \u0111\u1ed9c h\u1ea1i."),message_file_fbid:null,url_shimhash:null,url_skipshim:null};else{var r=q.attribution_app,s;if(r==null)s=null;else{var t=r.square_logo;s={id:r.id,icon_url:t==null?null:t.uri,metadata:q.attribution_metadata,name:r.name}}var u=q.url;return{app_attribution:s,icon_type:q.content_type,metadata:null,name:q.filename,preview_height:null,preview_url:null,preview_width:null,rel:"ignore",share:null,thumbnail_url:null,url:u==null?null:u,attach_type:c("MercuryAttachmentType").FILE,error_msg:undefined,message_file_fbid:q.message_file_fbid,url_shimhash:q.url_shimhash,url_skipshim:q.url_skipshim}}}function j(q,r,s){var t=q.chat_image,u=t==null?[null,null,null]:[t.uri,t.width,t.height],v=u[0],w=q.chat_image,x=w==null?null:{width:w.width,height:w.height},y=q.large_image,z=y==null?[null,null]:[y.uri,{width:y.width,height:y.height}],A=q.inbox_image,B=A==null?[null,null]:[A.uri,{width:A.width,height:A.height}],C=q.attribution_app,D;if(C==null)D=null;else{var E=C.square_logo;D={id:C.id,icon_url:E==null?null:E.uri,metadata:q.attribution_metadata,name:C.name}}return{app_attribution:D,attach_type:c("MercuryAttachmentType").VIDEO,name:q.filename,url:q.playable_url,rel:"async",preview_url:v,preview_width:u[1],preview_height:u[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c("MercuryAttachmentContentType").VIDEO,metadata:{fbid:q.legacy_attachment_id,render_as_sticker:q.video_type==="SPEAKING_STICKER",dimensions:{width:q.original_dimensions.x,height:q.original_dimensions.y},duration:q.playable_duration_in_ms,large_size:z[1],large_preview:z[0],chat_size:x,chat_preview:v,inbox_size:B[1],inbox_preview:B[0],pageid:s?r:undefined},thumbnail_url:v,share:null}}function k(q){var r=q.attribution_app,s;if(r==null)s=null;else{var t=r.square_logo;s={id:r.id,icon_url:t==null?null:t.uri,metadata:q.attribution_metadata,name:r.name}}return{app_attribution:s,attach_type:c("MercuryAttachmentType").FILE,name:q.filename,url:q.playable_url,rel:"ignore",preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c("MercuryAttachmentContentType").MUSIC,metadata:{duration:q.playable_duration_in_ms,isVoicemail:q.is_voicemail?"1":"0",type:q.audio_type==="VOICE_MESSAGE"?"fb_voice_message":q.audio_type==="VOICE_MESSAGE_WITH_TRANSCRIPT"?"fb_voice_message_with_transcript":"file_attachment"},thumbnail_url:null,share:null,url_shimhash:q.url_shimhash,url_skipshim:q.url_skipshim}}function l(q,r,s){var t=q.preview_image,u=t==null?[null,null,null]:[t.uri,t.width,t.height],v=q.animated_image,w=v==null?null:v.uri,x=q.attribution_app,y;if(x==null)y=null;else{var z=x.square_logo;y={id:x.id,icon_url:z==null?null:z.uri,metadata:q.attribution_metadata,name:x.name}}return{app_attribution:y,attach_type:c("MercuryAttachmentType").ANIMATED_IMAGE,name:q.filename,url:w,rel:"async",preview_url:u[0],preview_width:u[1],preview_height:u[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c("MercuryAttachmentContentType").PHOTO,metadata:{fbid:q.legacy_attachment_id,image:w,dimensions:String(q.original_dimensions.x)+(","+String(q.original_dimensions.y)),pageid:s?r:undefined},thumbnail_url:w,share:null}}function m(q){__p&&__p();var r=q.original_extension==="gif"?c("MercuryAttachmentType").ANIMATED_IMAGE:q.render_as_sticker?c("MercuryAttachmentType").THIRDPARTYSTICKER:c("MercuryAttachmentType").PHOTO,s=q.preview,t=s==null?[null,null,null]:[s.uri,s.width,s.height],u;if(r===c("MercuryAttachmentType").PHOTO){var v=q.large_preview;u=v==null?[null,null,null]:[v.uri,v.width,v.height]}else u=[null,null,null];var w=q.attribution_app,x;if(w==null)x=null;else{var y=w.square_logo;x={id:w.id,icon_url:y==null?null:y.uri,metadata:q.attribution_metadata,name:w.name}}var z=q.thumbnail;return{app_attribution:x,attach_type:r,name:q.filename,url:null,rel:"async",preview_url:t[0],preview_width:t[1],preview_height:t[2],large_preview_url:u[0],large_preview_width:u[1],large_preview_height:u[2],icon_type:c("MercuryAttachmentContentType").PHOTO,metadata:{fbid:q.legacy_attachment_id,dimensions:String(q.original_dimensions.x)+(","+String(q.original_dimensions.y))},thumbnail_url:z==null?null:z.uri,share:null,photo_encodings:q.photo_encodings}}function n(q,r){var s=q,t=r;if(q>=r){var u=c("bs_caml_primitive").caml_float_min(120,s/2),v=u/(s/2);return[u|0,t/2*v|0]}else{var w=c("bs_caml_primitive").caml_float_min(120,t/2),x=w/(t/2);return[s/2*x|0,w|0]}}function o(q){var r=n(q.width,q.height),s=q.pack,t=q.sprite_image,u=q.sprite_image_2x,v=q.padded_sprite_image,w=q.padded_sprite_image_2x;return{app_attribution:null,attach_type:c("MercuryAttachmentType").STICKER,name:null,url:q.url,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:c("MercuryAttachmentContentType").UNKNOWN,metadata:{accessibilityLabel:q.label,stickerID:q.id,packID:s==null?null:s.id,frameCount:q.frame_count,frameRate:q.frame_rate,framesPerRow:q.frame_count>1?q.frames_per_row:1,framesPerCol:q.frame_count>1?q.frames_per_column:1,height:r[1],width:r[0],spriteURI:t==null?null:t.uri,spriteURI2x:u==null?null:u.uri,paddedSpriteURI:v==null?null:v.uri,paddedSpriteURI2x:w==null?null:w.uri,thumbnail_url:null,share:null}}}function p(q,r,s){__p&&__p();var t=[],u=r.extensible_attachment;if(!(u==null))t.push(c("MessengerStoryAttachmentTransformer.bs").getExtensibleAttachmentPayload(q,u));var v=r.sticker;if(!(v==null))t.push(o(v));var w=r.blob_attachments;if(!(w==null))c("bs_array").iter(function(x){__p&&__p();switch(x.tag|0){case 0:t.push(m(x[0]));return 0;case 1:t.push(l(x[0],q,s));return 0;case 2:t.push(k(x[0]));return 0;case 3:t.push(j(x[0],q,s));return 0;case 4:t.push(i(x[0]));return 0}},w);return t}g._getFilePayload=i;g._getVideoPayload=j;g._getAudioPayload=k;g._getAnimatedImagePayload=l;g._getImagePayload=m;g._getStickerDimensions=n;g._getStickerPayload=o;g.transformAttachment=p}),null);
__d("InstantGameUpdateXMATUpdateType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({UNKNOWN:"unknown",GAME_SCORE:"game_score",CUSTOM_MESSAGE:"custom_message"})}),null);
__d("MNCommerceMessageType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({TEXT:"text",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",ROBOT_TEXT:"robot_text",LOCATION:"location",FORCED_FETCH_MESSAGE:"forced_fetch_message",SENDER_ACTION:"sender_action",RETAIL_PRODUCT_SUBSCRIPTION:"retail_product_subscription",RETAIL_PROMOTION:"retail_promotion",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_SHIPMENT:"retail_shipment",SHIPMENT_TRACKING_EVENT:"shipment_tracking_event",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_CHECKIN:"airline_checkin",AIRLINE_BOARDINGPASS:"airline_boardingpass",AIRLINE_UPDATE:"airline_update",AIRLINE_ITINERARY:"airline_itinerary",CONTENT_SUBSCRIPTION:"content_subscription",AD_ADMIN_TEXT:"ad_admin_text",AD_TEXT:"ad_text",AD_BUBBLE:"ad_bubble",NON_AD:"non_ad",UNKNOWN:"unknown",OTHER:"other",TEMPLATE:"template",OPEN_GRAPH:"open_graph",GENERIC:"generic",LIST:"list",COMPACT_LIST:"compact_list",BUTTON:"button",RECEIPT:"receipt",GENERIC_LEGACY:"generic_legacy",ICE_BREAKER:"ice_breaker",FALLBACK:"fallback",RIDE_INTENT:"ride_intent",RIDE_SIGNUP:"ride_signup",RIDE_WELCOME:"ride_welcome",RIDE_ORDER_CONFIRMATION:"ride_order_confirmation",RIDE_REQUESTED:"ride_requested",RIDE_DRIVER_ON_THE_WAY:"ride_driver_on_the_way",RIDE_NO_DRIVER:"ride_no_driver",RIDE_DRIVER_ARRIVING:"ride_driver_arriving",RIDE_DRIVER_CANCELED:"ride_driver_canceled",RIDE_RIDER_CANCELED:"ride_rider_canceled",RIDE_COMPLETE:"ride_complete",RIDE_ADMIN_MESSAGE:"ride_admin_message",RIDE_RECEIPT:"ride_receipt",RIDE_REENGAGEMENT_FIRST_RIDE:"ride_reengagement_first_ride",GET_RIDE:"give_get_ride",GIVE_RIDE:"send_give_get_ride",REFERER_PROMO:"referer_promo",INSTANT_GAMES_SHARE:"instant_games_share",INSTANT_GAMES_SCORE:"instant_games_score",INSTANT_GAMES_LIVE_STREAM:"instant_games_live_stream",LINK:"link_admin_message",UNLINK:"unlink_admin_message",BLOCK_ALL:"block_all_admin_message",UNBLOCK_ALL:"unblock_all_admin_message",BLOCK_PROMOTION:"block_promotion_admin_message",UNBLOCK_PROMOTION:"unblock_promotion_admin_message",INITIAL_PROMOTION:"initial_promotion_admin_message",WEAK_CONSENT_ADMIN_MESSAGE:"weak_consent_admin_message",MESSENGER_TEAM_BOT_MESSAGE:"messenger_team_bot",MESSENGER_BOT_BASE_GENERIC:"messenger_bot_base_generic",COMMERCE_COMPACT_LIST:"commerce_compact_list",FEEDBACK:"feedback",MEDIA:"media",PLACE_CARD:"place_card"})}),null);
__d("MessagingTagUtils",["MessagingSourceEnum","MessagingTagConstants","MercuryMessageSourceTags"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=new Set(Object.values(c("MessagingSourceEnum")));function i(l){__p&&__p();for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p;if(h.has(q))return q}return c("MessagingSourceEnum").UNKNOWN}function j(l){__p&&__p();for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p,r=q.split(c("MessagingTagConstants").app_id_root);if(r.length>1)return r[1].trim()}return null}function k(l,m){__p&&__p();var n=[],o=j(l);if(o&&c("MessagingTagConstants").orca_app_ids.indexOf(o)!==-1)n.push(c("MercuryMessageSourceTags").MESSENGER);if(c("MessagingTagConstants").chat_sources.indexOf(m)!==-1)n.push(c("MercuryMessageSourceTags").CHAT);if(c("MessagingTagConstants").email_source===m)n.push(c("MercuryMessageSourceTags").EMAIL);if(c("MessagingTagConstants").mobile_sources.indexOf(m)!==-1)n.push(c("MercuryMessageSourceTags").MOBILE);return n}f.exports={getSourceFromTags:i,getSourceTags:k}}),null);
__d("P2PPaymentLogMessageSubtype",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SENT_IN_GROUP:"sent_in_group",CANCELED_SENDER_RISK:"canceled_sender_risk",CANCELED_DECLINED:"canceled_declined",CANCELED_RECIPIENT_RISK:"canceled_recipient_risk",CANCELED_EXPIRED:"canceled_expired",CANCELED_SAME_CARD:"canceled_same_card",CANCELED_CUSTOMER_SERVICE:"canceled_customer_service",CANCELED_CHARGEBACK:"canceled_chargeback",CANCELED_SYSTEM_FAIL:"canceled_system_fail",REQUEST_CANCELED_BY_REQUESTER:"request_canceled_by_requester",REQUEST_DECLINED_BY_REQUESTEE:"request_declined_by_requestee",REQUEST_EXPIRED:"request_expired",REQUEST_REMINDER:"request_reminder",MONEY_RAIN_GAME_ENTRY_POINT:"money_rain_game_entry_point"})}),null);
__d("MessengerMessageTransformer.bs",["bs_array","bs_block","bs_string","FBIDCheck","getByPath","MercuryIDs","bs_caml_format","CurrentUser","bs_js_primitive","MessagingTag","bs_js_null_undefined","MercuryActionType","MessagingTagUtils","MessagingSourceEnum","StoryAttachmentStyle","MNCommerceMessageType","MercuryLogMessageType","P2PPaymentLogMessageSubtype","MessagingGenericAdminTextType","MessengerAttachmentTransformer.bs","InstantGameUpdateXMATUpdateType"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(o,p,q){__p&&__p();var r;if(o.__typename==="GroupPollExtensibleMessageAdminText"){var s=o.question,t;if(s==null)t=[{},null];else{var u=Object.assign({},s);Object.assign(u,{total_count:o.total_count,options:c("bs_array").map(function(v){var w=Object.assign({},v);return Object.assign(w,{total_count:v.voters.nodes.length,voters:c("bs_array").map(function(x){return x.id},v.voters.nodes)})},s.options.nodes)});t=[u,s.id]}r={message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[p])),untypedData:{event_type:c("bs_string").lowercase(o.event_type),question_id:t[1],question_json:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(JSON.stringify(t[0])))}}}else r=o.__typename==="InstantGameUpdateExtensibleMessageAdminText"?{message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[p])),untypedData:{game_id:c("getByPath")(o,["game","id"]),update_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("InstantGameUpdateXMATUpdateType")[o.update_type])),collapsed_text:o.collapsed_text,expanded_text:o.expanded_text,leaderboard_json:o.leaderboard_json,cta_url:c("getByPath")(o,["instant_game_update_data","cta_url"]),cta_title:c("getByPath")(o,["instant_game_update_data","cta_title"]),custom_image_url:c("getByPath")(o,["instant_game_update_data","photo","image","uri"]),template:c("getByPath")(o,["instant_game_update_data","template"])}}:o.__typename==="MessengerAdContextAdminText"?{message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[p])),untypedData:{ad_url:o.ad_url}}:o.__typename==="AdExtensibleMessageAdminText"?{message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[p])),untypedData:{ad_client_token:o.ad_client_token,ad_id:o.ad_id,ad_preferences_link:o.ad_preferences_link,ad_properties:o.ad_properties}}:o.__typename==="ThemeColorExtensibleMessageAdminText"||o.__typename==="ThreadIconExtensibleMessageAdminText"||o.__typename==="ThreadNicknameExtensibleMessageAdminText"||o.__typename==="AcceptPendingThreadExtensibleMessageAdminText"||o.__typename==="AddContactExtensibleMessageAdminText"||o.__typename==="RtcCallLogExtensibleMessageAdminText"||o.__typename==="GameScoreExtensibleMessageAdminText"||o.__typename==="ConfirmFriendRequestExtensibleMessageAdminText"||o.__typename==="PartiesInviteExtensibleMessageAdminText"||o.__typename==="AppointmentReminderExtensibleMessageAdminText"||o.__typename==="GraphQLServicesAppointmentsOptOutExtensibleMessageAdminText"||o.__typename==="ServicesLeadGenSurveyExtensibleMessageAdminText"||o.__typename==="ServicesLeadGenSurveyEditExtensibleMessageAdminText"||o.__typename==="PagesPlatformCreateAppointmentExtensibleMessageAdminText"?{message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[p])),untypedData:Object.assign({},o)}:{message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[p])),untypedData:undefined};return{log_message_body:q,log_message_data:r,log_message_type:c("MercuryLogMessageType").GENERIC_ADMIN_TEXT}}function i(o){return c("bs_array").map(function(p){if(p==="p2p_transfer")return c("StoryAttachmentStyle").ORION;else if(p==="p2p_payment_request")return c("StoryAttachmentStyle").ORION_REQUEST;else return p},o)}function j(o){__p&&__p();var p=o.target,q;if(p==null)q=null;else if(p.__typename==="CrisisListing")q=c("bs_block").__(0,[{listing_type:p.listing_type,listing_category:p.listing_category,map_image:p.map_image}]);else if(p.__typename==="MoneyTransfer")q=c("bs_block").__(1,[{sender:p.sender,receiver:p.receiver,transfer_id:p.transfer_id,bubble_view:p.bubble_view}]);else if(p.__typename==="PeerToPeerTransfer")q=c("bs_block").__(2,[{sender:p.sender,receiver_profile:p.receiver_profile,transaction_amount:p.transaction_amount,transfer_status:p.transfer_status,transfer_id:p.transfer_id,completedTime:p.completedTime,updatedTime:p.updatedTime,creationTime:p.creationTime,transfer_context:p.transfer_context,amount_fb_discount:p.amount_fb_discount,funds_availability:p.funds_availability,group_thread_fbid:p.group_thread_fbid,platform_item:p.platform_item,id:p.id,status_description:p.status_description,bubble_view:p.bubble_view,currency_amount:p.currency_amount}]);else if(p.__typename==="PeerToPeerPaymentRequest")q=c("bs_block").__(3,[{amount:p.amount,transaction_amount:p.transaction_amount,requester:p.requester,requestee:p.requestee,request_status:p.request_status,request_theme:p.request_theme,id:p.id,memo_text:p.memo_text,transfer:p.transfer,creation_time:p.creation_time,group_thread_fbid:p.group_thread_fbid,updated_time:p.updated_time,status_description:p.status_description,bubble_view:p.bubble_view,individual_requests:p.individual_requests}]);else if(p.__typename==="PaymentPlatformAttachment")q=c("bs_block").__(4,[{payment_modules_client:p.payment_modules_client,is_viewer_seller:p.is_viewer_seller,payment_snippet:p.payment_snippet,item_list:p.item_list,components:p.components,payment_call_to_actions:p.payment_call_to_actions,click_action:p.click_action,invoicer_id:p.invoicer_id}]);else if(p.__typename==="MomentsAppMessengerInvitation")q=c("bs_block").__(5,[{snippet:p.snippet}]);else if(p.__typename==="MomentsAppMessengerPhotoRequest")q=c("bs_block").__(6,[{snippet:p.snippet}]);else if(p.__typename==="MessengerRetailPromotion")q=c("bs_block").__(7,[{message:p.message,call_to_actions:p.call_to_actions,promotion_items:p.promotion_items}]);else if(p.__typename==="MessengerBusinessMessage")q=c("bs_block").__(8,[{message:p.message,call_to_actions:p.call_to_actions,business_items:p.business_items}]);else if(p.__typename==="Video")q=c("bs_block").__(9,[{video_id:p.video_id}]);else if(p.__typename==="PagesPlatformLeadGenInfo")q=c("bs_block").__(10,[{field_data_list:p.field_data_list}]);else if(p.__typename==="MessageLiveLocation")q=c("bs_block").__(11,[{live_location_id:p.live_location_id,is_expired:p.is_expired,expiration_time:p.expiration_time,sender:p.sender,coordinate:p.coordinate,location_title:p.location_title,sender_destination:p.sender_destination,stop_reason:p.stop_reason}]);else if(p.__typename==="QuickInvite")q=c("bs_block").__(12,[{id:p.id,invite_sender:p.invite_sender,invite_recipient:p.invite_recipient}]);else if(p.__typename==="PagesPlatformBookingMessage")q=c("bs_block").__(13,[{id:p.id,page:p.page,message_bubble_type:p.message_bubble_type,user:p.user,native_component_flow_request:p.native_component_flow_request}]);else if(p.__typename==="GenieMessage")q=c("bs_block").__(14,[{genie_sender:p.genie_sender,story_attachment:p.story_attachment}]);else if(p.__typename==="Event")q=c("bs_block").__(15,[{eventID:p.eventID,guestStatus:p.guestStatus,canViewerJoin:p.canViewerJoin,timeString:p.timeString,event_place:p.event_place,social_context:p.social_context,watchStatus:p.watchStatus,connection_style:p.connection_style,canViewerWatch:p.canViewerWatch}]);else if(p.__typename==="ExternalSong")q=c("bs_block").__(16,[{application_name:p.application_name,artist_names:p.artist_names,audio_url:p.audio_url,duration_ms:p.duration_ms,music_title:p.music_title}]);else if(p.__typename==="LightweightAction")q=c("bs_block").__(17,[{lwa_state:p.lwa_state,lwa_type:p.lwa_type}]);else if(p.__typename==="MessengerRetailItem")q=c("bs_block").__(18,[{id:p.id,name:p.name,desc:p.desc,thumb_url:p.thumb_url,item_url:p.item_url,source:p.source,image_aspect_ratio:p.image_aspect_ratio,first_metaline:p.first_metaline,second_metaline:p.second_metaline,third_metaline:p.third_metaline,default_action:p.default_action,call_to_actions:p.call_to_actions}]);else if(p.__typename==="AgentItemSuggestion")q=c("bs_block").__(19,[{id:p.id,desc:p.desc,total_cost:p.total_cost,merchant_name:p.merchant_name,target_url:p.target_url,thumb_url:p.thumb_url,raw_amount:p.raw_amount,payment:p.payment,price_amount:p.price_amount,price_currency:p.price_currency,name:p.name}]);else if(p.__typename==="FundraiserPersonToCharity"||p.__typename==="FundraiserPersonForPerson"){var r=p.fundraiser_detailed_progress_text,s=p.fundraiser_subtitle_text,t=p.focused_cover_photo;q=c("bs_block").__(20,[{fundraiserID:p.id,canDonate:p.can_donate,hasViewerDonated:p.has_viewer_donated,fundraiserDetailedProgressText:r==null?null:r.text,fundraiserSubtitleText:s==null?null:s.text,focusedCoverPhoto:t==null?null:{src:t.photo.image.uri,data:{height:t.photo.image.height,width:t.photo.image.width}}}])}else q=p.__typename==="MessengerRetailReceipt"?c("bs_block").__(21,[{account_holder_name:p.account_holder_name,adjustments:p.retail_adjustments,cancellation_url:p.cancellation_url,items:p.retail_items,merchant_name:p.merchant_name,messenger_commerce_bubble_type:p.bubble_type,order_id:p.receipt_id,order_time:p.order_time_for_display,order_url:p.receipt_url,payment_method:p.order_payment_method,receipt_id:p.id,recipient_name:p.recipient_name,shipping_cost:p.shipping_cost,shipping_method:p.shipping_method,status:p.status,structured_address:p.structured_address,subtotal:p.subtotal,total_cost:p.total,total_tax:p.tax,partner_logo:p.partner_log}]):p.__typename==="JobApplication"?c("bs_block").__(22,[{id:p.id}]):p.__typename==="GroupCommerceProductItem"?c("bs_block").__(23,[{group_commerce_item_description:p.group_commerce_item_description,group_commerce_item_seller:p.group_commerce_item_seller,formatted_price:p.formatted_price,group_commerce_item_title:p.group_commerce_item_title,primary_photo:p.primary_photo,url:p.url}]):p.__typename==="Page"?c("bs_block").__(24,[{address:p.address,top_category_name:p.top_category_name,cover_photo:p.cover_photo,location:p.location,name:p.name,overall_star_rating:p.overall_star_rating,id:p.id,price_range_description:p.price_range_description}]):p.__typename==="MessengerEventReminder"?c("bs_block").__(25,[{is_active:p.is_active}]):p.__typename==="AirlineBoardingPassCollectionMessageAttachment"?c("bs_block").__(26,[{tint_color:p.tint_color,logo:p.logo,flight_label:p.flight_label,boarding_time_label:p.boarding_time_label,departure_label:p.departure_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,flight_terminal_label:p.flight_terminal_label,flight_gate_label:p.flight_gate_label,view_boarding_pass_cta_label:p.view_boarding_pass_cta_label,boarding_passes:p.boarding_passes,share_cta_label:p.share_cta_label,message_cta_label:p.message_cta_label,boarding_pass_title_label:p.boarding_pass_title_label,boarding_pass_error_title_label:p.boarding_pass_error_title_label}]):p.__typename==="AirlineCheckInReminderMessageAttachment"?c("bs_block").__(27,[{pnr_number:p.pnr_number,tint_color:p.tint_color,checkin_url:p.checkin_url,booking_number_label:p.booking_number_label,flight_label:p.flight_label,arrival_time_label:p.arrival_time_label,departure_time_label:p.departure_time_label,checkin_cta_label:p.checkin_cta_label,logo:p.logo,flight_infos:p.flight_infos}]):p.__typename==="AirlineUpdateMessageAttachment"?c("bs_block").__(28,[{pnr_number:p.pnr_number,tint_color:p.tint_color,update_type:p.update_type,departure_time_label:p.departure_time_label,arrival_time_label:p.arrival_time_label,booking_number_label:p.booking_number_label,flight_gate_label:p.flight_gate_label,flight_label:p.flight_label,flight_status_label:p.flight_status_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,logo:p.logo,flight_info:p.flight_info,hightlighted_labels:p.hightlighted_labels}]):p.__typename==="AirlineItineraryMessageAttachment"?c("bs_block").__(29,[{confirmation_number:p.confirmation_number,pnr_number:p.pnr_number,tint_color:p.tint_color,formatted_total:p.formatted_total,itemized_price_infos:p.itemized_price_infos,formatted_tax:p.formatted_tax,formatted_base_price:p.formatted_base_price,passenger_infos:p.passenger_infos,logo:p.logo,aircraft_type_label:p.aircraft_type_label,arrival_time_label:p.arrival_time_label,base_price_label:p.base_price_label,booking_number_label:p.booking_number_label,cabin_type_label:p.cabin_type_label,departure_time_label:p.departure_time_label,flight_confirmation_label:p.flight_confirmation_label,flight_date_label:p.flight_date_label,flight_label:p.flight_label,flight_terminal_label:p.flight_terminal_label,itinerary_error_title_label:p.itinerary_error_title_label,itinerary_title_label:p.itinerary_title_label,passenger_name_label:p.passenger_name_label,passenger_names_label:p.passenger_names_label,passenger_seat_label:p.passenger_seat_label,purchase_summary_label:p.purchase_summary_label,taxes_label:p.taxes_label,total_label:p.total_label,view_details_cta_label:p.view_details_cta_label,itinerary_legs:p.itinerary_legs}]):p.__typename==="MessengerRetailShipmentTrackingEvent"?c("bs_block").__(30,[{id:p.id,shipment:p.shipment,tracking_event_time_for_display:p.tracking_event_time_for_display,shipment_tracking_event_type:p.shipment_tracking_event_type,messenger_commerce_location:p.messenger_commerce_location,tracking_event_description:p.tracking_event_description,bubble_type:p.bubble_type}]):p.__typename==="MessengerRetailShipment"?c("bs_block").__(31,[{id:p.id,tracking_number:p.tracking_number,shipdate_for_display:p.shipdate_for_display,estimated_delivery_time_for_display:p.estimated_delivery_time_for_display,commerce_origin:p.commerce_origin,commerce_destination:p.commerce_destination,retail_carrier:p.retail_carrier,shipment_tracking_events:p.shipment_tracking_events,receipt:p.receipt,recipient:p.recipient,retail_shipment_items:p.retail_shipment_items,bubble_type:p.bubble_type}]):p.__typename==="TicketOrderAttachment"?c("bs_block").__(33,[{ticket_order_id:p.ticket_order_id,event:p.event}]):p.__typename==="LeadGenDeepLinkData"?c("bs_block").__(32,[{id:p.id,cover_image:p.cover_image,headline:p.headline,name:p.name,page:p.page}]):p.__typename==="UserLeadGenInfo"?c("bs_block").__(34,[{id:p.id,field_data:p.field_data}]):p.__typename==="IceBreakerMessageAttachment"?c("bs_block").__(35,[{ice_breaker_title:p.ice_breaker_title,ice_breaker_messages:p.ice_breaker_messages,ad_id:p.ad_id}]):p.__typename==="MontageDirect"?c("bs_block").__(36,[{message_state:p.message_state,is_keep_disabled:p.is_keep_disabled,blob_media_type:p.blob_media_type,blob_media:p.blob_media,image:p.image}]):p.__typename==="MBirthdayReminderAttachment"?c("bs_block").__(37,[{friend_id:p.friend_id,confidence:p.confidence,birthday_date:p.birthday_date}]):null;return{description:o.description,media:o.media,source:o.source,style_list:i(o.style_list),title_with_entities:o.title_with_entities,properties:o.properties,url:o.url,deduplication_key:o.deduplication_key,action_links:o.action_links,messaging_attribution:o.messaging_attribution,messenger_call_to_actions:o.messenger_call_to_actions,target:q}}function k(o){var p=j({description:o.description,media:o.media,source:o.source,style_list:o.style_list,title_with_entities:o.title_with_entities,properties:o.properties,url:o.url,deduplication_key:o.deduplication_key,action_links:o.action_links,messaging_attribution:o.messaging_attribution,messenger_call_to_actions:o.messenger_call_to_actions,target:o.target});if(p==null)return null;else{var q=c("bs_array").map(j,o.subattachments);return Object.assign({subattachments:q},p)}}function l(o){__p&&__p();var p=o.blob_attachments,q=[];if(!(p==null))c("bs_array").iter(function(r){__p&&__p();if(r.__typename==="MessageImage"){q.push(c("bs_block").__(0,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,preview:r.preview,large_preview:r.large_preview,thumbnail:r.thumbnail,legacy_attachment_id:r.legacy_attachment_id,original_dimensions:r.original_dimensions,original_extension:r.original_extension,render_as_sticker:r.render_as_sticker,photo_encodings:r.photo_encodings}]));return 0}else if(r.__typename==="MessageAnimatedImage"){q.push(c("bs_block").__(1,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,animated_image:r.animated_image,legacy_attachment_id:r.legacy_attachment_id,preview_image:r.preview_image,original_dimensions:r.original_dimensions}]));return 0}else if(r.__typename==="MessageAudio"){q.push(c("bs_block").__(2,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,playable_url:r.playable_url,playable_duration_in_ms:r.playable_duration_in_ms,is_voicemail:r.is_voicemail,audio_type:r.audio_type,url_shimhash:r.url_shimhash,url_skipshim:r.url_skipshim}]));return 0}else if(r.__typename==="MessageVideo"){q.push(c("bs_block").__(3,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,playable_url:r.playable_url,playable_duration_in_ms:r.playable_duration_in_ms,legacy_attachment_id:r.legacy_attachment_id,chat_image:r.chat_image,video_type:r.video_type,original_dimensions:r.original_dimensions,large_image:r.large_image,inbox_image:r.inbox_image}]));return 0}else if(r.__typename==="MessageFile"){q.push(c("bs_block").__(4,[{attribution_app:r.attribution_app,attribution_metadata:r.attribution_metadata,filename:r.filename,url:r.url,content_type:r.content_type,is_malicious:r.is_malicious,message_file_fbid:r.message_file_fbid,url_shimhash:r.url_shimhash,url_skipshim:r.url_skipshim}]));return 0}else return 0},p);return q}function m(o){__p&&__p();var p=o.message;if(p==null)return[];else{var q=[];c("bs_array").iter(function(r){__p&&__p();var p=r.entity;if(p==null)return 0;else{var s=p.id,t=p.thread_key;if(s==null)if(t==null)return 0;else{var u=t.thread_fbid;if(u==null)return 0;else{q.push({id:u,offset:r.offset,length:r.length,type:r.__typename});return 0}}else{q.push({id:s,offset:r.offset,length:r.length,type:r.__typename});return 0}}},p.ranges);return q}}function n(o,p,q,r){__p&&__p();var s={};c("bs_array").iter(function($){s[$.user.id]=$.reaction;return 0},p.message_reactions);var t=c("FBIDCheck").isUser_deprecated(p.message_sender.id),u=t?c("MessagingTagUtils").getSourceFromTags(p.tags_list):c("MessagingSourceEnum").UNKNOWN,v=t?c("MessagingTagUtils").getSourceTags(p.tags_list,u):[],w=p.commerce_message_type,x=p.customizations,y=p.replied_to_message,z;if(y==null)z=null;else{var A=y.message;z=A==null?null:c("bs_js_null_undefined").fromOption([n(o,A,q,r)])}var B={thread_id:q.thread_id,thread_fbid:q.thread_fbid,other_user_fbid:q.other_user_fbid,action_type:p.__typename==="UserMessage"?c("MercuryActionType").USER_GENERATED_MESSAGE:c("MercuryActionType").LOG_MESSAGE,message_id:p.message_id,threading_id:null,offline_threading_id:p.offline_threading_id,author:c("MercuryIDs").getParticipantIDFromUserID(p.message_sender.id),author_email:p.message_sender.email,ephemeral_ttl_mode:p.ttl,timestamp:c("bs_caml_format").caml_float_of_string(p.timestamp_precise),is_unread:p.unread,is_filtered_content:p.tags_list.indexOf(c("MessagingTag").FILTERED_CONTENT)!==-1,is_filtered_content_bh:p.tags_list.indexOf(c("MessagingTag").FILTERED_CONTENT_BH)!==-1,is_filtered_content_account:p.tags_list.indexOf(c("MessagingTag").FILTERED_CONTENT_ACCOUNT)!==-1,is_filtered_content_quasar:p.tags_list.indexOf(c("MessagingTag").FILTERED_CONTENT_QUASAR)!==-1,is_filtered_content_invalid_app:p.tags_list.indexOf(c("MessagingTag").FILTERED_CONTENT_INVALID_APP)!==-1,is_sponsored:p.is_sponsored,ad_id:p.ad_id,ad_client_token:p.ad_client_token,commerce_message_type:w==null?null:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MNCommerceMessageType")[w])),customizations:x==null?[]:x,source:u,source_tags:v,tags:p.tags_list,is_spoof_warning:p.tags_list.indexOf(c("MessagingTag").DOMAIN_AUTH_FAIL)!==-1||p.tags_list.indexOf(c("MessagingTag").SPAM_SPOOFING)!==-1||p.tags_list.indexOf(c("MessagingTag").SPOOF_WARNING)!==-1,folder:q.folder,platform_xmd:p.platform_xmd_encoded,message_source:p.message_source_data,montage_reply_data:p.montage_reply_data,replied_to_message:z,skip_bump_thread:false,profile_ranges:m(p),reactions:s,has_attachment:null,attachments:null,raw_attachments:null,ranges:null,meta_ranges:null,status:null,log_message_type:null,log_message_data:null,log_message_body:null,body:null,subject:null,creator_info:null};if(p.__typename==="UserMessage"){var C=l(p),D=p.extensible_attachment,E;if(D==null)E=null;else{var F=D.story_attachment;E={legacy_attachment_id:D.legacy_attachment_id,story_attachment:F==null?null:k(F)}}var G=c("MessengerAttachmentTransformer.bs").transformAttachment(o,{extensible_attachment:E,blob_attachments:C,sticker:p.sticker},r),H=p.message,I=p.page_admin_sender;Object.assign(B,{body:H==null?null:H.text,creator_info:I==null?null:{creatorID:I.admin_id,creatorName:I.name,creatorType:I.sender_type,labelType:I.label_type,pageID:I.page_id,profileURI:I.profile_uri},subject:null,has_attachment:G.length>0,attachments:G,raw_attachments:null,ranges:undefined,meta_ranges:p.meta_ranges.map(function($){return babelHelpers["extends"]({},$,{data:JSON.parse($.data)})})})}else if(p.__typename==="VoiceCallMessage"||p.__typename==="VideoCallMessage"){var J=p.__typename,K=J==="VoiceCallMessage"?c("MercuryLogMessageType").PHONE_CALL:c("MercuryLogMessageType").VIDEO_CALL,L=p.message_sender.id,M=q.other_user_fbid,N=M==null?null:c("MercuryIDs").getParticipantIDFromUserID(L===M?c("CurrentUser").getID():M),O=p.answered;Object.assign(B,{log_message_type:K,log_message_data:{answered:O==null?false:O,caller:c("MercuryIDs").getParticipantIDFromUserID(L),callee:N},log_message_body:p.snippet})}else if(p.__typename==="ThreadNameMessage")Object.assign(B,{log_message_type:c("MercuryLogMessageType").THREAD_NAME,log_message_data:{name:p.thread_name},log_message_body:p.snippet});else if(p.__typename==="ThreadImageMessage"){var P=p.image_with_metadata,Q;if(P==null)Q=null;else{var R=P.preview;Q={preview_url:R==null?null:R.uri,metadata:{fbid:P.legacy_attachment_id,dimensions:String(P.original_dimensions.x)+(","+String(P.original_dimensions.y))}}}Object.assign(B,{log_message_type:c("MercuryLogMessageType").THREAD_IMAGE,log_message_data:{image:Q},log_message_body:p.snippet})}else if(p.__typename==="ParticipantsAddedMessage"){var S=p.participants_added;Object.assign(B,{log_message_type:c("MercuryLogMessageType").SUBSCRIBE,log_message_data:{added_participants:S==null?[]:c("bs_array").map(function($){return c("MercuryIDs").getParticipantIDFromUserID($.id)},S)},log_message_body:p.snippet})}else if(p.__typename==="ParticipantLeftMessage"){var T=p.participants_removed;Object.assign(B,{log_message_type:c("MercuryLogMessageType").UNSUBSCRIBE,log_message_data:{removed_participants:T==null?[]:c("bs_array").map(function($){return c("MercuryIDs").getParticipantIDFromUserID($.id)},T)},log_message_body:p.snippet})}else if(p.__typename==="GenericAdminTextMessage"){var U=p.extensible_message_admin_text,V=p.extensible_message_admin_text_type;if(U==null){if(!(V==null))Object.assign(B,{log_message_body:p.snippet,log_message_data:{message_type:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("MessagingGenericAdminTextType")[V])),untypedData:undefined},log_message_type:c("MercuryLogMessageType").GENERIC_ADMIN_TEXT})}else if(!(V==null))Object.assign(B,h(U,V,p.snippet))}else if(p.__typename==="P2PPaymentRequestMessage"){var W=p.p2p_sender,X=p.p2p_receiver,Y=p.amount,Z=p.message_type;Object.assign(B,{log_message_body:p.snippet,log_message_data:{transfer_id:p.transfer_id,senderId:W==null?null:c("MercuryIDs").getParticipantIDFromUserID(W.id),receiverId:X==null?null:c("MercuryIDs").getParticipantIDFromUserID(X.id),formattedAmount:Y==null?null:Y.formatted,subtype:Z==null?null:c("bs_js_null_undefined").fromOption(c("bs_js_primitive").undefined_to_opt(c("P2PPaymentLogMessageSubtype")[Z]))},log_message_type:c("MercuryLogMessageType").ORION})}return B}g._getGenericAdminTextMessage=h;g._getStyleList=i;g.unsafeCastExtensibleAttachmentWithoutSubattachments=j;g.unsafeCastExtensibleAttachment=k;g.unsafeCastBlobAttachments=l;g._getProfileRanges=m;g.transformMessage=n}),null);
__d("MessengerAttachmentTransformerForSend.bs",["bs_array","bs_caml_array","MercuryAttachmentType","MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j,k,l){__p&&__p();var m=k.node;if(m==null)return{attach_type:c("MercuryAttachmentType").ERROR};else{var n;if(m.__typename==="ExtensibleMessageAttachment"){var o=m.story_attachment;n={legacy_attachment_id:m.legacy_attachment_id,story_attachment:o==null?null:c("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(o)}}else n=null;var p=m.__typename==="Sticker"?m:null,q=m.__typename,r;switch(q){case"MessageAnimatedImage":case"MessageAudio":case"MessageFile":case"MessageImage":case"MessageVideo":r=[m];break;default:r=null}var s=c("MessengerMessageTransformer.bs").unsafeCastBlobAttachments({blob_attachments:r}),t=c("MessengerAttachmentTransformer.bs").transformAttachment(j,{extensible_attachment:n,blob_attachments:s,sticker:p},l);if(t.length!==0)return c("bs_caml_array").caml_array_get(t,0);else return{}}}function i(j,k,l){return c("bs_array").map(function(m){return h(j,m,l)},k)}g._transform=h;g.transform=i}),null);
__d("XMessagingSendController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messaging/send/",{})}),null);
__d("MercuryServerSendMessageQueue",["fbt","BanzaiODS","ChatReliabilityInstrumentation","LogHistory","MercuryLoggingHelper","MercuryMessages","MercuryServerRequestsConfig","MercurySyncDeltaHandler","MessengerAttachmentTransformerForSend.bs","Run","MercuryServerDispatcher","MercuryServerSendMessageQueueSimulatedError","XMessagingSendController","idx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("LogHistory").getInstance("mercury_server_send_message_queue");function j(k,l,m,n){__p&&__p();var o;this.pending_message=null;this.queue=[];this.$MercuryServerSendMessageQueue6=function(){if(this.queue.length||this.pending_message)return h._("B\u1ea1n v\u1eabn ch\u01b0a g\u1eedi tin nh\u1eafn. B\u1ea1n c\u00f3 mu\u1ed1n tho\u00e1t m\u00e0 kh\u00f4ng g\u1eedi kh\u00f4ng?");return undefined}.bind(this);this.sender_id=k;this.queue_id=l;this.$MercuryServerSendMessageQueue2=m.success_handler;this.$MercuryServerSendMessageQueue1=m.error_handler;this.$MercuryServerSendMessageQueue4=m.transport_error_handler;this.$MercuryServerSendMessageQueue3=m.timeout_handler;this.$MercuryServerSendMessageQueue5=c("MercurySyncDeltaHandler").getForFBID(this.sender_id);this.client=n;c("Run").onBeforeUnload(this.$MercuryServerSendMessageQueue6,false);var p=null;if(c("MercuryServerRequestsConfig").msgrRegion)p={name:"X-MSGR-Region",value:c("MercuryServerRequestsConfig").msgrRegion};var q=this.__getSendURI(),r=(o={},o[q]={request_user_id:this.sender_id,endpoint_id:this.queue_id,mode:c("MercuryServerDispatcher").IMMEDIATE,customHeader:p,handler:this.handleSuccess.bind(this),error_handler:this.handleError.bind(this),transport_error_handler:this.handleTransportError.bind(this),timeout:m.timeout,timeout_handler:this.handleTimeout.bind(this),connection_retries:m.connection_retries},o);c("MercuryServerDispatcher").registerEndpoints(r)}j.prototype.__getSendURI=function(){return c("XMessagingSendController").getURIBuilder().getURI().toString()};j.prototype.__preparePayload=function(k){var l,m=(l=k)!=null?(l=l.replied_to_message)!=null?l.message_id:l:l,n=m?c("MercuryMessages").get().getServerMessageID(m):null;return{client:this.client,action_type:k.action_type,app_id:k.app_id,audio_ids:k.audio_ids,body:k.body,client_thread_id:k.client_thread_id,content_attachment:k.content_attachment,ephemeral_ttl_mode:k.ephemeral_ttl_mode,file_ids:k.file_ids,gif_ids:k.gif_ids,has_attachment:k.has_attachment,image_ids:k.image_ids,location_attachment:k.location_attachment,lightweight_action_attachment:k.lightweight_action_attachment,log_message_data:k.log_message_data,log_message_type:k.log_message_type,message_id:k.message_id,message_source_data:k.message_source_data,montage_reply_data:k.montage_reply_data,offline_threading_id:k.offline_threading_id,other_user_fbid:k.other_user_fbid,photo_fbids:k.photo_fbids,shareable_attachment:k.shareable_attachment,signature_id:k.signatureID,source:k.source,specific_to_list:k.specific_to_list,sticker_id:k.sticker_id,tags:k.tags,thread_fbid:k.thread_fbid,timestamp:k.timestamp,ui_push_phase:k.ui_push_phase,video_ids:k.video_ids,platform_xmd:k.platform_xmd,profile_xmd:k.profile_xmd,replied_to_message_id:n}};j.prototype.enqueue=function(k){this.queue.push(k);this.$MercuryServerSendMessageQueue7()};j.prototype.$MercuryServerSendMessageQueue7=function(){__p&&__p();if(this.pending_message||!this.queue.length){if(this.pending_message)this.$MercuryServerSendMessageQueue8();return}this.pending_message=this.queue.shift();var k=this.__preparePayload(this.pending_message);for(var l in k)if(k[l]===undefined||k[l]===null)delete k[l];if(!k.action_type){var m=c("MercuryLoggingHelper").obfuscateMessage(k);c("ChatReliabilityInstrumentation").logERROR("missing action type before sending to send controller");i.debug("missing_action_type",JSON.stringify(m))}if(!k.message_id){var n=c("MercuryLoggingHelper").obfuscateMessage(k);c("ChatReliabilityInstrumentation").logERROR("missing action type before sending to send controller"+JSON.stringify(n));i.debug("missing_message_id",JSON.stringify(n))}this.$MercuryServerSendMessageQueue9();c("MercuryServerDispatcher").trySend(this.__getSendURI(),k,null,this.sender_id,this.queue_id)};j.prototype.$MercuryServerSendMessageQueue10=function(){while(this.queue.length)this.$MercuryServerSendMessageQueue11(this.queue.shift())};j.prototype.$MercuryServerSendMessageQueue11=function(k){this.$MercuryServerSendMessageQueue1(c("MercuryServerSendMessageQueueSimulatedError").create(k));i.error("mark_as_failed",JSON.stringify({fbid:this.sender_id,queue_id:this.queue_id,message:c("MercuryLoggingHelper").obfuscateMessage(k)}))};j.prototype.handleSuccess=function(k,l){__p&&__p();var m=(k.actions||[]).map(function(n){__p&&__p();var o,p=babelHelpers["extends"]({},n);if(n.graphql_payload&&n.graphql_payload.length>0){var q=c("MessengerAttachmentTransformerForSend.bs").transform(this.sender_id,n.graphql_payload,n.for_page);p=Object.assign(p,{attachments:q})}var r=(o=n)!=null?(o=o.log_message_data)!=null?o.graphql_image:o:o;if(r){var s=c("MessengerAttachmentTransformerForSend.bs").transform(this.sender_id,[r],n.for_page);p=Object.assign(p,{log_message_data:{image:s[0]}})}return p}.bind(this));k.actions=m;this.$MercuryServerSendMessageQueue2(k,l);this.$MercuryServerSendMessageQueue12();this.pending_message=null;this.$MercuryServerSendMessageQueue7()};j.prototype.handleError=function(k){this.$MercuryServerSendMessageQueue12();this.$MercuryServerSendMessageQueue1(k);this.$MercuryServerSendMessageQueue10();this.pending_message=null};j.prototype.handleTransportError=function(k){this.$MercuryServerSendMessageQueue12();this.$MercuryServerSendMessageQueue4(k);this.$MercuryServerSendMessageQueue10();this.pending_message=null};j.prototype.handleTimeout=function(k){this.$MercuryServerSendMessageQueue12();this.$MercuryServerSendMessageQueue3(k);this.$MercuryServerSendMessageQueue10();this.pending_message=null};j.prototype.$MercuryServerSendMessageQueue9=function(){this.$MercuryServerSendMessageQueue5.pause()};j.prototype.$MercuryServerSendMessageQueue12=function(){this.$MercuryServerSendMessageQueue5.resume()};j.prototype.$MercuryServerSendMessageQueue8=function(){i.debug("maybe_send_next_pending_message",JSON.stringify({fbid:this.sender_id,queue_id:this.queue_id,pending_message:c("MercuryLoggingHelper").obfuscateMessage(this.pending_message),queue:this.queue.map(function(l){return c("MercuryLoggingHelper").obfuscateMessage(l)})}));var k="send_queue.delayed.queue_length."+this.queue.length.toString();c("BanzaiODS").bumpEntityKey("chat.web",k)};f.exports=j}),null);
__d("MercuryServerSendMessageQueueRouter",["BanzaiODS","LogHistory","MercuryServerSendMessageQueue","MercurySingletonMixin"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("LogHistory").getInstance("mercury_server_send_message_queue_router"),i="chat.web.send_queue_router";c("BanzaiODS").setEntitySample(i,.1);function j(k){"use strict";this.queues=new Map();this.fbid=k}j.prototype.enqueue=function(k,l,m,n){"use strict";var o=this.queues.get(k);if(o===undefined){o=new(c("MercuryServerSendMessageQueue"))(this.fbid,k,l,m);this.queues.set(k,o);h.debug("added queue",JSON.stringify({fbid:this.fbid,queue_id:k}));c("BanzaiODS").bumpEntityKey(i,"new_queue")}o.enqueue(n)};Object.assign(j,c("MercurySingletonMixin"));f.exports=j}),null);
__d("MercurySyncDataFetcherImpl",["errorCode","Promise","AsyncResponse","Bootloader","CurrentUser","FBIDCheck","MercuryPayloadSource","MercuryThreadlistConstants","MessagingConfig","UserActivity","clearTimeout","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("MessagingConfig").syncFetchRequestTimeoutMs,j={limit:c("MercuryThreadlistConstants").WEBMESSENGER_THREAD_COUNT+1,folder:"inbox",tags:["INBOX"],timestamp:null,offset:c("MercuryThreadlistConstants").RECENT_THREAD_OFFSET,filter:null,includeDeliveryReceipts:false,includeSeqID:true},k={};function l(r){return new(c("Promise"))(function(s,t){m(r,s,t,0)})}function m(r,s,t,u){__p&&__p();if(!c("CurrentUser").isLoggedInNow()||u>c("MessagingConfig").syncFetchRetries){c("clearTimeout")(k[r]);t();return}var v=u===0?0:c("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(c("MessagingConfig").syncFetchTimeoutMultiplier,u);if(!c("UserActivity").isOnTab())v+=500*Math.random();c("clearTimeout")(k[r]);k[r]=c("setTimeoutAcrossTransitions")(function(){__p&&__p();var w=false,x=function x(y){__p&&__p();var z;if(w)return;if(y.errors&&y.errors.length>0)(function(){var A=y.errors[0].message;if(A)c("Bootloader").loadModules(["MessengerWebGraphQLTypedLogger","MessengerWebGraphQLEvent"],function(B,C){new B().setErrorMessage(A).setEvent(C.DFF_FAILURE).setQueryParams(r).log()},"MercurySyncDataFetcherImpl")})();w=true;m(r,s,t,u+1)};c("Bootloader").loadModules(["MessengerGraphQLThreadlistFetcher.bs"],function(y){return y.fetchAll(r,[j],!c("FBIDCheck").isUser_deprecated(r)).then(function(z){w=true;s(new(c("AsyncResponse"))(null,babelHelpers["extends"]({},z,{payload_source:c("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE})));c("clearTimeout")(k[r])},x)},"MercurySyncDataFetcherImpl")},v)}function n(r,s,t){return new(c("Promise"))(function(u,v){o(r,s,t,u,v,0)})}function o(r,s,t,u,v,w){__p&&__p();if(w>c("MessagingConfig").syncFetchRetries){v();return}var x=w===0?0:c("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(c("MessagingConfig").syncFetchTimeoutMultiplier,w);c("setTimeoutAcrossTransitions")(function(){var y=false,z=function z(A){if(y)return;y=true;o(r,s,t,u,v,w+1)};c("Bootloader").loadModules(["MessengerThreadDFFFetcher.bs"],function(A){return A.fetch(r,{id:s,limit:t},!c("FBIDCheck").isUser_deprecated(r)).then(function(B){y=true;u(new(c("AsyncResponse"))(null,babelHelpers["extends"]({},B,{payload_source:c("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE})))},z)},"MercurySyncDataFetcherImpl")},x)}function p(r,s,t){return new(c("Promise"))(function(u,v){q(r,s,t,u,v,0)})}function q(r,s,t,u,v,w){__p&&__p();if(w>c("MessagingConfig").syncFetchRetries){v();return}var x=w===0?0:c("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(c("MessagingConfig").syncFetchTimeoutMultiplier,w);c("setTimeoutAcrossTransitions")(function(){var y=false,z=function z(A){if(y)return;y=true;q(r,s,t,u,v,w+1)};c("Bootloader").loadModules(["MessengerMessageDFFFetcher.bs"],function(A){return A.fetch(r,{thread_id:s,message_id:t},!c("FBIDCheck").isUser_deprecated(r)).then(function(B){y=true;u(new(c("AsyncResponse"))(null,babelHelpers["extends"]({},B)))},z)},"MercurySyncDataFetcherImpl")},x)}f.exports={fetchThreadlistFromGraphQL:l,fetchThreadFromGraphQL:n,fetchMessageFromGraphQL:p}}),null);
__d("MercurySyncDataFetcher",["Promise","LogHistory","MessagingConfig","MercurySyncDataFetcherImpl","WebGraphQLConfig","clearTimeout","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("LogHistory").getInstance("mercury_sync_data_fetcher");function i(){var n=0;for(var o=0;o<c("MessagingConfig").syncFetchRetries;o++){var p=o===0?0:c("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(c("MessagingConfig").syncFetchTimeoutMultiplier,o);n+=p+c("MessagingConfig").syncFetchRequestTimeoutMs}return n}var j=i();function k(n){__p&&__p();var o=null;return new(c("Promise"))(function(p,q){var r=function r(s){h.error("fetch_threadlist_graphql_timeout",JSON.stringify({timeout:j}));c("clearTimeout")(o);q(s)};o=c("setTimeoutAcrossTransitions")(r,Math.max(j,c("WebGraphQLConfig").timeout*c("MessagingConfig").syncFetchRetries));c("MercurySyncDataFetcherImpl").fetchThreadlistFromGraphQL(n).done(function(s){c("clearTimeout")(o);p(s)},r)})}function l(n,o,p){return new(c("Promise"))(function(q,r){var s=function s(u){h.error("fetch_thread_graphql_timeout",JSON.stringify({timeout:j}));r(u)},t=c("setTimeoutAcrossTransitions")(s,j);c("MercurySyncDataFetcherImpl").fetchThreadFromGraphQL(n,o,p).done(function(u){c("clearTimeout")(t);q(u)},s)})}function m(n,o,p){return new(c("Promise"))(function(q,r){var s=function s(u){h.error("fetch_message_graphql_timeout",JSON.stringify({timeout:j}));r(u)},t=c("setTimeoutAcrossTransitions")(s,j);c("MercurySyncDataFetcherImpl").fetchMessageFromGraphQL(n,o,p).done(function(u){c("clearTimeout")(t);q(u)},s)})}f.exports={fetchThreadlistFromGraphQL:k,fetchThreadFromGraphQL:l,fetchMessageFromGraphQL:m,getMaxTimeoutMs:i}}),null);
__d("MercurySyncDFFDataFetcher",["Promise","CurrentUser","MercuryMessages","MercuryThreads","MercuryThreadIDMap","MercurySingletonProvider","MercurySyncDataFetcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){this.$MercurySyncDFFDataFetcher1=j;this.__messages=c("MercuryMessages").getForFBID(this.$MercurySyncDFFDataFetcher1);this.__threads=c("MercuryThreads").getForFBID(this.$MercurySyncDFFDataFetcher1);this.__threadIDMap=c("MercuryThreadIDMap").getForFBID(this.$MercurySyncDFFDataFetcher1)}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.fetchInvalidateGlobalStateForGraphQL=function(){if(this.$MercurySyncDFFDataFetcher1&&this.$MercurySyncDFFDataFetcher1!=="0"&&c("CurrentUser").isLoggedIn())return c("MercurySyncDataFetcher").fetchThreadlistFromGraphQL(this.$MercurySyncDFFDataFetcher1);return new(c("Promise"))(function(j,k){return k(true)})};h.prototype.fetchInvalidateThreadState=function(j,k){var l=11,m=3,n=j||k,o=this.__threadIDMap.getClientIDFromServerIDNow(n);if(!o)return c("Promise").resolve({getPayload:function q(){return{}}});var p=m+this.__messages.getCurrentlyLoadedMessages(o).length;if(!n)return c("Promise").resolve({getPayload:function q(){return{}}});return c("MercurySyncDataFetcher").fetchThreadFromGraphQL(this.$MercurySyncDFFDataFetcher1,n,Math.max(p,l))};h.prototype.fetchInvalidateMessage=function(j,k,l){var m=j||k;if(!m)return c("Promise").resolve({getPayload:function n(){return{}}});return c("MercurySyncDataFetcher").fetchMessageFromGraphQL(this.$MercurySyncDFFDataFetcher1,m,l)};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("MercurySyncChannelMonitor",["Arbiter","ChannelConstants","CurrentUser","MercurySingletonProvider","MercurySyncFakeDFFSender"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){this.handleAwfulChannelEvent=function(){if(!c("CurrentUser").isLoggedInNow()){this.killSubscriptions();return}c("MercurySyncFakeDFFSender").getForFBID(this.$MercurySyncChannelMonitor1).sendGlobalDFF()}.bind(this);this.$MercurySyncChannelMonitor1=j;this.$MercurySyncChannelMonitor2=false}h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};h.prototype.setupSubscriptions=function(){if(!this.$MercurySyncChannelMonitor2){this.$MercurySyncChannelMonitor4=c("Arbiter").subscribe(c("ChannelConstants").JUMPSTART,this.handleAwfulChannelEvent);this.$MercurySyncChannelMonitor3=c("Arbiter").subscribe(c("ChannelConstants").THROTTLED,this.handleAwfulChannelEvent);this.$MercurySyncChannelMonitor2=true}};h.prototype.killSubscriptions=function(){if(this.$MercurySyncChannelMonitor2){c("Arbiter").unsubscribe(this.$MercurySyncChannelMonitor4);c("Arbiter").unsubscribe(this.$MercurySyncChannelMonitor3);this.$MercurySyncChannelMonitor2=false}};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("MercurySyncTopicType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DELTA:"delta",DELTAFLOW:"deltaflow",DELTAFLOWREJECT:"deltaflowreject"})}),null);
__d("MercurySyncDeltaHandler",["invariant","Arbiter","AsyncResponse","ChannelConstants","ChatReliabilityInstrumentation","CurrentUser","FBIDCheck","LogHistory","MercuryConfig","MessagingConfig","MercuryDelayedDispatcher","MercuryPayloadSource","MercurySyncChannelMonitor","MercurySyncConstants","MercurySyncDeltaHolder","MercurySyncDeltaTypes","MercurySyncDispatcher","MercurySyncForcedFetchHandler","MercurySyncHolesTypedLogger","MercuryServerPayloadPreprocessor","MercurySyncTopicType","MercurySingletonProvider","gkx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("LogHistory").getInstance("mercury_sync_delta_handler"),j=c("MessagingConfig").syncFetchRetries||0;k.getForFBID=function(m){return l.getForFBID(m)};k.get=function(){return l.get()};function k(m){__p&&__p();this.$MercurySyncDeltaHandler1=m;this.$MercurySyncDeltaHandler2=c("MercurySyncDispatcher").getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler3=c("MercurySyncForcedFetchHandler").getForFBID(this.$MercurySyncDeltaHandler1);this.__payloadPreprocessor=c("MercuryServerPayloadPreprocessor").getForFBID(this.$MercurySyncDeltaHandler1);this.__delayedDispatcher=c("MercuryDelayedDispatcher").getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler4=c("MercurySyncDeltaHolder").getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler5=0;this.$MercurySyncDeltaHandler11=c("MercurySyncChannelMonitor").getForFBID(this.$MercurySyncDeltaHandler1);this.$MercurySyncDeltaHandler6=[];this.$MercurySyncDeltaHandler13=0;i.debug("constructor",JSON.stringify({fbid:this.$MercurySyncDeltaHandler1}));c("Arbiter").subscribe("MercurySyncDeltaHandler/initSeqID",function(n,o){__p&&__p();i.debug("initSeqID",JSON.stringify(o));var p=o&&o.seqID,m=o&&o.fbid;if(!m)return;if(m!==this.$MercurySyncDeltaHandler1)return;if(p)this.$MercurySyncDeltaHandler4.updateLastSeqID(p);else this.$MercurySyncDeltaHandler4.updateLastSeqID(0);this.$MercurySyncDeltaHandler15();this.$MercurySyncDeltaHandler8=c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("deltaflow"),function(n,o){if(!this.$MercurySyncDeltaHandler14)this.$MercurySyncDeltaHandler15()}.bind(this))}.bind(this))}k.prototype.$MercurySyncDeltaHandler15=function(){__p&&__p();i.debug("setUpSubscriptionsToRealTimeUpdates",JSON.stringify({fbid:this.$MercurySyncDeltaHandler1}));this.$MercurySyncDeltaHandler7=c("Arbiter").subscribe(this.$MercurySyncDeltaHandler16(),function(m,n){__p&&__p();var o=n&&n.obj&&n.obj.queue;if(o)if(o.toString()!==this.$MercurySyncDeltaHandler1)return;var p=n&&n.obj&&n.obj.delta,q=n&&n.obj&&n.obj.iseq;if(!p||!q)return;this.$MercurySyncDeltaHandler17(q,c("MercurySyncTopicType").DELTA);this.$MercurySyncDeltaHandler18(q,p);this.$MercurySyncDeltaHandler4.push(q,p);this.$MercurySyncDeltaHandler19()}.bind(this));this.$MercurySyncDeltaHandler12=c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("deltaflowreject"),function(m,n){var o=n&&n.obj&&n.obj.queue;if(o)if(o.toString()!==this.$MercurySyncDeltaHandler1)return;if(this.$MercurySyncDeltaHandler14)this.$MercurySyncDeltaHandler20()}.bind(this));this.$MercurySyncDeltaHandler9=c("Arbiter").subscribe(c("ChannelConstants").getArbiterType(c("ChannelConstants").FAKE_DFF),function(m,n){var o=n&&n.obj&&n.obj.queue;if(o&&o.toString()!==this.$MercurySyncDeltaHandler1)return;var p=n&&n.obj&&n.obj.delta;if(!p)return;this.$MercurySyncDeltaHandler6.push(p);this.$MercurySyncDeltaHandler19()}.bind(this));this.$MercurySyncDeltaHandler11.setupSubscriptions();this.$MercurySyncDeltaHandler14=true};k.prototype.$MercurySyncDeltaHandler19=function(){__p&&__p();if(this.$MercurySyncDeltaHandler5>0)return;if(this.$MercurySyncDeltaHandler6.length>0){var m=this.$MercurySyncDeltaHandler6.shift();this.$MercurySyncDeltaHandler21(this.$MercurySyncDeltaHandler4.getLastSeqID(),m);this.$MercurySyncDeltaHandler19()}var n=this.$MercurySyncDeltaHandler4.peek();if(!n)return;var o=n-this.$MercurySyncDeltaHandler4.getLastSeqID();if(o===1){var p=this.$MercurySyncDeltaHandler4.pop();if(!p)return;var q=p.seqID,r=p.delta;this.$MercurySyncDeltaHandler21(q,r);this.$MercurySyncDeltaHandler19()}else if(o>1)this.$MercurySyncDeltaHandler22();else{this.$MercurySyncDeltaHandler4.pop();this.$MercurySyncDeltaHandler19()}};k.prototype.$MercurySyncDeltaHandler21=function(m,n){__p&&__p();this.$MercurySyncDeltaHandler4.updateLastSeqID(m);if(n["class"]===c("MercurySyncDeltaTypes").ForcedFetch){i.debug("DFF",JSON.stringify(n));if(n.threadKey!==undefined&&n.messageId===undefined)this.$MercurySyncDeltaHandler23(m,n);else if(n.threadKey!==undefined&&n.messageId!==undefined)this.$MercurySyncDeltaHandler24(m,n);else{c("ChatReliabilityInstrumentation").logDFF_DELTA_INIT(JSON.stringify(n));this.$MercurySyncDeltaHandler25(m)}}else this.$MercurySyncDeltaHandler2.process(n)};k.prototype.$MercurySyncDeltaHandler22=function(){var m=JSON.stringify({$MercurySyncDeltaHandler26:this.$MercurySyncDeltaHandler4.getLastSeqID(),nextSeqID:this.$MercurySyncDeltaHandler4.peek()});i.warn("hole",m);var n=this.$MercurySyncDeltaHandler4.peek();!!n||h(0);var o=n-1;c("ChatReliabilityInstrumentation").logDFF_HOLE_INIT(m);this.$MercurySyncDeltaHandler25(o)};k.prototype.$MercurySyncDeltaHandler27=function(m,n,o,p){__p&&__p();!this.$MercurySyncDeltaHandler5||h(0);this.$MercurySyncDeltaHandler5++;i.debug("_scheduleDataFetch:start",JSON.stringify({seqID:m}));n().done(function(q){i.debug("_scheduleDataFetch:success",JSON.stringify({seqID:m}));this.$MercurySyncDeltaHandler5--;o(m,q);this.$MercurySyncDeltaHandler19()}.bind(this),function(q){i.error("_scheduleDataFetch:failure",JSON.stringify({seqID:m}));this.$MercurySyncDeltaHandler5--;p(m,q);this.$MercurySyncDeltaHandler19()}.bind(this))};k.prototype.$MercurySyncDeltaHandler25=function(m){__p&&__p();if(!c("CurrentUser").isLoggedInNow())return;this.$MercurySyncDeltaHandler27(undefined,function(){return this.$MercurySyncDeltaHandler3.processGlobalDFFForGraphQL()}.bind(this),function(m,n){var o=n.getPayload();this.__payloadPreprocessor.handleUpdate(o);if(o.sequence_id){i.debug("_initiateGlobalDFF:success",JSON.stringify({seqID:o.sequence_id}));this.$MercurySyncDeltaHandler4.updateLastSeqID(o.sequence_id)}this.$MercurySyncDeltaHandler13=0;c("Arbiter").inform(c("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RECOVER)}.bind(this),function(n,o){__p&&__p();i.error("_initiateGlobalDFF:failure","");if(this.$MercurySyncDeltaHandler13>=j&&!c("gkx")("AT6272W7G37c2zZOpPDUPGXaehXUPvo7_ZqAqdSAoKzgP5DQ8Luz0w5hQkLZeaPa8UmuuAXTSUI8FctXnbHnbKTw")||o){if(this.$MercurySyncDeltaHandler14)this.$MercurySyncDeltaHandler20();if(c("gkx")("AT6T2zrYpHKRdiC2jWw79jSLuG2Ai8UAXBl4mf7UaSrzuZmkv1aboo5IByEaBzwrmKZ7i_TneQib5Fe9fVTNdQMv"))this.$MercurySyncDeltaHandler4.updateLastSeqID(m)}else{this.$MercurySyncDeltaHandler13++;c("Arbiter").inform(c("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RETRY);i.debug("_initiateGlobalDFF:retry","");this.$MercurySyncDeltaHandler25(m)}}.bind(this))};k.prototype.$MercurySyncDeltaHandler23=function(m,n){this.$MercurySyncDeltaHandler27(m,function(){return this.$MercurySyncDeltaHandler3.processThreadDFF(m,n.threadKey,n.isLazy)}.bind(this),function(m,o){this.__payloadPreprocessor.handleUpdate(o.getPayload());this.$MercurySyncDeltaHandler4.updateLastSeqID(m)}.bind(this),function(){i.error("_initiateThreadDFF:failure",JSON.stringify(n));var o=babelHelpers["extends"]({},n);delete o.threadKey;this.$MercurySyncDeltaHandler4.updateLastSeqID(m-1);this.$MercurySyncDeltaHandler4.push(m,o)}.bind(this))};k.prototype.$MercurySyncDeltaHandler24=function(m,n){__p&&__p();this.$MercurySyncDeltaHandler27(m,function(){return this.$MercurySyncDeltaHandler3.processMessageDFF(m,n.threadKey,n.messageId,n.isLazy)}.bind(this),function(m,o){var p=o.getPayload(),q=p.other_user_fbid?p.other_user_fbid:p.thread_fbid,r=[babelHelpers["extends"]({},p)],s=c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:r,payload_source:s},q);this.$MercurySyncDeltaHandler4.updateLastSeqID(m)}.bind(this),function(){i.error("_initiateMessageDFF:failure",JSON.stringify(n));var o=babelHelpers["extends"]({},n);delete o.messageId;this.$MercurySyncDeltaHandler4.updateLastSeqID(m-1);this.$MercurySyncDeltaHandler4.push(m,o)}.bind(this))};k.prototype.$MercurySyncDeltaHandler17=function(m,n){var o=m-this.$MercurySyncDeltaHandler4.getLastSeqID();if(o!==1&&o!==0){if(!c("MercuryConfig").WWWSyncHolesLogging)return;new(c("MercurySyncHolesTypedLogger"))().setSeqID(m).setDifference(o).setTopicType(n).log()}};k.prototype.$MercurySyncDeltaHandler18=function(m,n){switch(n["class"]){case c("MercurySyncDeltaTypes").NewMessage:i.debug("message_delta",JSON.stringify({seqID:m,threadKey:n.messageMetadata.threadKey,messageId:n.messageMetadata.messageId}));break;case c("MercurySyncDeltaTypes").ReadReceipt:i.debug("read_receipt_delta",JSON.stringify({seqID:m,threadKey:n.threadKey,actionTimestampMs:n.actionTimestampMs,watermarkTimestampMs:n.watermarkTimestampMs}));break;case c("MercurySyncDeltaTypes").DeliveryReceipt:i.debug("delivery_receipt_delta",JSON.stringify({seqID:m,deliveredWatermarkTimestampMs:n.deliveredWatermarkTimestampMs,messageIds:n.messageIds}));break}};k.prototype.pause=function(){this.$MercurySyncDeltaHandler5++};k.prototype.resume=function(){this.$MercurySyncDeltaHandler5--;this.$MercurySyncDeltaHandler19()};k.prototype.$MercurySyncDeltaHandler20=function(){this.$MercurySyncDeltaHandler14=false;c("Arbiter").unsubscribe(this.$MercurySyncDeltaHandler7);c("Arbiter").unsubscribe(this.$MercurySyncDeltaHandler9);c("Arbiter").unsubscribe(this.$MercurySyncDeltaHandler12);this.$MercurySyncDeltaHandler11.killSubscriptions();c("Arbiter").inform(c("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE)};k.prototype.$MercurySyncDeltaHandler16=function(){return c("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":c("ChannelConstants").getArbiterType("delta")};var l=new(c("MercurySingletonProvider"))(k);f.exports=k}),null);
__d("MercuryMessageCustomizations",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j,k){var l=j.customizations;if(!l)return null;var m=l.filter(function(n){return n.customization_type===k});return m.length>0?m[0].customization_value:null}function i(j){var k=JSON.parse(j),l=[];Object.keys(k).forEach(function(m){l.push({customization_type:m,customization_value:k[m]})});return l}f.exports={getCustomizationValue:h,parseCustomizations:i}}),null);
__d("MercuryProfileRanges",["idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){if(!i.id&&i.i)return{id:i.i,offset:i.o,length:i.l};return i}f.exports={extractFromDelta:function i(j){var k,l=(k=j)!=null?(k=k.data)!=null?k.prng:k:k;if(!l)return undefined;var m=[];try{m=JSON.parse(l);if(m.length>0)return m.map(h)}catch(n){}return m}}}),null);
__d("MessageThreadReadStateEffect",[],(function a(b,c,d,e,f,g){"use strict";var h={MARK_READ:1,MARK_UNREAD:2,KEEP_AS_IS:3},i=function i(j,k){var l=k.messageMetadata.skipBumpThread,m=j!==k.messageMetadata.actorFbId?h.MARK_UNREAD:h.KEEP_AS_IS;if(l)m=h.KEEP_AS_IS;return k.messageMetadata.threadReadStateEffect?k.messageMetadata.threadReadStateEffect:m};f.exports={MessageThreadReadStateEffectType:h,extractThreadStateEffectFromDelta:i}}),null);
__d("MessengerRealtimeAttachmentTransformer.bs",["MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j,k){var l=c("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(j),m=j.extensible_attachment,n;if(m==null)n=null;else{var o=m.story_attachment;n={legacy_attachment_id:m.legacy_attachment_id,story_attachment:o==null?null:c("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(o)}}return c("MessengerAttachmentTransformer.bs").transformAttachment(i,{extensible_attachment:n,blob_attachments:l,sticker:j.sticker},k)}g.transform=h}),null);
__d("MercurySyncNewMessageTransformer",["FBIDCheck","IrisProtocolMessageLifetime","MercuryActionType","MercuryIDs","MercuryMessageCustomizations","MercuryProfileRanges","MessagingTag","PageCommItemStatus","MessageThreadReadStateEffect","MessengerRealtimeAttachmentTransformer.bs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("MessageThreadReadStateEffect").MessageThreadReadStateEffectType,i=c("MessageThreadReadStateEffect").extractThreadStateEffectFromDelta,j=function j(l){var m={};try{m=JSON.parse(l)}catch(n){}return m};function k(l,m){__p&&__p();var n=parseInt(m.messageMetadata.timestamp,10),o=m.messageMetadata.skipBumpThread,p=i(l,m),q=p===h.MARK_UNREAD&&l!==m.messageMetadata.actorFbId,r=[];if(m.attachments)r=m.attachments.map(function(w){__p&&__p();var x=w.mercury,y=x.extensible_attachment,z=x.blob_attachment,A=x.sticker_attachment;if(!y&&!z&&!A)return null;var B=c("FBIDCheck").isUser_deprecated(l),C=[];if(y)C=c("MessengerRealtimeAttachmentTransformer.bs").transform(l,{extensible_attachment:y},B);else if(z)C=c("MessengerRealtimeAttachmentTransformer.bs").transform(l,{blob_attachments:[z]},B);else C=c("MessengerRealtimeAttachmentTransformer.bs").transform(l,{sticker:A});return C.length>0?C[0]:null});var s=!c("FBIDCheck").isUser_deprecated(l);r=r.filter(Boolean);var t=m.messageMetadata.tags?m.messageMetadata.tags[0]:undefined,u=null;if(m.data&&m.data.adminSignatureCreatorID){var v=m.data;u={creatorID:v.adminSignatureCreatorID||null,creatorName:v.adminSignatureCreatorName||null,creatorType:v.adminSignatureCreatorType||null,labelType:v.adminSignatureLabelType||null,pageID:v.adminSignaturePageID||null,profileURI:v.adminSignatureProfileURI||null}}return{message_id:m.messageMetadata.messageId,threading_id:null,offline_threading_id:m.messageMetadata.offlineThreadingId,author:c("MercuryIDs").getParticipantIDFromUserID(m.messageMetadata.actorFbId),author_email:m.messageMetadata.actorFbId+"@facebook.com",ephemeral_ttl_mode:m.ttl?c("IrisProtocolMessageLifetime")[m.ttl]:0,timestamp:n,is_unread:q,is_filtered_content:false,is_filtered_content_bh:false,is_filtered_content_account:false,is_filtered_content_quasar:false,is_filtered_content_invalid_app:false,source:t,tags:m.messageMetadata.tags,is_spoof_warning:false,folder:c("MessagingTag").INBOX,thread_fbid:m.messageMetadata.threadKey.threadFbId,other_user_fbid:m.messageMetadata.threadKey.otherUserFbId,body:m.body!==undefined?m.body:"",html_body:null,subject:null,has_attachment:r.length>0,attachments:r,ranges:undefined,thread_id:null,action_type:c("MercuryActionType").USER_GENERATED_MESSAGE,is_from_iris:true,is_sponsored:!!(m.data&&m.data.is_sponsored&&m.data.is_sponsored==="true")||!!(m.untypedData&&m.untypedData.is_sponsored&&m.untypedData.is_sponsored==="true"),commerce_message_type:m.data?m.data.commerce_message_type:null,customizations:m.data&&m.data.customization?c("MercuryMessageCustomizations").parseCustomizations(m.data.customization):null,platform_xmd:m.data&&m.data.platform_xmd?m.data.platform_xmd:null,profile_ranges:c("MercuryProfileRanges").extractFromDelta(m),message_source:m.data&&m.data.message_source_data?j(m.data.message_source_data).message_source:null,skip_bump_thread:o,thread_read_state_effect:p,montage_reply_data:m.data&&m.data.montage_reply_data?j(m.data.montage_reply_data):null,meta_ranges:m.data&&m.data.meta_ranges?j(m.data.meta_ranges):null,creator_info:u,comm_status:s?c("PageCommItemStatus").TODO:null}}f.exports={transform:k}}),null);
__d("MercurySyncAdminTextMessageTransformer",["MercuryActionType","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){var k=c("MercurySyncNewMessageTransformer").transform(i,j);k.action_type=c("MercuryActionType").LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={message_type:j.type,untypedData:j.untypedData};k.log_message_type=c("MercuryLogMessageType").GENERIC_ADMIN_TEXT;return k}f.exports={transform:h}}),null);
__d("ClientSyncProtocol_GroupsSyncAction",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({OPT_IN:0,OPT_OUT:1})}),null);
__d("LiveLocationStopReason",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({EXPIRED:1,CANCELED:2,ARRIVED:3})}),null);
__d("MercurySyncClientPayloadTransformer",["ClientSyncProtocol_GroupsSyncAction","DateConsts","LiveLocationStopReason","MercuryActionType","MercuryIDs","MercurySyncNewMessageTransformer","MessageLiveLocationClientSyncProtocolStopReason","MessengerGroupsSyncStatus","PageCommItemStatus","keyMirror"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("keyMirror")(c("LiveLocationStopReason")),i=8;function j(u,v){__p&&__p();var w=u.payload;w=JSON.parse(String.fromCharCode.apply(null,w));var x=w&&w.deltas,y=x[0];if(y.deltaMessageReaction)return p(y.deltaMessageReaction);else if(y.liveLocationData)return r(y.liveLocationData);else if(y.deltaUpdateGroupEventRSVPStatus){var z=y.deltaUpdateGroupEventRSVPStatus;return q(z)}else if(y.deltaPageThreadFollowUpData)return t(y.deltaPageThreadFollowUpData);else if(y.deltaChangeViewerStatus)return n(y.deltaChangeViewerStatus,v);else if(y.deltaMontageDirectExpire)return o(y.deltaMontageDirectExpire);else if(y.deltaMessageReply)return k(y.deltaMessageReply,v);else if(y.deltaUpdateGroupsSyncStatus)return l(y.deltaUpdateGroupsSyncStatus);else if(y.deltaUpdateGroupsSyncMetadata)return m(y.deltaUpdateGroupsSyncMetadata);else return s(y)}function k(u,v){var w=u.message,x=u.repliedToMessage,y=c("MercurySyncNewMessageTransformer").transform(v,w);if(x){var z=c("MercurySyncNewMessageTransformer").transform(v,x);y.replied_to_message=z}return y}function l(u){var v=u.threadKey,w=u.actorFbid,x=u.groupsSyncStatus,y=v.threadFbId||v.otherUserFbId;if(!y)return null;var z=c("MessengerGroupsSyncStatus")[x];return{action_type:c("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED,thread_fbid:y.toString(),actor_fbid:w.toString(),groups_sync_status_string:z}}function m(u){__p&&__p();var v=u.threadKey,w=u.actorFbid,x=u.syncAction,y=u.sourceSurface,z=u.syncedFbGroupId,A=v.threadFbId||v.otherUserFbId;if(!A)return null;var B=void 0;switch(x){case c("ClientSyncProtocol_GroupsSyncAction").OPT_IN:B=c("MessengerGroupsSyncStatus").OPT_IN;break;case c("ClientSyncProtocol_GroupsSyncAction").OPT_OUT:B=c("MessengerGroupsSyncStatus").OPT_OUT;break;default:return null}return{action_type:c("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE,thread_fbid:A.toString(),actor_fbid:w.toString(),groups_sync_action:B,source_surface:y,fb_group_id:z.toString()}}function n(u,v){var w=u.actorFbid,x=u.canViewerReply,y=u.reason,z=u.threadKey;if(!w)return null;var A=w.toString(),B=c("MercuryIDs").getParticipantIDFromUserID(A===v?z.otherUserFbId:v);return{action_type:c("MercuryActionType").BLOCK_STATUS_CHANGED,actorFbid:w,canViewerReply:x,reason:y,message_blocked_ids:[B],other_user_fbid:z.otherUserFbId.toString()}}function o(u){var v=u.threadKey.threadFbId||u.threadKey.otherUserFbId;return{action_type:c("MercuryActionType").MONTAGE_DIRECT_EXPIRE,messageId:u.messageId,timestamp:u.timestamp,thread_fbid:v.toString(),keep_expiry_timestamp:u.keepExpiryTimestamp}}function p(u){var v=u.messageId,w=u.offlineThreadingId,x=u.reaction,y=u.senderId,z=u.userId,A=u.threadKey.threadFbId||u.threadKey.otherUserFbId;return{action_type:c("MercuryActionType").REACTION_UPDATE,messageId:v,offlineThreadingId:w,reaction:x,senderId:y,thread_fbid:A.toString(),userId:z}}function q(u){var v=u.threadKey&&u.threadKey.threadFbId;if(!v)return null;var w=u.actorFbId,x=u.rsvpStatus;if(!w)return null;return{action_type:c("MercuryActionType").EVENT_RSVP_CHANGED,thread_fbid:v.toString(),actor_fbid:w.toString(),rsvp_status:x}}function r(u){__p&&__p();var v=u.threadKey;if(!v)return null;var w=v.threadFbId||v.otherUserFbId;if(!w)return null;if(!u.messageLiveLocations||u.messageLiveLocations.length!==1)return null;var x=u.messageLiveLocations[0],y=x.expirationTime,z=x.stopReason!=null||Date.now()/c("DateConsts").MS_PER_SEC>y,A=function A(E){return E/Math.pow(10,i)},B=x.coordinate?{latitude:A(x.coordinate.latitude),longitude:A(x.coordinate.longitude)}:null,C=null;if(x.destination)C={latitude:A(x.destination.latitude),longitude:A(x.destination.longitude),label:x.destination.label};var D=null;switch(x.stopReason){case c("MessageLiveLocationClientSyncProtocolStopReason").EXPIRED:D=h.EXPIRED;break;case c("MessageLiveLocationClientSyncProtocolStopReason").CANCELED:D=h.CANCELED;break;case c("MessageLiveLocationClientSyncProtocolStopReason").ARRIVED:D=h.ARRIVED;break}return{action_type:c("MercuryActionType").LIVE_LOCATION_UPDATE,thread_fbid:w.toString(),messageId:x.messageId,liveLocation:{live_location_id:x.id.toString(),is_expired:z,expiration_time:y,sender:{id:x.senderId.toString()},coordinate:B,location_title:x.locationTitle,sender_destination:C,stop_reason:D}}}function s(u){var v=u&&u.deltaPaymentPinProtectionStatusData,w=v&&v.threadKey&&v.threadKey.otherUserFbId,x=v&&v.isPinProtected;if(!w)return null;var y=w.toString();return{action_type:c("MercuryActionType").IS_PIN_PROTECTED,thread_fbid:y,is_pin_protected:x}}function t(u){var v=u.threadKey.otherUserFbId;return{action_type:c("MercuryActionType").UPDATE_COMM_STATUS,comm_status:u.isFollowUp?c("PageCommItemStatus").FOLLOW_UP:c("PageCommItemStatus").TODO,thread_fbid:v.toString()}}f.exports={transform:j}}),null);
__d("MercurySyncDeliveryReceiptTransformer",[],(function a(b,c,d,e,f,g){"use strict";function h(i){return{delivery_receipts:[{other_user_fbid:i.threadKey.otherUserFbId?i.threadKey.otherUserFbId:"",thread_fbid:i.threadKey.threadFbId?i.threadKey.threadFbId:"",time:parseInt(i.deliveredWatermarkTimestampMs,10)}]}}f.exports={transform:h}}),null);
__d("MercurySyncMarkFolderChangeTransformer",["MercuryActionType","MessagingTag"],(function a(b,c,d,e,f,g){"use strict";function h(i){return{action_type:c("MercuryActionType").CHANGE_FOLDER,other_user_fbid:i.threadKey.otherUserFbId,new_folder:c("MessagingTag").IRIS_MAPPING[i.folder]}}f.exports={transform:h}}),null);
__d("MercurySyncMarkFolderSeenTransformer",["MercuryGlobalActionType","MessagingTag"],(function a(b,c,d,e,f,g){"use strict";function h(i){return i.folders.map(function(j){return{action_type:c("MercuryGlobalActionType").MARK_ALL_SEEN,folder:c("MessagingTag").IRIS_MAPPING[j],timestamp:parseInt(i.timestamp,10)}})}f.exports={transform:h}}),null);
__d("MercurySyncMarkReadTransformer",["MercuryActionType","MercuryGlobalActionType","MessagingTag"],(function a(b,c,d,e,f,g){"use strict";function h(i){if(i.folders&&i.folders.length>0)return i.folders.map(function(j){return{action_type:c("MercuryGlobalActionType").MARK_ALL_READ,action_id:null,folder:c("MessagingTag").IRIS_MAPPING[j],timestamp:parseInt(i.watermarkTimestamp,10)}});return i.threadKeys.map(function(j){return{action_type:c("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:j.otherUserFbId,thread_fbid:j.threadFbId,mark_as_read:true,timestamp:parseInt(i.watermarkTimestamp,10),folder:c("MessagingTag").INBOX}})}f.exports={transform:h}}),null);
__d("MercurySyncMarkUnreadTransformer",["MercuryActionType","MessagingTag"],(function a(b,c,d,e,f,g){"use strict";function h(i){return i.threadKeys.map(function(j){return{action_type:c("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:j.otherUserFbId,thread_fbid:j.threadFbId,mark_as_read:false,timestamp:parseInt(i.watermarkTimestamp,10),folder:c("MessagingTag").INBOX}})}f.exports={transform:h}}),null);
__d("MercurySyncMessageDeleteTransformer",["MercuryActionType"],(function a(b,c,d,e,f,g){"use strict";function h(i){return{action_type:c("MercuryActionType").DELETE_MESSAGES,message_ids:i.messageIds,other_user_fbid:i.threadKey.otherUserFbId,thread_fbid:i.threadKey.threadFbId}}f.exports={transform:h}}),null);
__d("PagesMessagingEventType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({FLAG:1,CREATE_ADMIN_NOTE:2,PRIORITY_UPDATE:3})}),null);
__d("MercurySyncPagesManagerEventTransformer",["MercuryActionType","PagesMessagingEventType"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){var j=JSON.parse(i.jsonBlob),k=j&&j.type;if(!k)return undefined;switch(k){case c("PagesMessagingEventType").FLAG:var l=!!(j&&j.flagData&&j.flagData.state),m={action_type:c("MercuryActionType").CHANGE_FLAG,mark_as_flag:l,other_user_fbid:i.threadKey.otherUserFbId,thread_fbid:i.threadKey.threadFbId};return m;default:return undefined}}f.exports={transform:h}}),null);
__d("MercurySyncParticipantLeftGroupThreadTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){var k=c("MercurySyncNewMessageTransformer").transform(i,j);k.action_type=c("MercuryActionType").LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={removed_participants:[c("MercuryIDs").getParticipantIDFromUserID(j.leftParticipantFbId)]};k.log_message_type=c("MercuryLogMessageType").UNSUBSCRIBE;return k}f.exports={transform:h}}),null);
__d("MercurySyncParticipantsAddedToGroupThreadTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j){var k=c("MercurySyncNewMessageTransformer").transform(i,j);k.action_type=c("MercuryActionType").LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={added_participants:j.addedParticipants.map(function(l){return c("MercuryIDs").getParticipantIDFromUserID(l.userFbId)})};k.log_message_type=c("MercuryLogMessageType").SUBSCRIBE;return k}f.exports={transform:h}}),null);
__d("MercurySyncRTCEventLogTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){var k=c("MercurySyncNewMessageTransformer").transform(i,j),l=j.messageMetadata.actorFbId,m=l===i?j.messageMetadata.threadKey.otherUserFbId:i,n=j.eventType==="VOICE_EVENT"?c("MercuryLogMessageType").PHONE_CALL:c("MercuryLogMessageType").VIDEO_CALL;k.action_type=c("MercuryActionType").LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={answered:j.duration>0,callee:c("MercuryIDs").getParticipantIDFromUserID(m),caller:c("MercuryIDs").getParticipantIDFromUserID(l)};k.log_message_type=n;return k}f.exports={transform:h}}),null);
__d("MercurySyncReadReceiptTransformer",[],(function a(b,c,d,e,f,g){"use strict";function h(i){var j={watermark:parseInt(i.watermarkTimestampMs,10),action:parseInt(i.actionTimestampMs,10)},k=i.threadKey.otherUserFbId||i.actorFbId,l=i.threadKey.otherUserFbId||i.threadKey.threadFbId,m={roger:{}};m.roger[l]={};m.roger[l][k]=j;return m}f.exports={transform:h}}),null);
__d("MercurySyncReplaceMessageTransformer",["MercuryActionType","MercurySyncNewMessageTransformer"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){j=Object.assign({},j.newMessage,j);return Object.assign(c("MercurySyncNewMessageTransformer").transform(i,j),{action_type:c("MercuryActionType").REPLACE_MESSAGE,replaced_message_id:j.replacedMessageId})}f.exports={transform:h}}),null);
__d("MercurySyncRtcCallDataTransformer",["MercuryActionType"],(function a(b,c,d,e,f,g){"use strict";function h(i){var j=i.messageMetadata.threadKey&&i.messageMetadata.threadKey.threadFbId?i.messageMetadata.threadKey.threadFbId.toString():undefined,k=i.initiator&&i.initiator.userFbId?i.initiator.userFbId.toString():undefined;return{action_type:c("MercuryActionType").UPDATE_RTC_CALL_DATA,thread_fbid:j,call_state:i.callState,server_info_data:i.serverInfoData,initiator_fbid:k}}f.exports={transform:h}}),null);
__d("MessagingThreadAction",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ACTION_INVALID:"ACTION_INVALID",ACTION_ARCHIVED:"ACTION_ARCHIVED",ACTION_UNARCHIVED:"ACTION_UNARCHIVED"})}),null);
__d("MercurySyncThreadActionTransformer",["MercuryActionType","MessagingThreadAction"],(function a(b,c,d,e,f,g){"use strict";function h(i){var j={action_type:c("MercuryActionType").CHANGE_ARCHIVED_STATUS,thread_fbid:i.threadKey.threadFbId,other_user_fbid:i.threadKey.otherUserFbId,archived:i.action===c("MessagingThreadAction").ACTION_ARCHIVED};return j}f.exports={transform:h}}),null);
__d("MercurySyncThreadAdminsAddToGroupTransformer",["MercuryActionType"],(function a(b,c,d,e,f,g){"use strict";function h(i){return{action_type:c("MercuryActionType").ADD_GROUP_ADMINS,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,added_admin_ids:i.addedAdmins.map(function(j){return j.userFbId})}}f.exports={transform:h}}),null);
__d("MercurySyncThreadAdminsRemovedFromGroupTransformer",["MercuryActionType"],(function a(b,c,d,e,f,g){"use strict";function h(i){return{action_type:c("MercuryActionType").REMOVE_GROUP_ADMINS,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,removed_admin_ids:i.removedAdminFbIds}}f.exports={transform:h}}),null);
__d("MessengerApprovalModeTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({OPEN:0,APPROVALS:1})}),null);
__d("MercurySyncThreadApprovalModeTransformer",["MercuryActionType","MessengerApprovalModeTypes"],(function a(b,c,d,e,f,g){"use strict";function h(i){return{action_type:c("MercuryActionType").APPROVAL_MODE,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,approval_mode:c("MessengerApprovalModeTypes")[i.mode]}}f.exports={transform:h}}),null);
__d("MessengerApprovalQueueTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({REQUESTED:"REQUESTED",REMOVED:"REMOVED"})}),null);
__d("MessengerGroupRequestSource",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ADD:0,JOIN_THROUGH_LINK:1})}),null);
__d("MercurySyncThreadApprovalQueueTransformer",["MercuryActionType","MercuryIDs","MessengerApprovalQueueTypes","MessengerGroupRequestSource"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(j){if(j===null||j===undefined)return null;switch(j){case"ADD":return c("MessengerGroupRequestSource").ADD;case"JOIN_THROUGH_LINK":return c("MessengerGroupRequestSource").JOIN_THROUGH_LINK;default:return null}}function i(j){if(j.inviterFbId)return{action_type:c("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:j.messageMetadata.threadKey.threadFbId,removed_group_id:j.action===c("MessengerApprovalQueueTypes").REMOVED?j.recipientFbId:null,added_group_id:j.action===c("MessengerApprovalQueueTypes").REQUESTED?{requester:{id:j.recipientFbId},inviter:{id:j.inviterFbId},request_source:h(j.requestSource),request_timestamp:j.requestTimestamp}:null};var k=c("MercuryIDs").getParticipantIDFromUserID(j.recipientFbId);return{action_type:c("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:j.messageMetadata.threadKey.threadFbId,removed_id:j.action===c("MessengerApprovalQueueTypes").REMOVED?k:null,added_id:j.action===c("MessengerApprovalQueueTypes").REQUESTED?k:null}}f.exports={transform:i}}),null);
__d("MercurySyncThreadDeleteTransformer",["MercuryActionType"],(function a(b,c,d,e,f,g){"use strict";function h(i){return i.threadKeys.map(function(j){return{action_type:c("MercuryActionType").DELETE_THREAD,other_user_fbid:j.otherUserFbId,thread_fbid:j.threadFbId}})}f.exports={transform:h}}),null);
__d("MessengerJoinableModeType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({PRIVATE:0,JOINABLE:1})}),null);
__d("MercurySyncThreadJoinableModeTransformer",["MercuryActionType","MessengerJoinableModeType"],(function a(b,c,d,e,f,g){"use strict";function h(i){return{action_type:c("MercuryActionType").JOINABLE_MODE,action_id:null,thread_fbid:i.messageMetadata.threadKey.threadFbId,joinable_mode:{mode:c("MessengerJoinableModeType")[i.mode],link:i.link}}}f.exports={transform:h}}),null);
__d("MercurySyncThreadMuteSettingsTransformer",["MercuryActionType"],(function a(b,c,d,e,f,g){"use strict";function h(i){var j={action_type:c("MercuryActionType").CHANGE_MUTE_SETTINGS,thread_fbid:i.threadKey.threadFbId,other_user_fbid:i.threadKey.otherUserFbId,mute_until:parseInt(i.expireTime,10)};return j}f.exports={transform:h}}),null);
__d("MercurySyncThreadNameTransformer",["MercuryActionType","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){var k=c("MercurySyncNewMessageTransformer").transform(i,j);k.action_type=c("MercuryActionType").LOG_MESSAGE;k.log_message_body=j.messageMetadata.adminText;k.log_message_data={name:j.name};k.log_message_type=c("MercuryLogMessageType").THREAD_NAME;return k}f.exports={transform:h}}),null);
__d("MontageDispatcher",["ExplicitRegistrationDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("ExplicitRegistrationDispatcher"));i=h&&h.prototype;function j(){h.apply(this,arguments)}f.exports=new j({strict:false})}),null);
__d("MontageActions",["MontageDispatcher","keyMirror"],(function a(b,c,d,e,f,g){"use strict";var h=c("keyMirror")({REQUEST_UPDATE:null,HAS_UPDATED:null}),i={Types:h,requestUpdate:function j(k){c("MontageDispatcher").dispatch({type:h.REQUEST_UPDATE,threadFBID:k})},hasUpdated:function j(k){c("MontageDispatcher").dispatch({type:h.HAS_UPDATED,threadFBID:k})}};f.exports=i}),null);
__d("MercurySyncDispatcher",["MercuryDelayedDispatcher","MercuryGlobalActionType","MercuryPayloadSource","MercuryServerPayloadPreprocessor","MercurySyncThreadAdminsAddToGroupTransformer","MercurySyncThreadAdminsRemovedFromGroupTransformer","MercurySyncAdminTextMessageTransformer","MercurySyncClientPayloadTransformer","MercurySyncDeliveryReceiptTransformer","MercurySyncMarkFolderSeenTransformer","MercurySyncMarkReadTransformer","MercurySyncMarkUnreadTransformer","MercurySyncMessageDeleteTransformer","MercurySyncNewMessageTransformer","MercurySyncReadReceiptTransformer","MercurySyncPagesManagerEventTransformer","MercurySyncParticipantLeftGroupThreadTransformer","MercurySyncParticipantsAddedToGroupThreadTransformer","MercurySyncRTCEventLogTransformer","MercurySyncThreadDeleteTransformer","MercurySyncMarkFolderChangeTransformer","MercurySyncThreadMuteSettingsTransformer","MercurySyncThreadNameTransformer","MercurySyncThreadActionTransformer","MercurySyncReplaceMessageTransformer","MercurySyncThreadJoinableModeTransformer","MercurySyncThreadApprovalModeTransformer","MercurySyncThreadApprovalQueueTransformer","MercurySyncRtcCallDataTransformer","MercurySyncDeltaTypes","MercurySingletonProvider","MontageActions"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="FOLDER_MONTAGE";i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){this.$MercurySyncDispatcher1=k;this.$MercurySyncDispatcher2=c("MercuryDelayedDispatcher").getForFBID(this.$MercurySyncDispatcher1);this.$MercurySyncDispatcher3=c("MercuryServerPayloadPreprocessor").getForFBID(this.$MercurySyncDispatcher1)}i.prototype.process=function(k){__p&&__p();var l=void 0,m=void 0;switch(k["class"]){case c("MercurySyncDeltaTypes").NewMessage:l=c("MercurySyncNewMessageTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ReplaceMessage:l=c("MercurySyncReplaceMessageTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").DeliveryReceipt:l=c("MercurySyncDeliveryReceiptTransformer").transform(k);this.$MercurySyncDispatcher3.handleUpdate(l);break;case c("MercurySyncDeltaTypes").MarkRead:l=c("MercurySyncMarkReadTransformer").transform(k);var n=[],o=[];l.forEach(function(p){if(p.action_type===c("MercuryGlobalActionType").MARK_ALL_READ)n.push(p);else o.push(p)});n.length&&this.$MercurySyncDispatcher5(n);o.length&&this.$MercurySyncDispatcher6(o);break;case c("MercurySyncDeltaTypes").MarkUnread:l=c("MercurySyncMarkUnreadTransformer").transform(k);this.$MercurySyncDispatcher6(l);break;case c("MercurySyncDeltaTypes").ParticipantLeftGroupThread:l=c("MercurySyncParticipantLeftGroupThreadTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread:l=c("MercurySyncParticipantsAddedToGroupThreadTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").RTCEventLog:l=c("MercurySyncRTCEventLogTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ThreadName:l=c("MercurySyncThreadNameTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ReadReceipt:l=c("MercurySyncReadReceiptTransformer").transform(k);this.$MercurySyncDispatcher3.handleUpdate(l);break;case c("MercurySyncDeltaTypes").AdminTextMessage:l=c("MercurySyncAdminTextMessageTransformer").transform(this.$MercurySyncDispatcher1,k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").MessageDelete:m=k.threadKey.threadFbId;if(m&&k.folder&&k.folder===h)c("MontageActions").requestUpdate(m);else{l=c("MercurySyncMessageDeleteTransformer").transform(k);this.$MercurySyncDispatcher4(l)}break;case c("MercurySyncDeltaTypes").ThreadAction:l=c("MercurySyncThreadActionTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ThreadDelete:l=c("MercurySyncThreadDeleteTransformer").transform(k);this.$MercurySyncDispatcher6(l);break;case c("MercurySyncDeltaTypes").AdminAddedToGroupThread:l=c("MercurySyncThreadAdminsAddToGroupTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").AdminRemovedFromGroupThread:l=c("MercurySyncThreadAdminsRemovedFromGroupTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ThreadMuteSettings:l=c("MercurySyncThreadMuteSettingsTransformer").transform(k);this.$MercurySyncDispatcher6([l]);break;case c("MercurySyncDeltaTypes").PagesManagerEvent:l=c("MercurySyncPagesManagerEventTransformer").transform(k);if(!l)return;this.$MercurySyncDispatcher6([l]);break;case c("MercurySyncDeltaTypes").JoinableMode:l=c("MercurySyncThreadJoinableModeTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ApprovalMode:l=c("MercurySyncThreadApprovalModeTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ApprovalQueue:l=c("MercurySyncThreadApprovalQueueTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").ClientPayload:l=c("MercurySyncClientPayloadTransformer").transform(k,this.$MercurySyncDispatcher1);if(!l)return;this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").GenieMessage:l=c("MercurySyncNewMessageTransformer").transform(this.$MercurySyncDispatcher1,k.deltaNewMessage);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").MontageMessage:m=k.newMessage.messageMetadata.actorFbId;if(m)c("MontageActions").requestUpdate(m);break;case c("MercurySyncDeltaTypes").RtcCallData:l=c("MercurySyncRtcCallDataTransformer").transform(k);this.$MercurySyncDispatcher4(l);break;case c("MercurySyncDeltaTypes").MarkFolderSeen:l=c("MercurySyncMarkFolderSeenTransformer").transform(k);this.$MercurySyncDispatcher5(l);break;case c("MercurySyncDeltaTypes").ThreadFolder:l=c("MercurySyncMarkFolderChangeTransformer").transform(k);this.$MercurySyncDispatcher6([l]);break;default:break}};i.prototype.$MercurySyncDispatcher4=function(k){var l=k.other_user_fbid||k.thread_fbid;this.$MercurySyncDispatcher2.handleUpdateWaitForThread({actions:[k],payload_source:c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE},l)};i.prototype.$MercurySyncDispatcher5=function(k){this.$MercurySyncDispatcher3.handleUpdate({global_actions:k,payload_source:c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE})};i.prototype.$MercurySyncDispatcher6=function(k){this.$MercurySyncDispatcher3.handleUpdate({actions:k,payload_source:c("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE})};var j=new(c("MercurySingletonProvider"))(i);f.exports=i}),null);
__d("MercurySyncForcedFetchHandler",["Promise","MercurySingletonProvider","MercurySyncDFFDataFetcher","MercuryMessages","MercuryThreadIDMap"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(k){return{getPayload:function l(){return{sequence_id:k}}}}i.getForFBID=function(k){return j.getForFBID(k)};i.get=function(){return j.get()};function i(k){this.$MercurySyncForcedFetchHandler1=k;this.$MercurySyncForcedFetchHandler2=c("MercuryMessages").getForFBID(this.$MercurySyncForcedFetchHandler1);this.$MercurySyncForcedFetchHandler3=c("MercuryThreadIDMap").getForFBID(this.$MercurySyncForcedFetchHandler1);this.$MercurySyncForcedFetchHandler4=c("MercurySyncDFFDataFetcher").getForFBID(this.$MercurySyncForcedFetchHandler1)}i.prototype.processMessageDFF=function(k,l,m,n){if(n){var o=l.otherUserFbId!==undefined?l.otherUserFbId.toString():l.threadFbId.toString(),p=this.$MercurySyncForcedFetchHandler3.getClientIDFromServerIDNow(o);if(p===undefined)return c("Promise").resolve(h(k));var q=this.$MercurySyncForcedFetchHandler2.getMessagesFromIDs([m]);if(q.length===0)return c("Promise").resolve(h(k))}return this.$MercurySyncForcedFetchHandler4.fetchInvalidateMessage(l.otherUserFbId,l.threadFbId,m)};i.prototype.processThreadDFF=function(k,l,m){if(m){var n=l.otherUserFbId!==undefined?l.otherUserFbId.toString():l.threadFbId.toString(),o=this.$MercurySyncForcedFetchHandler3.getClientIDFromServerIDNow(n);if(o===undefined)return c("Promise").resolve(h(k))}return this.$MercurySyncForcedFetchHandler4.fetchInvalidateThreadState(l.otherUserFbId,l.threadFbId)};i.prototype.processGlobalDFFForGraphQL=function(){return this.$MercurySyncForcedFetchHandler4.fetchInvalidateGlobalStateForGraphQL()};var j=new(c("MercurySingletonProvider"))(i);f.exports=i}),null);
__d("ContextualLayerAutoFlipHorizontal",["ContextualLayerAutoFlip"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("ContextualLayerAutoFlip"));i=h&&h.prototype;j.prototype.getValidPositions=function(k){"use strict";return[k.getPosition()]};function j(){"use strict";h.apply(this,arguments)}f.exports=j}),null);
__d("MessengerContextualDialog.react",["cx","AccessibleLayer","ContextualLayerAutoFlipHorizontal","ContextualLayerUpdateOnScroll","LayerHideOnEscape","ReactAbstractContextualDialog","ReactLayer"],(function a(b,c,d,e,f,g,h){"use strict";var i=12,j=c("ReactLayer").createClass(c("ReactAbstractContextualDialog").createSpec({addedBehaviors:[c("ContextualLayerAutoFlipHorizontal"),c("ContextualLayerUpdateOnScroll"),c("LayerHideOnEscape"),c("AccessibleLayer")],displayName:"MessengerContextualDialog",shouldSetARIAProperties:false,theme:{wrapperClassName:"_1r_9",arrowDimensions:{offset:i,length:16}}}));f.exports=j}),null);
__d("ImageReact.bs",["Image.react","ReasonReact.bs","bs_js_null_undefined"],(function a(b,c,d,e,f,g){"use strict";function h(i,j,k,l,m,n,o,p){return c("ReasonReact.bs").wrapJsForReason(c("Image.react"),{className:c("bs_js_null_undefined").fromOption(i),alt:c("bs_js_null_undefined").fromOption(j),src:c("bs_js_null_undefined").fromOption(k),height:c("bs_js_null_undefined").fromOption(l),title:c("bs_js_null_undefined").fromOption(m),width:c("bs_js_null_undefined").fromOption(n),style:c("bs_js_null_undefined").fromOption(o)},p)}g.make=h}),null);
__d("MessengerSpinnerReact.bs",["cx","ix","fbt","React","ImageReact.bs","ReasonReact.bs","joinClasses"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=i("86853"),l=i("86857"),m=i("86854"),n=c("ReasonReact.bs").statelessComponent("MessengerSpinnerReact");function o(s,t,u,v){__p&&__p();var w=s?s[0]:"",x=t?t[0]:"blue",y=u?u[0]:24,z=function z(){var A=y===24;if(A){var B=x==="blue";if(B)return k;else return l}else return m};return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],function(){return c("React").cloneElement(c("ReasonReact.bs").element(0,0,c("ImageReact.bs").make([c("joinClasses")(w,"_3u55 _3qh2")],0,[z(0)],[y],0,[y],0,[])),{"aria-label":j._("\u0110ang t\u1ea3i..."),"aria-busy":true})},n[10],n[11],n[12],n[13]]}var p=c("ReasonReact.bs").wrapReasonForJs(n,function(s){var t=s.className,u=s.color,v=s.size;return o([t==null?"":t],[u==null?"blue":u],[v==null?24:v],[])}),q=32,r=24;g.large_size=q;g.medium_size=r;g.blue_src=k;g.grey_src=l;g.large_blue_src=m;g.component=n;g.make=o;g.jsComponent=p}),null);
__d("MessengerSpinner.react",["MessengerSpinnerReact.bs"],(function a(b,c,d,e,f,g){f.exports=c("MessengerSpinnerReact.bs").jsComponent;f.exports.large_size=c("MessengerSpinnerReact.bs").large_size;f.exports.medium_size=c("MessengerSpinnerReact.bs").medium_size}),null);
__d("MessengerHotLikeOutlineSVG.react",["cssVar","fbt","CurrentUser","React","MercuryShareAttachmentRenderLocations","uniqueID"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=c("React").PropTypes,m="transparent",n=i._("D\u1ea5u hi\u1ec7u gi\u01a1 ng\u00f3n c\u00e1i");j=babelHelpers.inherits(o,c("React").Component);k=j&&j.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=k.constructor).call.apply(p,[this].concat(s)),this.state={titleId:c("uniqueID")()},q}o.prototype.render=function(){var p=this.props.color||(c("CurrentUser").isWorkUser()?"#373e4c":"#0084ff"),q={height:this.props.height||"85%"};if(this.props.location!==c("MercuryShareAttachmentRenderLocations").CHAT&&this.props.location!==c("MercuryShareAttachmentRenderLocations").PAGES_INBOX)q.width="66%";return c("React").createElement("svg",{"aria-labelledby":this.state.titleId,version:"1.1",viewBox:"0 0 40.16 42.24",preserveAspectRatio:"xMinYMax meet",style:q},c("React").createElement("title",{id:this.state.titleId},n),c("React").createElement("path",{d:"M935.36,1582.44a0,0,0,0,0,0,.06,3.59,3.59,0,0,1-.72,6.53,0,0,0,0,0,0,0,3.56,3.56,0,0,1,.71,2.13,3.6,3.6,0,0,1-3,3.54, 0,0,0,0,0,0,.05,3.56,3.56,0,0,1,.38,1.61,3.61,3.61,0,0,1-3.42,3.6H910v-19.6l5.27-7.9a4,4,0,0,0,.66-2.31l-0.1-4c-0.22-2.4-.09-2.06, 1.13-2.37,2-.51,7.16,1.59,5.13,12.17h11.06A3.59,3.59,0,0,1,935.36,1582.44ZM899,1581h7v22h-7v-22Z",transform:"translate(-898.5 -1563.26)",fill:m,fillRule:"evenodd",stroke:p,strokeLinecap:"round",strokeWidth:"5%"}))};o.propTypes={color:l.string,height:l.string,location:l.string};f.exports=o}),null);
__d("MNPlatformAttributionTags",[],(function a(b,c,d,e,f,g){f.exports={ATTRIBUTION_TAGS_PREFIX:"bnp:trigger:",CUSTOMER_CHAT_PLUGIN:"customer_chat_plugin",MESSENGERDOTCOM:"messengerdotcom",MESSENGER_WEB:"messenger_web",MESSENGER_WEB_SEARCH:"messenger_web_search",M_DOT_ME:"m_dot_me"}}),null);
__d("MessengerDiscoveryEntryPoint",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({BROWSER_PROFILE_ICON:"browser_profile_icon",FB_STORY:"fb_story",ANONYMOUS_MESSAGING:"anonymous_messaging",MESSENGER_SEARCH:"messenger_search",MESSENGER_SEARCH_HOME:"messenger_search:home",MESSENGER_SEARCH_PEOPLE:"messenger_search:people",MESSENGER_SEARCH_GAMES:"messenger_search:games",MESSENGER_SEARCH_DISCOVER:"messenger_search:discover",BEGIN_SHARE_FLOW:"begin_share_flow",APP_INSIGHTS:"app_insights",BRANDED_CAMERA:"branded_camera",BRANDED_CAMERA_XMA:"branded_camera:xma",BRANDED_CAMERA_CTM_ADS:"branded_camera:ctm_ads",SAMPLE_BOTS:"sample_bots",TRANSPORTATION:"transportation",FB_LOGIN_ALERTS:"fb_login_alerts",MESSENGERDOTCOM:"messengerdotcom",MESSENGERDOTCOM_WEB_SEARCH:"messengerdotcom:web_search",MESSENGERDOTCOM_PAGES_PLUGIN:"messengerdotcom:pages_plugin",MESSENGER_INBOX:"messenger_inbox",MESSENGER_INBOX_THREAD_LIST:"messenger_inbox:thread_list",MESSENGER_INBOX_IN_THREAD:"messenger_inbox:in_thread",UNKNOWN:"unknown",UNKNOWN_BNP_PSID:"unknown:bnp_psid",FB_SEARCH:"fb_search",FB_SEARCH_SEARCH_ENTITY_CARD:"fb_search:search_entity_card",SPONSORED_MESSAGES_ADS:"sponsored_messages_ads",FB_FEED:"fb_feed",FB_FEED_ORGANIC_FEED_STORY:"fb_feed:organic_feed_story",FB_FEED_ADS_FEED_STORY:"fb_feed:ads_feed_story",FB_FEED_PAGE_HOVER_CARD:"fb_feed:page_hover_card",CUSTOMER_MATCHING:"customer_matching",CUSTOMER_MATCHING_PHONE_NUMBER:"customer_matching:phone_number",CLICK_TO_MESSENGER_AD:"click_to_messenger_ad",CLICK_TO_MESSENGER_AD_MESSENGER_DEEPLINK_ADS:"click_to_messenger_ad:messenger_deeplink_ads",CLICK_TO_MESSENGER_AD_ADS_WELCOME_ADMIN:"click_to_messenger_ad:ads_welcome_admin",MDOTME:"mdotme",ADMIN_MESSAGES:"admin_messages",BUSINESS_ON_MESSENGER:"business_on_messenger",SUBSCRIPTIONS:"subscriptions",FB_PAGE:"fb_page",FB_PAGE_SEND_AND_POST_FROM_COMPOSER:"fb_page:send_and_post_from_composer",FB_PAGE_SHOP_PDP:"fb_page:shop_pdp",FB_PAGE_FREQUENTLY_ASKED_QUESTION_CARD:"fb_page:frequently_asked_question_card",FB_PAGE_ABOUT_CARD_DETAIL_VIEW:"fb_page:about_card_detail_view",FB_PAGE_RESPONSIVENESS_CONTEXT_CARD:"fb_page:responsiveness_context_card",FB_PAGE_ABOUT_CARD:"fb_page:about_card",FB_PAGE_ABOUT_CARD_PQI_MESSAGE_UPSELL:"fb_page:about_card_pqi_message_upsell",FB_PAGE_PAGE_HEADER:"fb_page:page_header",FB_PAGE_PRIMARY_MESSAGE_BUTTON:"fb_page:primary_message_button",FB_PAGE_SECONDARY_MESSAGE_BUTTON:"fb_page:secondary_message_button",FB_PAGE_FB_PAGE_CTA_PAGES_ACTIONS_UNIT:"fb_page:fb_page_cta_pages_actions_unit",FB_PAGE_JEWEL_THREAD:"fb_page:jewel_thread",FB_PAGE_USER_MESSAGE_PROMPT:"fb_page:user_message_prompt",FB_PAGE_PAGES_INFO:"fb_page:pages_info",FB_PAGE_LOADED_FROM_DATA:"fb_page:loaded_from_data",FB_PAGE_CHAT_SIDEBAR_TYPEAHEAD:"fb_page:chat_sidebar_typeahead",FB_PAGE_DYNAMICHOVERCARD:"fb_page:dynamicHoverCard",FB_PAGE_ABOUT_ROW:"fb_page:about_row",FB_PAGE_PYMM_RHC:"fb_page:pymm_rhc",FB_PAGE_GROUPS_RHC:"fb_page:groups_rhc",FB_PAGE_CONTEXT_CARD:"fb_page:context_card",FB_PAGE_CONTEXTUAL_RECOMMENDATIONS:"fb_page:contextual_recommendations",FB_PAGE_SEARCHENTITYCARD:"fb_page:searchEntityCard",FB_PAGE_MESSAGE_RECEIVED:"fb_page:message_received",FB_PAGE_PAGE_HOVERCARD:"fb_page:page_hovercard",FB_PAGE_QUESTION_TRIGGERED_CONVO:"fb_page:question_triggered_convo",FB_PAGE_DEFAULT_NATIVE_TEMPLATES_CTA:"fb_page:default_native_templates_cta",FB_PAGE_LAUNCHPAD_MORE_DRAWER:"fb_page:launchpad_more_drawer",FB_PAGE_LAUNCHPAD_HEADER:"fb_page:launchpad_header",FB_PAGE_LAUNCHPAD_FOOTER:"fb_page:launchpad_footer",PIXEL_EVENT:"pixel_event",FB_HEADER_DOCK:"fb_header_dock",FB_HEADER_DOCK_JEWEL_THREAD:"fb_header_dock:jewel_thread",FB_HEADER_DOCK_JEWEL_SEE_ALL_MESSAGES:"fb_header_dock:jewel_see_all_messages",CUSTOMER_CHAT_PLUGIN:"customer_chat_plugin",NULL_STATE_CTA:"null_state_cta",INSTANT_GAMES:"instant_games",INSTANT_GAMES_ADMIN_INTRO:"instant_games:admin_intro",BROADCAST:"broadcast",SEND_TO_MESSENGER_PLUGIN:"send_to_messenger_plugin",WORK_CHAT:"work_chat",WORK_CHAT_WORK_IDS:"work_chat:work_ids",WORK_CHAT_EMAIL:"work_chat:email",CHECKBOX_PLUGIN:"checkbox_plugin",M:"m",PRIVATE_REPLY:"private_reply",PRIVATE_REPLY_ADMIN:"private_reply:admin",DYNAMIC_LOCAL_ADS:"dynamic_local_ads"})}),null);
__d("MessengerDiscoveryLoggingEnums",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ENTRYPOINT_PREFIX:"entrypoint:"})}),null);
__d("MessengerDiscoveryEntryPointsLoggingHelper",["MessengerDiscoveryEntryPoint","MessengerDiscoveryLoggingEnums"],(function a(b,c,d,e,f,g){"use strict";var h={getEntryPointsLoggingTagStr:function i(j){if(j.length==0||Object.values(c("MessengerDiscoveryEntryPoint")).indexOf(j[0])==-1)throw new Error("Please use enums in MessengerDiscoveryEntryPoints class");return c("MessengerDiscoveryLoggingEnums").ENTRYPOINT_PREFIX+j.join(":")}};f.exports=h}),null);
__d("LiveChatPluginSessionUtil",["Arbiter","WebStorage"],(function a(b,c,d,e,f,g){__p&&__p();var h={LIVECHAT_SESSION_PREFIX:"messenger_live_chat",LIVECHAT_SESSION_KEY:"messenger_live_chat_session_key",getChatStarted:function i(){var j=this.getSessionState();return j&&j.chatStarted||false},setChatStarted:function i(j){var k=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},k,{chatStarted:j}))},setRefSent:function i(j){var k=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},k,{refSent:j}))},getRefSent:function i(){var j=this.getSessionState();return j&&j.refSent||false},getIsDialogHidden:function i(){var j=this.getSessionState();return j&&j.isDialogHidden||false},setIsDialogHidden:function i(j){var k=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},k,{isDialogHidden:j}));c("Arbiter").inform("CustomerChatAlert/dialogToggled",j)},getRequestID:function i(){var j=this.getSessionState();return j&&j.requestID||""},setRequestID:function i(j){var k=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},k,{requestID:j}))},setCurrentSessionKey:function i(j,k,l){var m=c("WebStorage").getSessionStorage();if(m)m.setItem(h.LIVECHAT_SESSION_KEY,this.getSessionKey(j,k,l))},getCurrentSessionKey:function i(){var j=c("WebStorage").getSessionStorage();if(j)return j.getItem(h.LIVECHAT_SESSION_KEY);return null},getSessionState:function i(){__p&&__p();try{var j=c("WebStorage").getSessionStorageForRead();if(j){var k=this.getCurrentSessionKey();if(!k)return null;var l=j.getItem(k);if(l)return JSON.parse(l)}return null}catch(m){return null}},setSessionState:function i(j){var k=c("WebStorage").getSessionStorage();if(k){var l=this.getCurrentSessionKey();if(l)k.setItem(l,JSON.stringify(j))}},removeSessionState:function i(j){var k=c("WebStorage").getSessionStorage();if(k&&j)k.removeItem(j)},getSessionKey:function i(j,k,l){return h.LIVECHAT_SESSION_PREFIX+"_"+j+"_"+k+"_"+l}};f.exports=h}),null);
__d("LiveChatPluginLoggerUtil",["BanzaiODS","LiveChatPluginSessionUtil","MessengerDiscoveryEntryPoint","MessengerDiscoveryEntryPointsLoggingHelper","MessengerLiveChatPluginEvent","MessengerLiveChatPluginTypedLogger","MNPlatformAttributionTags","emptyFunction","performanceAbsoluteNow"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={logAction:function i(j,k,l,m){var n=arguments.length<=4||arguments[4]===undefined?null:arguments[4],o=arguments.length<=5||arguments[5]===undefined?null:arguments[5],p=arguments.length<=6||arguments[6]===undefined?null:arguments[6],q=c("LiveChatPluginSessionUtil").getRequestID();new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(k).setPageID(l).setRequestID(q).setEvent(j).setEventTimestamp(Date.now()).setDebugData(m).setThemeColor(n).setLoggedInGreeting(o).setLoggedOutGreeting(p).logVital()},logTTI:function i(j,k,l){this.logTTI=c("emptyFunction");var m=c("performanceAbsoluteNow")()-l;new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(j).setPageID(k).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setDuration(m).setEvent(c("MessengerLiveChatPluginEvent").PLUGIN_TTI).setEventTimestamp(Date.now()).logVital()},logDelta:function i(j,k,l,m,n,o){new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(j).setPageID(k).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setDebugData(JSON.stringify({isShadow:n,seqId:o})).setEvent(c("MessengerLiveChatPluginEvent").DELTA_RECEIVED).setDeltaType(l).setGateway(m).setEventTimestamp(Date.now()).log();c("BanzaiODS").bumpEntityKey("messenger_commerce","customer_chat_plugin.client."+m+".delta_received."+l)},logChatDisplayDone:function i(j,k,l){this.logChatDisplayDone=c("emptyFunction");var m=c("performanceAbsoluteNow")()-l;new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(j).setPageID(k).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setDuration(m).setEvent(c("MessengerLiveChatPluginEvent").CHAT_DISPLAY_DONE).setEventTimestamp(Date.now()).logVital()},getAttributionTags:function i(){var j=[c("MessengerDiscoveryEntryPoint").CUSTOMER_CHAT_PLUGIN];return[c("MNPlatformAttributionTags").ATTRIBUTION_TAGS_PREFIX+c("MNPlatformAttributionTags").CUSTOMER_CHAT_PLUGIN,c("MessengerDiscoveryEntryPointsLoggingHelper").getEntryPointsLoggingTagStr(j)]}};f.exports=h}),null);
__d("MessengerLiveChatPluginGateway",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({MQTT:"mqtt",ICEBREAKER:"icebreaker"})}),null);
__d("LiveChatIcebreakerClient",["Arbiter","ChannelConstants","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MessengerLiveChatPluginEvent","MessengerLiveChatPluginGateway","MessengerLiveChatPluginTypedLogger","Random","URI","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=(c("Random").random()*2147483648|0).toString(16),i=20,j=2e3,k={CONNECTING:0,OPEN:1,CLOSED:2};function l(m,n,o,p){__p&&__p();this.$LiveChatIcebreakerClient7=function(q){__p&&__p();try{var r=JSON.parse(q.data),s=r&&r.delta&&r.delta["class"]||"unknown",t=!this.$LiveChatIcebreakerClient5&&!c("gkx")("AT7JCav-mnZaXvxvDZIStsaHGOzW3wm3IcqOSc7xoesh9oMNPR0bSOyfLxBj6PCvVKOi8MrYYxdqv_TpZOkUtcGctqpnKAug6HnuZMaG4wXC1Q");if(t){var u=c("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":c("ChannelConstants").getArbiterType("delta");c("Arbiter").inform(u,{obj:r})}var v=r&&r.iseq;if(v)this.$LiveChatIcebreakerClient2=v;c("LiveChatPluginLoggerUtil").logDelta(this.$LiveChatIcebreakerClient4,this.$LiveChatIcebreakerClient1,s,c("MessengerLiveChatPluginGateway").ICEBREAKER,!t,v)}catch(w){new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$LiveChatIcebreakerClient4).setPageID(this.$LiveChatIcebreakerClient1).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setEvent(c("MessengerLiveChatPluginEvent").DELTA_PARSING_ERROR).setEventTimestamp(Date.now()).logVital()}}.bind(this);this.$LiveChatIcebreakerClient1=m;this.$LiveChatIcebreakerClient2=0;this.$LiveChatIcebreakerClient4=n;this.$LiveChatIcebreakerClient5=p;this.$LiveChatIcebreakerClient3=new(c("URI"))("https://streaming-graph.facebook.com/messenger_livechat").addQueryData("pageId",this.$LiveChatIcebreakerClient1).addQueryData("appId",225396507985893).addQueryData("userId",n).addQueryData("accountId",n).addQueryData("deviceId",h).addQueryData("requestId",c("LiveChatPluginSessionUtil").getRequestID()).addQueryData("originDomain",o)}l.prototype.connectWithRetries=function(){__p&&__p();var m=arguments.length<=0||arguments[0]===undefined?0:arguments[0];try{if(!window.EventSource)return;if(m>i)return;this.$LiveChatIcebreakerClient6=new EventSource(this.$LiveChatIcebreakerClient3.addQueryData("irisSeqId",this.$LiveChatIcebreakerClient2).toString(),{withCredentials:true});this.$LiveChatIcebreakerClient6.addEventListener("iris_delta",this.$LiveChatIcebreakerClient7);this.$LiveChatIcebreakerClient6.addEventListener("error",function(o){if(this.$LiveChatIcebreakerClient6.readyState===k.CLOSED)setTimeout(function(){this.connectWithRetries(m+1)}.bind(this),j)}.bind(this))}catch(n){this.disconnect();setTimeout(function(){this.connectWithRetries(m+1)}.bind(this),j)}};l.prototype.disconnect=function(){if(this.$LiveChatIcebreakerClient6)this.$LiveChatIcebreakerClient6.close()};f.exports=l}),null);
__d("MqttLogger",["BanzaiODS","Log","LogHistory","MarauderLogger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="mqtt_client",i=null,j={CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish"};k.getInstance=function(){if(!i)i=new k();return i};function k(){this.$MqttLogger1=c("LogHistory").getInstance(h);this.$MqttLogger2=null}k.prototype.setAppId=function(l){if(!this.$MqttLogger2)this.$MqttLogger2=l};k.prototype.logConnect=function(l){this.bumpCounter(j.CONNECT+"."+l.status);this.$MqttLogger3(j.CONNECT,l)};k.prototype.logDisconnect=function(l){this.bumpCounter(j.DISCONNECT);this.$MqttLogger3(j.DISCONNECT,l)};k.prototype.logPublish=function(l){this.bumpCounter(j.PUBLISH+"."+l.topic);this.$MqttLogger3(j.PUBLISH,l)};k.prototype.logError=function(event,l){};k.prototype.debugTrace=function(event,l){};k.prototype.bumpCounter=function(l){if(this.$MqttLogger2)c("BanzaiODS").bumpEntityKey("mqtt_ws_client",this.$MqttLogger2+"."+l);c("BanzaiODS").bumpEntityKey("mqtt_ws_client",l)};k.prototype.$MqttLogger3=function(event,l){l.user_agent=navigator.userAgent;l.platform=navigator.platform;l.href=window.location.href;this.$MqttLogger1.log(event,l);c("MarauderLogger").log(event,h,l)};f.exports=k}),null);
/**
 * License: https://www.facebook.com/legal/license/-SPK4hgBf7r/
 */
__d("paho-mqtt",[],(function a(b,c,d,e,f,g){__p&&__p();(function h(i,j){__p&&__p();if(typeof g==="object"&&typeof f==="object")f.exports=j();else if(typeof define==="function"&&define.amd)define(j);else if(typeof g==="object")g=j();else{if(typeof i.Paho==="undefined")i.Paho={};i.Paho.MQTT=j()}})(this,function h(){__p&&__p();var i=function(b){__p&&__p();var j="@VERSION@",k="@BUILDLEVEL@",l={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},m=function m(H,I){__p&&__p();for(var J in H)if(Object.prototype.hasOwnProperty.call(H,J))if(Object.prototype.hasOwnProperty.call(I,J)){if(typeof H[J]!==I[J])throw new Error(q(o.INVALID_TYPE,[typeof H[J],J]))}else{var K="Unknown property, "+J+". Valid properties are:";for(var L in I)if(Object.prototype.hasOwnProperty.call(I,L))K=K+" "+L;throw new Error(K)}},n=function n(H,I){return function(){return H.apply(I,arguments)}},o={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed: code {0} reason {1} wasClean {2}."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},p={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},q=function q(H,I){__p&&__p();var J=H.text;if(I){var K,L;for(var M=0;M<I.length;M++){K="{"+M+"}";L=J.indexOf(K);if(L>0){var N=J.substring(0,L),O=J.substring(L+K.length);J=N+I[M]+O}}}return J},r=[0,6,77,81,73,115,100,112,3],s=[0,4,77,81,84,84,4],t=function t(H,I){this.type=H;for(var J in I)if(Object.prototype.hasOwnProperty.call(I,J))this[J]=I[J]};t.prototype.encode=function(){__p&&__p();var H=(this.type&15)<<4,I=0,J=[],K=0,L;if(this.messageIdentifier!==undefined)I+=2;switch(this.type){case l.CONNECT:switch(this.mqttVersion){case 3:I+=r.length+3;break;case 4:I+=s.length+3;break}I+=z(this.clientId)+2;if(this.willMessage!==undefined){I+=z(this.willMessage.destinationName)+2;L=this.willMessage.payloadBytes;if(!(L instanceof Uint8Array))L=new Uint8Array(N);I+=L.byteLength+2}if(this.userName!==undefined)I+=z(this.userName)+2;if(this.password!==undefined)I+=z(this.password)+2;break;case l.SUBSCRIBE:H|=2;for(var M=0;M<this.topics.length;M++){J[M]=z(this.topics[M]);I+=J[M]+2}I+=this.requestedQos.length;break;case l.UNSUBSCRIBE:H|=2;for(var M=0;M<this.topics.length;M++){J[M]=z(this.topics[M]);I+=J[M]+2}break;case l.PUBREL:H|=2;break;case l.PUBLISH:if(this.payloadMessage.duplicate)H|=8;H=H|=this.payloadMessage.qos<<1;if(this.payloadMessage.retained)H|=1;K=z(this.payloadMessage.destinationName);I+=K+2;var N=this.payloadMessage.payloadBytes;I+=N.byteLength;if(N instanceof ArrayBuffer)N=new Uint8Array(N);else if(!(N instanceof Uint8Array))N=new Uint8Array(N.buffer);break;case l.DISCONNECT:break;default:break}var O=y(I),P=O.length+1,Q=new ArrayBuffer(I+P),R=new Uint8Array(Q);R[0]=H;R.set(O,1);if(this.type==l.PUBLISH)P=w(this.payloadMessage.destinationName,K,R,P);else if(this.type==l.CONNECT){switch(this.mqttVersion){case 3:R.set(r,P);P+=r.length;break;case 4:R.set(s,P);P+=s.length;break}var S=0;if(this.cleanSession)S=2;if(this.willMessage!==undefined){S|=4;S|=this.willMessage.qos<<3;if(this.willMessage.retained)S|=32}if(this.userName!==undefined)S|=128;if(this.password!==undefined)S|=64;R[P++]=S;P=v(this.keepAliveInterval,R,P)}if(this.messageIdentifier!==undefined)P=v(this.messageIdentifier,R,P);switch(this.type){case l.CONNECT:P=w(this.clientId,z(this.clientId),R,P);if(this.willMessage!==undefined){P=w(this.willMessage.destinationName,z(this.willMessage.destinationName),R,P);P=v(L.byteLength,R,P);R.set(L,P);P+=L.byteLength}if(this.userName!==undefined)P=w(this.userName,z(this.userName),R,P);if(this.password!==undefined)P=w(this.password,z(this.password),R,P);break;case l.PUBLISH:R.set(N,P);break;case l.SUBSCRIBE:for(var M=0;M<this.topics.length;M++){P=w(this.topics[M],J[M],R,P);R[P++]=this.requestedQos[M]}break;case l.UNSUBSCRIBE:for(var M=0;M<this.topics.length;M++)P=w(this.topics[M],J[M],R,P);break;default:}return Q};function u(H,I){__p&&__p();var J=I,K=H[I],L=K>>4,M=K&=15;I+=1;var N,O=0,P=1;do{if(I==H.length)return[null,J];N=H[I++];O+=(N&127)*P;P*=128}while((N&128)!==0);var Q=I+O;if(Q>H.length)return[null,J];var R=new t(L);switch(L){case l.CONNACK:var S=H[I++];if(S&1)R.sessionPresent=true;R.returnCode=H[I++];break;case l.PUBLISH:var T=M>>1&3,U=x(H,I);I+=2;var V=B(H,I,U);I+=U;if(T>0){R.messageIdentifier=x(H,I);I+=2}var W=new G(H.subarray(I,Q));if((M&1)==1)W.retained=true;if((M&8)==8)W.duplicate=true;W.qos=T;W.destinationName=V;R.payloadMessage=W;break;case l.PUBACK:case l.PUBREC:case l.PUBREL:case l.PUBCOMP:case l.UNSUBACK:R.messageIdentifier=x(H,I);break;case l.SUBACK:R.messageIdentifier=x(H,I);I+=2;R.returnCode=H.subarray(I,Q);break;default:break}return[R,Q]}function v(H,I,J){I[J++]=H>>8;I[J++]=H%256;return J}function w(H,I,J,K){K=v(I,J,K);A(H,J,K);return K+I}function x(H,I){return 256*H[I]+H[I+1]}function y(H){var I=new Array(1),J=0;do{var K=H%128;H=H>>7;if(H>0)K|=128;I[J++]=K}while(H>0&&J<4);return I}function z(H){__p&&__p();var I=0;for(var J=0;J<H.length;J++){var K=H.charCodeAt(J);if(K>2047){if(55296<=K&&K<=56319){J++;I++}I+=3}else if(K>127)I+=2;else I++}return I}function A(H,I,J){__p&&__p();var K=J;for(var L=0;L<H.length;L++){var M=H.charCodeAt(L);if(55296<=M&&M<=56319){var N=H.charCodeAt(++L);if(isNaN(N))throw new Error(q(o.MALFORMED_UNICODE,[M,N]));M=(M-55296<<10)+(N-56320)+65536}if(M<=127)I[K++]=M;else if(M<=2047){I[K++]=M>>6&31|192;I[K++]=M&63|128}else if(M<=65535){I[K++]=M>>12&15|224;I[K++]=M>>6&63|128;I[K++]=M&63|128}else{I[K++]=M>>18&7|240;I[K++]=M>>12&63|128;I[K++]=M>>6&63|128;I[K++]=M&63|128}}return I}function B(H,I,J){__p&&__p();var K="",L,M=I;while(M<I+J){var N=H[M++];if(N<128)L=N;else{var O=H[M++]-128;if(O<0)throw new Error(q(o.MALFORMED_UTF,[N.toString(16),O.toString(16),""]));if(N<224)L=64*(N-192)+O;else{var P=H[M++]-128;if(P<0)throw new Error(q(o.MALFORMED_UTF,[N.toString(16),O.toString(16),P.toString(16)]));if(N<240)L=4096*(N-224)+64*O+P;else{var Q=H[M++]-128;if(Q<0)throw new Error(q(o.MALFORMED_UTF,[N.toString(16),O.toString(16),P.toString(16),Q.toString(16)]));if(N<248)L=262144*(N-240)+4096*O+64*P+Q;else throw new Error(q(o.MALFORMED_UTF,[N.toString(16),O.toString(16),P.toString(16),Q.toString(16)]))}}}if(L>65535){L-=65536;K+=String.fromCharCode(55296+(L>>10));L=56320+(L&1023)}K+=String.fromCharCode(L)}return K}var C=function C(H,I,J){__p&&__p();this._client=H;this._window=I;this._keepAliveInterval=J*1e3;this.isReset=false;var K=new t(l.PINGREQ).encode(),L=function L(N){return function(){return M.apply(N)}},M=function M(){if(!this.isReset){this._client._trace("Pinger.doPing","Timed out");this._client._disconnected(o.PING_TIMEOUT.code,q(o.PING_TIMEOUT))}else{this.isReset=false;this._client._trace("Pinger.doPing","send PINGREQ");this._client.socket.send(K);this.timeout=this._window.setTimeout(L(this),this._keepAliveInterval)}};this.reset=function(){this.isReset=true;this._window.clearTimeout(this.timeout);if(this._keepAliveInterval>0)this.timeout=setTimeout(L(this),this._keepAliveInterval)};this.cancel=function(){this._window.clearTimeout(this.timeout)}},D=function D(H,I,J,K,L){this._window=I;if(!J)J=30;var M=function M(K,H,L){return function(){return K.apply(H,L)}};this.timeout=setTimeout(M(K,H,L),J*1e3);this.cancel=function(){this._window.clearTimeout(this.timeout)}},E=function E(H,I,J,K,L){__p&&__p();if(!("WebSocket"in b&&b.WebSocket!==null))throw new Error(q(o.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in b&&b.localStorage!==null))throw new Error(q(o.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in b&&b.ArrayBuffer!==null))throw new Error(q(o.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",H,I,J,K,L);this.host=I;this.port=J;this.path=K;this.uri=H;this.clientId=L;this._wsuri=null;this._localKey=I+":"+J+(K!="/mqtt"?":"+K:"")+":"+L+":";this._msg_queue=[];this._buffered_msg_queue=[];this._sentMessages={};this._receivedMessages={};this._notify_msg_sent={};this._message_identifier=1;this._sequence=0;for(var M in localStorage)if(M.indexOf("Sent:"+this._localKey)===0||M.indexOf("Received:"+this._localKey)===0)this.restore(M)};E.prototype.host=null;E.prototype.port=null;E.prototype.path=null;E.prototype.uri=null;E.prototype.clientId=null;E.prototype.socket=null;E.prototype.connected=false;E.prototype.maxMessageIdentifier=65536;E.prototype.connectOptions=null;E.prototype.hostIndex=null;E.prototype.onConnected=null;E.prototype.onConnectionLost=null;E.prototype.onMessageDelivered=null;E.prototype.onMessageArrived=null;E.prototype.traceFunction=null;E.prototype._msg_queue=null;E.prototype._buffered_msg_queue=null;E.prototype._connectTimeout=null;E.prototype.sendPinger=null;E.prototype.receivePinger=null;E.prototype._reconnectInterval=1;E.prototype._reconnecting=false;E.prototype._reconnectTimeout=null;E.prototype.disconnectedPublishing=false;E.prototype.disconnectedBufferSize=5e3;E.prototype.receiveBuffer=null;E.prototype._traceBuffer=null;E.prototype._MAX_TRACE_ENTRIES=100;E.prototype.connect=function(H){__p&&__p();var I=this._traceMask(H,"password");this._trace("Client.connect",I,this.socket,this.connected);if(this.connected)throw new Error(q(o.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(q(o.INVALID_STATE,["already connected"]));if(this._reconnecting){this._reconnectTimeout.cancel();this._reconnectTimeout=null;this._reconnecting=false}this.connectOptions=H;this._reconnectInterval=1;this._reconnecting=false;if(H.uris){this.hostIndex=0;this._doConnect(H.uris[0])}else this._doConnect(this.uri)};E.prototype.subscribe=function(H,I){__p&&__p();this._trace("Client.subscribe",H,I);if(!this.connected)throw new Error(q(o.INVALID_STATE,["not connected"]));var J=new t(l.SUBSCRIBE);J.topics=[H];if(I.qos!==undefined)J.requestedQos=[I.qos];else J.requestedQos=[0];if(I.onSuccess)J.onSuccess=function(K){I.onSuccess({invocationContext:I.invocationContext,grantedQos:K})};if(I.onFailure)J.onFailure=function(K){I.onFailure({invocationContext:I.invocationContext,errorCode:K,errorMessage:q(K)})};if(I.timeout)J.timeOut=new D(this,window,I.timeout,I.onFailure,[{invocationContext:I.invocationContext,errorCode:o.SUBSCRIBE_TIMEOUT.code,errorMessage:q(o.SUBSCRIBE_TIMEOUT)}]);this._requires_ack(J);this._schedule_message(J)};E.prototype.unsubscribe=function(H,I){__p&&__p();this._trace("Client.unsubscribe",H,I);if(!this.connected)throw new Error(q(o.INVALID_STATE,["not connected"]));var J=new t(l.UNSUBSCRIBE);J.topics=[H];if(I.onSuccess)J.callback=function(){I.onSuccess({invocationContext:I.invocationContext})};if(I.timeout)J.timeOut=new D(this,window,I.timeout,I.onFailure,[{invocationContext:I.invocationContext,errorCode:o.UNSUBSCRIBE_TIMEOUT.code,errorMessage:q(o.UNSUBSCRIBE_TIMEOUT)}]);this._requires_ack(J);this._schedule_message(J)};E.prototype.send=function(H){__p&&__p();this._trace("Client.send",H);wireMessage=new t(l.PUBLISH);wireMessage.payloadMessage=H;if(this.connected){if(H.qos>0)this._requires_ack(wireMessage);else if(this.onMessageDelivered)this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage);this._schedule_message(wireMessage)}else if(this._reconnecting&&this.disconnectedPublishing){var I=Object.keys(this._sentMessages).length+this._buffered_msg_queue.length;if(I>this.disconnectedBufferSize)throw new Error(q(o.BUFFER_FULL,[this.disconnectedBufferSize]));else if(H.qos>0)this._requires_ack(wireMessage);else{wireMessage.sequence=++this._sequence;this._buffered_msg_queue.push(wireMessage)}}else throw new Error(q(o.INVALID_STATE,["not connected"]))};E.prototype.disconnect=function(){__p&&__p();this._trace("Client.disconnect");if(this._reconnecting){this._reconnectTimeout.cancel();this._reconnectTimeout=null;this._reconnecting=false}if(!this.socket)throw new Error(q(o.INVALID_STATE,["not connecting or connected"]));wireMessage=new t(l.DISCONNECT);this._notify_msg_sent[wireMessage]=n(this._disconnected,this);this._schedule_message(wireMessage)};E.prototype.getTraceLog=function(){if(this._traceBuffer!==null){this._trace("Client.getTraceLog",new Date());this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var H in this._sentMessages)this._trace("_sentMessages ",H,this._sentMessages[H]);for(var H in this._receivedMessages)this._trace("_receivedMessages ",H,this._receivedMessages[H]);return this._traceBuffer}};E.prototype.startTrace=function(){if(this._traceBuffer===null)this._traceBuffer=[];this._trace("Client.startTrace",new Date(),j)};E.prototype.stopTrace=function(){delete this._traceBuffer};E.prototype._doConnect=function(H){__p&&__p();if(this.connectOptions.useSSL){var I=H.split(":");I[0]="wss";H=I.join(":")}this._wsuri=H;this.connected=false;if(this.connectOptions.ignoreSubProtocol)this.socket=new WebSocket(H);else if(this.connectOptions.mqttVersion<4)this.socket=new WebSocket(H,["mqttv3.1"]);else this.socket=new WebSocket(H,["mqtt"]);this.socket.binaryType="arraybuffer";this.socket.onopen=n(this._on_socket_open,this);this.socket.onmessage=n(this._on_socket_message,this);this.socket.onerror=n(this._on_socket_error,this);this.socket.onclose=n(this._on_socket_close,this);this.sendPinger=new C(this,window,this.connectOptions.keepAliveInterval);this.receivePinger=new C(this,window,this.connectOptions.keepAliveInterval);if(this._connectTimeout){this._connectTimeout.cancel();this._connectTimeout=null}this._connectTimeout=new D(this,window,this.connectOptions.timeout,this._disconnected,[o.CONNECT_TIMEOUT.code,q(o.CONNECT_TIMEOUT)])};E.prototype._schedule_message=function(H){this._msg_queue.push(H);if(this.connected)this._process_queue()};E.prototype.store=function(H,I){};E.prototype.restore=function(H){};E.prototype._process_queue=function(){var H=null,I=this._msg_queue.reverse();while(H=I.pop()){this._socket_send(H);if(this._notify_msg_sent[H]){this._notify_msg_sent[H]();delete this._notify_msg_sent[H]}}};E.prototype._requires_ack=function(H){__p&&__p();var I=Object.keys(this._sentMessages).length;if(I>this.maxMessageIdentifier)throw Error("Too many messages:"+I);while(this._sentMessages[this._message_identifier]!==undefined)this._message_identifier++;H.messageIdentifier=this._message_identifier;this._sentMessages[H.messageIdentifier]=H;if(H.type===l.PUBLISH)this.store("Sent:",H);if(this._message_identifier===this.maxMessageIdentifier)this._message_identifier=1};E.prototype._on_socket_open=function(){var H=new t(l.CONNECT,this.connectOptions);H.clientId=this.clientId;this._socket_send(H)};E.prototype._on_socket_message=function(event){this._trace("Client._on_socket_message",event.data);var H=this._deframeMessages(event.data);for(var I=0;I<H.length;I+=1)this._handleMessage(H[I])};E.prototype._deframeMessages=function(H){__p&&__p();var I=new Uint8Array(H),J=[];if(this.receiveBuffer){var K=new Uint8Array(this.receiveBuffer.length+I.length);K.set(this.receiveBuffer);K.set(I,this.receiveBuffer.length);I=K;delete this.receiveBuffer}try{var L=0;while(L<I.length){var M=u(I,L),N=M[0];L=M[1];if(N!==null)J.push(N);else break}if(L<I.length)this.receiveBuffer=I.subarray(L)}catch(O){var P=Object.prototype.hasOwnProperty.call(O,"stack")=="undefined"?O.stack.toString():"No Error Stack Available";this._disconnected(o.INTERNAL_ERROR.code,q(o.INTERNAL_ERROR,[O.message,P]));return}return J};E.prototype._handleMessage=function(H){__p&&__p();this._trace("Client._handleMessage",H);try{switch(H.type){case l.CONNACK:this._connectTimeout.cancel();if(this._reconnectTimeout)this._reconnectTimeout.cancel();if(this.connectOptions.cleanSession){for(var I in this._sentMessages){var J=this._sentMessages[I];localStorage.removeItem("Sent:"+this._localKey+J.messageIdentifier)}this._sentMessages={};for(var I in this._receivedMessages){var K=this._receivedMessages[I];localStorage.removeItem("Received:"+this._localKey+K.messageIdentifier)}this._receivedMessages={}}if(H.returnCode===0){this.connected=true;if(this.connectOptions.uris)this.hostIndex=this.connectOptions.uris.length}else{this._disconnected(o.CONNACK_RETURNCODE.code,q(o.CONNACK_RETURNCODE,[H.returnCode,p[H.returnCode]]));break}var L=[];for(var M in this._sentMessages)if(Object.prototype.hasOwnProperty.call(this._sentMessages,M))L.push(this._sentMessages[M]);if(this._buffered_msg_queue.length>0){var N=null,O=this._buffered_msg_queue.reverse();while(N=O.pop()){L.push(N);if(this.onMessageDelivered)this._notify_msg_sent[N]=this.onMessageDelivered(N.payloadMessage)}}var L=L.sort(function(W,X){return W.sequence-X.sequence});for(var P=0,Q=L.length;P<Q;P++){var J=L[P];if(J.type==l.PUBLISH&&J.pubRecReceived){var R=new t(l.PUBREL,{messageIdentifier:J.messageIdentifier});this._schedule_message(R)}else this._schedule_message(J)}if(this.connectOptions.onSuccess)this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var S=false;if(this._reconnecting){S=true;this._reconnectInterval=1;this._reconnecting=false}this._connected(S,this._wsuri);this._process_queue();break;case l.PUBLISH:this._receivePublish(H);break;case l.PUBACK:var J=this._sentMessages[H.messageIdentifier];if(J){delete this._sentMessages[H.messageIdentifier];localStorage.removeItem("Sent:"+this._localKey+H.messageIdentifier);if(this.onMessageDelivered)this.onMessageDelivered(J.payloadMessage)}break;case l.PUBREC:var J=this._sentMessages[H.messageIdentifier];if(J){J.pubRecReceived=true;var R=new t(l.PUBREL,{messageIdentifier:H.messageIdentifier});this.store("Sent:",J);this._schedule_message(R)}break;case l.PUBREL:var K=this._receivedMessages[H.messageIdentifier];localStorage.removeItem("Received:"+this._localKey+H.messageIdentifier);if(K){this._receiveMessage(K);delete this._receivedMessages[H.messageIdentifier]}var T=new t(l.PUBCOMP,{messageIdentifier:H.messageIdentifier});this._schedule_message(T);break;case l.PUBCOMP:var J=this._sentMessages[H.messageIdentifier];delete this._sentMessages[H.messageIdentifier];localStorage.removeItem("Sent:"+this._localKey+H.messageIdentifier);if(this.onMessageDelivered)this.onMessageDelivered(J.payloadMessage);break;case l.SUBACK:var J=this._sentMessages[H.messageIdentifier];if(J){if(J.timeOut)J.timeOut.cancel();if(H.returnCode[0]===128){if(J.onFailure)J.onFailure(H.returnCode)}else if(J.onSuccess)J.onSuccess(H.returnCode);delete this._sentMessages[H.messageIdentifier]}break;case l.UNSUBACK:var J=this._sentMessages[H.messageIdentifier];if(J){if(J.timeOut)J.timeOut.cancel();if(J.callback)J.callback();delete this._sentMessages[H.messageIdentifier]}break;case l.PINGRESP:this.sendPinger.reset();break;case l.DISCONNECT:this._disconnected(o.INVALID_MQTT_MESSAGE_TYPE.code,q(o.INVALID_MQTT_MESSAGE_TYPE,[H.type]));break;default:this._disconnected(o.INVALID_MQTT_MESSAGE_TYPE.code,q(o.INVALID_MQTT_MESSAGE_TYPE,[H.type]))}}catch(U){var V=Object.prototype.hasOwnProperty.call(U,"stack")=="undefined"?U.stack.toString():"No Error Stack Available";this._disconnected(o.INTERNAL_ERROR.code,q(o.INTERNAL_ERROR,[U.message,V]));return}};E.prototype._on_socket_error=function(H){if(!this._reconnecting)this._disconnected(o.SOCKET_ERROR.code,q(o.SOCKET_ERROR,[H.data]))};E.prototype._on_socket_close=function(event){if(!this._reconnecting)this._disconnected(o.SOCKET_CLOSE.code,q(o.SOCKET_CLOSE,event!=null?[event.code,event.reason,event.wasClean]:[]))};E.prototype._socket_send=function(H){if(H.type==1){var I=this._traceMask(H,"password");this._trace("Client._socket_send",I)}else this._trace("Client._socket_send",H);this.socket.send(H.encode());this.sendPinger.reset()};E.prototype._receivePublish=function(H){__p&&__p();switch(H.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(H);break;case 1:var I=new t(l.PUBACK,{messageIdentifier:H.messageIdentifier});this._schedule_message(I);this._receiveMessage(H);break;case 2:this._receivedMessages[H.messageIdentifier]=H;this.store("Received:",H);var J=new t(l.PUBREC,{messageIdentifier:H.messageIdentifier});this._schedule_message(J);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}};E.prototype._receiveMessage=function(H){if(this.onMessageArrived)this.onMessageArrived(H.payloadMessage)};E.prototype._connected=function(H,I){if(this.onConnected)this.onConnected(H,I)};E.prototype._reconnect=function(){__p&&__p();this._trace("Client._reconnect");if(!this.connected){this._reconnecting=true;this.sendPinger.cancel();this.receivePinger.cancel();if(this._reconnectInterval<128)this._reconnectInterval=this._reconnectInterval*2;if(this.connectOptions.uris){this.hostIndex=0;this._doConnect(this.connectOptions.uris[0])}else this._doConnect(this.uri)}};E.prototype._disconnected=function(H,I){__p&&__p();this._trace("Client._disconnected",H,I);if(H!==undefined&&this._reconnecting){this._reconnectTimeout=new D(this,window,this._reconnectInterval,this._reconnect);return}this.sendPinger.cancel();this.receivePinger.cancel();if(this._connectTimeout){this._connectTimeout.cancel();this._connectTimeout=null}this._msg_queue=[];this._buffered_msg_queue=[];this._notify_msg_sent={};if(this.socket){this.socket.onopen=null;this.socket.onmessage=null;this.socket.onerror=null;this.socket.onclose=null;if(this.socket.readyState===1)this.socket.close();delete this.socket}if(this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1){this.hostIndex++;this._doConnect(this.connectOptions.uris[this.hostIndex])}else{if(H===undefined){H=o.OK.code;I=q(o.OK)}if(this.connected){this.connected=false;if(this.onConnectionLost)this.onConnectionLost({errorCode:H,errorMessage:I,reconnect:this.connectOptions.reconnect,uri:this._wsuri});if(H!==o.OK.code&&this.connectOptions.reconnect){this._reconnectInterval=1;this._reconnect();return}}else if(this.connectOptions.mqttVersion===4&&this.connectOptions.mqttVersionExplicit===false){this._trace("Failed to connect V4, dropping back to V3");this.connectOptions.mqttVersion=3;if(this.connectOptions.uris){this.hostIndex=0;this._doConnect(this.connectOptions.uris[0])}else this._doConnect(this.uri)}else if(this.connectOptions.onFailure)this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:H,errorMessage:I})}};E.prototype._trace=function(){__p&&__p();if(this.traceFunction){for(var H in arguments)if(typeof arguments[H]!=="undefined")arguments.splice(H,1,JSON.stringify(arguments[H]));var I=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:I})}if(this._traceBuffer!==null)for(var H=0,J=arguments.length;H<J;H++){if(this._traceBuffer.length==this._MAX_TRACE_ENTRIES)this._traceBuffer.shift();if(H===0)this._traceBuffer.push(arguments[H]);else if(typeof arguments[H]==="undefined")this._traceBuffer.push(arguments[H]);else this._traceBuffer.push("  "+JSON.stringify(arguments[H]))}};E.prototype._traceMask=function(H,I){var J={};for(var K in H)if(Object.prototype.hasOwnProperty.call(H,K))if(K==I)J[K]="******";else J[K]=H[K];return J};var F=function F(H,I,J,K){__p&&__p();var L;if(typeof H!=="string")throw new Error(q(o.INVALID_TYPE,[typeof H,"host"]));if(arguments.length==2){K=I;L=H;var M=L.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(M){H=M[4]||M[2];I=parseInt(M[7]);J=M[8]}else throw new Error(q(o.INVALID_ARGUMENT,[H,"host"]))}else{if(arguments.length==3){K=J;J="/mqtt"}if(typeof I!=="number"||I<0)throw new Error(q(o.INVALID_TYPE,[typeof I,"port"]));if(typeof J!=="string")throw new Error(q(o.INVALID_TYPE,[typeof J,"path"]));var N=H.indexOf(":")!==-1&&H.slice(0,1)!=="["&&H.slice(-1)!=="]";L="ws://"+(N?"["+H+"]":H)+":"+I+J}var O=0;for(var P=0;P<K.length;P++){var Q=K.charCodeAt(P);if(55296<=Q&&Q<=56319)P++;O++}if(typeof K!=="string"||O>65535)throw new Error(q(o.INVALID_ARGUMENT,[K,"clientId"]));var R=new E(L,H,I,J,K);this._getHost=function(){return H};this._setHost=function(){throw new Error(q(o.UNSUPPORTED_OPERATION))};this._getPort=function(){return I};this._setPort=function(){throw new Error(q(o.UNSUPPORTED_OPERATION))};this._getPath=function(){return J};this._setPath=function(){throw new Error(q(o.UNSUPPORTED_OPERATION))};this._getURI=function(){return L};this._setURI=function(){throw new Error(q(o.UNSUPPORTED_OPERATION))};this._getClientId=function(){return R.clientId};this._setClientId=function(){throw new Error(q(o.UNSUPPORTED_OPERATION))};this._getOnConnected=function(){return R.onConnected};this._setOnConnected=function(S){if(typeof S==="function")R.onConnected=S;else throw new Error(q(o.INVALID_TYPE,[typeof S,"onConnected"]))};this._getDisconnectedPublishing=function(){return R.disconnectedPublishing};this._setDisconnectedPublishing=function(S){R.disconnectedPublishing=S};this._getDisconnectedBufferSize=function(){return R.disconnectedBufferSize};this._setDisconnectedBufferSize=function(S){R.disconnectedBufferSize=S};this._getConnectOptions=function(){return R.connectOptions};this._getOnConnectionLost=function(){return R.onConnectionLost};this._setOnConnectionLost=function(S){if(typeof S==="function")R.onConnectionLost=S;else throw new Error(q(o.INVALID_TYPE,[typeof S,"onConnectionLost"]))};this._getOnMessageDelivered=function(){return R.onMessageDelivered};this._setOnMessageDelivered=function(S){if(typeof S==="function")R.onMessageDelivered=S;else throw new Error(q(o.INVALID_TYPE,[typeof S,"onMessageDelivered"]))};this._getOnMessageArrived=function(){return R.onMessageArrived};this._setOnMessageArrived=function(S){if(typeof S==="function")R.onMessageArrived=S;else throw new Error(q(o.INVALID_TYPE,[typeof S,"onMessageArrived"]))};this._getTrace=function(){return R.traceFunction};this._setTrace=function(S){if(typeof S==="function")R.traceFunction=S;else throw new Error(q(o.INVALID_TYPE,[typeof S,"onTrace"]))};this.connect=function(S){__p&&__p();S=S||{};m(S,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",ignoreSubProtocol:"boolean",uris:"object"});if(S.keepAliveInterval===undefined)S.keepAliveInterval=60;if(S.mqttVersion>4||S.mqttVersion<3)throw new Error(q(o.INVALID_ARGUMENT,[S.mqttVersion,"connectOptions.mqttVersion"]));if(S.mqttVersion===undefined){S.mqttVersionExplicit=false;S.mqttVersion=4}else S.mqttVersionExplicit=true;if(S.password!==undefined&&S.userName===undefined)throw new Error(q(o.INVALID_ARGUMENT,[S.password,"connectOptions.password"]));if(S.willMessage){if(!(S.willMessage instanceof G))throw new Error(q(o.INVALID_TYPE,[S.willMessage,"connectOptions.willMessage"]));S.willMessage.stringPayload=null;if(typeof S.willMessage.destinationName==="undefined")throw new Error(q(o.INVALID_TYPE,[typeof S.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(typeof S.cleanSession==="undefined")S.cleanSession=true;if(S.hosts){if(!(S.hosts instanceof Array))throw new Error(q(o.INVALID_ARGUMENT,[S.hosts,"connectOptions.hosts"]));if(S.hosts.length<1)throw new Error(q(o.INVALID_ARGUMENT,[S.hosts,"connectOptions.hosts"]));var T=false;for(var P=0;P<S.hosts.length;P++){if(typeof S.hosts[P]!=="string")throw new Error(q(o.INVALID_TYPE,[typeof S.hosts[P],"connectOptions.hosts["+P+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(S.hosts[P])){if(P===0)T=true;else if(!T)throw new Error(q(o.INVALID_ARGUMENT,[S.hosts[P],"connectOptions.hosts["+P+"]"]))}else if(T)throw new Error(q(o.INVALID_ARGUMENT,[S.hosts[P],"connectOptions.hosts["+P+"]"]))}if(!T){if(!S.ports)throw new Error(q(o.INVALID_ARGUMENT,[S.ports,"connectOptions.ports"]));if(!(S.ports instanceof Array))throw new Error(q(o.INVALID_ARGUMENT,[S.ports,"connectOptions.ports"]));if(S.hosts.length!==S.ports.length)throw new Error(q(o.INVALID_ARGUMENT,[S.ports,"connectOptions.ports"]));S.uris=[];for(var P=0;P<S.hosts.length;P++){if(typeof S.ports[P]!=="number"||S.ports[P]<0)throw new Error(q(o.INVALID_TYPE,[typeof S.ports[P],"connectOptions.ports["+P+"]"]));var H=S.hosts[P],I=S.ports[P],U=H.indexOf(":")!==-1;L="ws://"+(U?"["+H+"]":H)+":"+I+J;S.uris.push(L)}}else S.uris=S.hosts}R.connect(S)};this.subscribe=function(S,T){if(typeof S!=="string")throw new Error("Invalid argument:"+S);T=T||{};m(T,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(T.timeout&&!T.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(typeof T.qos!=="undefined"&&!(T.qos===0||T.qos===1||T.qos===2))throw new Error(q(o.INVALID_ARGUMENT,[T.qos,"subscribeOptions.qos"]));R.subscribe(S,T)};this.unsubscribe=function(S,T){if(typeof S!=="string")throw new Error("Invalid argument:"+S);T=T||{};m(T,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(T.timeout&&!T.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");R.unsubscribe(S,T)};this.send=function(S,T,U,V){__p&&__p();var W;if(arguments.length===0)throw new Error("Invalid argument.length");else if(arguments.length==1){if(!(S instanceof G)&&typeof S!=="string")throw new Error("Invalid argument:"+typeof S);W=S;if(typeof W.destinationName==="undefined")throw new Error(q(o.INVALID_ARGUMENT,[W.destinationName,"Message.destinationName"]));R.send(W)}else{W=new G(T);W.destinationName=S;if(arguments.length>=3)W.qos=U;if(arguments.length>=4)W.retained=V;R.send(W)}};this.publish=function(S,T,U,V){__p&&__p();var W;if(arguments.length===0)throw new Error("Invalid argument.length");else if(arguments.length==1){if(!(S instanceof G)&&typeof S!=="string")throw new Error("Invalid argument:"+typeof S);W=S;if(typeof W.destinationName==="undefined")throw new Error(q(o.INVALID_ARGUMENT,[W.destinationName,"Message.destinationName"]));R.send(W)}else{W=new G(T);W.destinationName=S;if(arguments.length>=3)W.qos=U;if(arguments.length>=4)W.retained=V;R.send(W)}};this.disconnect=function(){R.disconnect()};this.getTraceLog=function(){return R.getTraceLog()};this.startTrace=function(){R.startTrace()};this.stopTrace=function(){R.stopTrace()};this.isConnected=function(){return R.connected}};Object.defineProperties(F.prototype,{host:{get:function H(){return this._getHost()},set:function H(I){this._setHost(I)}},port:{get:function H(){return this._getPort()},set:function H(I){this._setPort(I)}},path:{get:function H(){return this._getPath()},set:function H(I){this._setPath(I)}},clientId:{get:function H(){return this._getClientId()},set:function H(I){this._setClientId(I)}},onConnected:{get:function H(){return this._getOnConnected()},set:function H(I){this._setOnConnected(I)}},disconnectedPublishing:{get:function H(){return this._getDisconnectedPublishing()},set:function H(I){this._setDisconnectedPublishing(I)}},disconnectedBufferSize:{get:function H(){return this._getDisconnectedBufferSize()},set:function H(I){this._setDisconnectedBufferSize(I)}},onConnectionLost:{get:function H(){return this._getOnConnectionLost()},set:function H(I){this._setOnConnectionLost(I)}},connectOptions:{get:function H(){return this._getConnectOptions()}},onMessageDelivered:{get:function H(){return this._getOnMessageDelivered()},set:function H(I){this._setOnMessageDelivered(I)}},onMessageArrived:{get:function H(){return this._getOnMessageArrived()},set:function H(I){this._setOnMessageArrived(I)}},trace:{get:function H(){return this._getTrace()},set:function H(I){this._setTrace(I)}}});var G=function G(H){__p&&__p();var I;if(typeof H==="string"||H instanceof ArrayBuffer||H instanceof Int8Array||H instanceof Uint8Array||H instanceof Int16Array||H instanceof Uint16Array||H instanceof Int32Array||H instanceof Uint32Array||H instanceof Float32Array||H instanceof Float64Array)I=H;else throw q(o.INVALID_ARGUMENT,[H,"newPayload"]);this._getPayloadString=function(){if(typeof I==="string")return I;else return B(I,0,I.length)};this._getPayloadBytes=function(){if(typeof I==="string"){var N=new ArrayBuffer(z(I)),O=new Uint8Array(N);A(I,O,0);return O}else return I};var J;this._getDestinationName=function(){return J};this._setDestinationName=function(N){if(typeof N==="string")J=N;else throw new Error(q(o.INVALID_ARGUMENT,[N,"newDestinationName"]))};var K=0;this._getQos=function(){return K};this._setQos=function(N){if(N===0||N===1||N===2)K=N;else throw new Error("Invalid argument:"+N)};var L=false;this._getRetained=function(){return L};this._setRetained=function(N){if(typeof N==="boolean")L=N;else throw new Error(q(o.INVALID_ARGUMENT,[N,"newRetained"]))};var M=false;this._getDuplicate=function(){return M};this._setDuplicate=function(N){M=N}};Object.defineProperties(G.prototype,{payloadString:{get:function H(){return this._getPayloadString()}},payloadBytes:{get:function H(){return this._getPayloadBytes()}},destinationName:{get:function H(){return this._getDestinationName()},set:function H(I){this._setDestinationName(I)}},topic:{get:function H(){return this._getDestinationName()},set:function H(I){this._setDestinationName(I)}},qos:{get:function H(){return this._getQos()},set:function H(I){this._setQos(I)}},retained:{get:function H(){return this._getRetained()},set:function H(I){this._setRetained(I)}},duplicate:{get:function H(){return this._getDuplicate()},set:function H(I){this._setDuplicate(I)}}});return{Client:F,Message:G}}(window);return i})}),null);
__d("MqttConnection",["MqttLogger","Random","paho-mqtt"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=30,i="publish",j="subscribe",k="unsubscribe",l=function l(n){};function m(){this.$MqttConnection6=false;this.$MqttConnection9=c("MqttLogger").getInstance();this.$MqttConnection10="Disconnected"}m.prototype.run=function(n){__p&&__p();var o=n.onStateChange,p=n.onError,q=n.onMessageReceived,r=n.endpoint,s=n.deviceId,t=n.userFbid,u=n.appId;if(this.$MqttConnection6){this.$MqttConnection9.logError("run","Run called while in running state.");return}this.$MqttConnection1=o;this.$MqttConnection2=p;this.$MqttConnection3=q;this.$MqttConnection4=r;this.$MqttConnection8=s;this.$MqttConnection11=t;this.$MqttConnection14=u;this.$MqttConnection6=true;this.$MqttConnection12=0;this.$MqttConnection15()};m.prototype.shutdown=function(){this.$MqttConnection16();this.$MqttConnection6=false;this.$MqttConnection17("shutdown","Shutdown")};m.prototype.subscribe=function(n){__p&&__p();if(!this.$MqttConnection18(j))return false;for(var o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;this.$MqttConnection5.subscribe(s,{})}this.$MqttConnection17("subscribe","Subscribing to "+n.join(", "));return true};m.prototype.unsubscribe=function(n){__p&&__p();if(!this.$MqttConnection18(k))return false;for(var o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;this.$MqttConnection5.unsubscribe(s,{})}this.$MqttConnection17("unsubscribe","Unsubscribing to "+n.join(", "));return true};m.prototype.publish=function(n,o,p){var q=this.$MqttConnection18(i);if(q)this.$MqttConnection5.publish(n,o,p,false);this.$MqttConnection9.logPublish({topic:n,qos:p,conn_state:q?1:0,status:""+(q?"succes_connected":"failed_notconnected")});return q};m.prototype.$MqttConnection16=function(){__p&&__p();if(this.$MqttConnection6&&this.$MqttConnection5){this.$MqttConnection19("Disconnected");this.$MqttConnection5.onMessageArrived=l;this.$MqttConnection5.onConnectionLost=l;this.$MqttConnection5.connectOptions.onSuccess=l;this.$MqttConnection5.connectOptions.onFailure=l;if(this.$MqttConnection5.isConnected())this.$MqttConnection5.disconnect();this.$MqttConnection5=null}};m.prototype.$MqttConnection19=function(n){if(n!==this.$MqttConnection10){this.$MqttConnection10=n;this.$MqttConnection1(n)}};m.prototype.$MqttConnection15=function(){__p&&__p();if(!this.$MqttConnection6)return;this.$MqttConnection19("Connecting");this.$MqttConnection5=new(c("paho-mqtt").Client)(this.$MqttConnection4,"mqttwsclient");this.$MqttConnection7=this.$MqttConnection20();var n=Date.now();this.$MqttConnection5.onConnectionLost=function(o){if(o.errorCode)this.$MqttConnection9.logDisconnect({session:this.$MqttConnection7,errno:o.errorCode,err_str:o.errorMessage,session_duration:Date.now()-this.$MqttConnection13});this.$MqttConnection21()}.bind(this);this.$MqttConnection5.onMessageArrived=function(o){this.$MqttConnection17("onMessageArrived","Message received on "+o.destinationName);this.$MqttConnection9.bumpCounter("message_arrived."+o.destinationName);this.$MqttConnection3(o.destinationName,o.payloadBytes)}.bind(this);this.$MqttConnection5.connect({userName:JSON.stringify({u:this.$MqttConnection11,s:this.$MqttConnection7,cp:1,ecp:0,chat_on:true,fg:1,d:this.$MqttConnection22(),ct:"websocket",mqtt_sid:"",aid:this.$MqttConnection14,st:"",dc:""}),mqttVersion:3,password:"",keepAliveInterval:h,onFailure:function(o){this.$MqttConnection17("connect","Connect failed "+o.errorMessage);this.$MqttConnection23("failed",Date.now()-n,o.errorCode,o.errorMessage);this.$MqttConnection21()}.bind(this),onSuccess:function(){this.$MqttConnection17("connect","Connect success");this.$MqttConnection23("success",Date.now()-n);this.$MqttConnection19("Connected");this.$MqttConnection12=0;this.$MqttConnection13=Date.now()}.bind(this),ignoreSubProtocol:true})};m.prototype.$MqttConnection21=function(){if(!this.$MqttConnection6)return;this.$MqttConnection16();this.$MqttConnection7=-1;var n=Math.pow(2,Math.min(this.$MqttConnection12,9))*(1e3+Math.random()*200);this.$MqttConnection17("_scheduleReconnect","Reconnect in "+n+" ms");setTimeout(function(){return this.$MqttConnection15()}.bind(this),n);this.$MqttConnection12+=1};m.prototype.$MqttConnection20=function(){return Math.floor((1+c("Random").random())*Number.MAX_SAFE_INTEGER)};m.prototype.$MqttConnection22=function(){return this.$MqttConnection8};m.prototype.$MqttConnection18=function(n){__p&&__p();if(!this.$MqttConnection6){this.$MqttConnection17("_ensureConnected","Mqtt connection: "+n+" called when not running");return false}if(this.$MqttConnection5==null){this.$MqttConnection17("_ensureConnected","Mqtt connection: "+n+" called when not connected, ignored");return false}if(this.$MqttConnection10!=="Connected"){this.$MqttConnection17("_ensureConnected","Mqtt connection: "+n+" called with connection state "+this.$MqttConnection10);return false}var o=this.$MqttConnection5.isConnected();if(!o){this.$MqttConnection17("_ensureConnected","Mqtt connection: "+n+" called with client connection state "+o);return false}return true};m.prototype.$MqttConnection17=function(event,n){this.$MqttConnection9.debugTrace(event,"MQTT connection "+this.$MqttConnection7+": "+JSON.stringify(n))};m.prototype.$MqttConnection23=function(n,o,p,q){__p&&__p();var r={};r.status=n;r.session=this.$MqttConnection7;r.duration=Date.now()-o;r.hostname=this.$MqttConnection4;r.attempt_number=this.$MqttConnection12;if(p)r.errno=p;if(q)r.err_str=q;this.$MqttConnection9.logConnect(r)};f.exports=m}),null);
__d("MqttChannel",["MqttConnection","MqttLogger","uuid"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.$MqttChannel1="";this.$MqttChannel2=[];this.$MqttChannel3="Disconnected";this.$MqttChannel4=new Map();this.$MqttChannel7=c("MqttLogger").getInstance();this.$MqttChannel6=new(c("MqttConnection"))();this.$MqttChannel5=c("uuid")()}h.prototype.run=function(j){var k=j.endpoint,l=j.userFbid,m=j.appId;this.$MqttChannel7.setAppId(m);this.$MqttChannel1=k;this.$MqttChannel6.run({onStateChange:function(n){this.$MqttChannel8(n)}.bind(this),onError:function(n){this.$MqttChannel9("connection","Error "+n)}.bind(this),onMessageReceived:function(n,o){this.$MqttChannel10(n,o)}.bind(this),deviceId:this.$MqttChannel5,endpoint:k,userFbid:l,appId:m})};h.prototype.shutdown=function(){if(this.$MqttChannel6)this.$MqttChannel6.shutdown()};h.prototype.publish=function(j,k){this.$MqttChannel6.publish(j,k,1)};h.prototype.subscribe=function(j,k){if(!this.$MqttChannel4.has(j)){this.$MqttChannel6.subscribe([j]);var l=[k];this.$MqttChannel4.set(j,l)}else{var m=this.$MqttChannel4.get(j);if(m)m.push(k)}};h.prototype.subscribeChannelEvents=function(j){this.$MqttChannel2.push(j)};h.prototype.getDeviceId=function(){return this.$MqttChannel5};h.prototype.getConnectionSate=function(){return this.$MqttChannel3};h.prototype.$MqttChannel10=function(j,k){__p&&__p();var l=this.$MqttChannel4.get(j);if(!l)this.$MqttChannel9("_onMessageReceived",j+" being dropped, no listeners");else for(var m=l,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p;q(k)}};h.prototype.$MqttChannel8=function(j){if(this.$MqttChannel3!=="Connected"&&j==="Connected")this.$MqttChannel6.subscribe(Array.from(this.$MqttChannel4.keys()));this.$MqttChannel3=j;this.$MqttChannel11("_changeState","Connection state = "+j);this.$MqttChannel12(j)};h.prototype.$MqttChannel12=function(j){__p&&__p();for(var k=this.$MqttChannel2,l=Array.isArray(k),m=0,k=l?k:k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var n;if(l){if(m>=k.length)break;n=k[m++]}else{m=k.next();if(m.done)break;n=m.value}var o=n;o.onMQTTStateChanged(j)}};h.prototype.$MqttChannel9=function(event,j){this.$MqttChannel7.logError(event,j)};h.prototype.$MqttChannel11=function(event,j){this.$MqttChannel7.debugTrace(event,"Mqtt channel: "+j)};var i=new h();f.exports=i}),null);
__d("MessageEventStream",["invariant","Int64","MercurySingletonProvider","MqttChannel","MqttLogger","MqttWsClientTypedLogger"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();i.getForFBID=function(k){return j.getForFBID(k)};i.setup=function(k){var l=k.fbid,m=k.msgSequenceId,n=k.fbidThreadFilter,o=k.queuePosition;!!l||h(0);var p=i.getForFBID(l);p.init(m,n,o)};function i(k){this.$MessageEventStream2="Disconnected";this.$MessageEventStream1=k;this.$MessageEventStream3=[];this.$MessageEventStream6=c("MqttLogger").getInstance()}i.prototype.init=function(k,l,m){__p&&__p();if(!k&&!m)return this;this.$MessageEventStream4=k?c("Int64").fromString(k.toString()):null;this.$MessageEventStream2=c("MqttChannel").getConnectionSate();c("MqttChannel").subscribe("/t_ms",function(n){return this.$MessageEventStream7(n)}.bind(this));c("MqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(n){if(this.$MessageEventStream2!=="Connected"&&n==="Connected")if(this.$MessageEventStream5)this.$MessageEventStream8();else this.$MessageEventStream9(l,m);this.$MessageEventStream2=n}.bind(this)});if(c("MqttChannel").getConnectionSate()==="Connected")this.$MessageEventStream9(l,m);c("MqttChannel").subscribe("/notify_disconnect",function(n){var o="notify_disconnect";try{o=String.fromCharCode.apply(null,n)}catch(p){this.$MessageEventStream6.logError("notify_disconnect",p)}if(o==="IRIS_CURSOR_LIMIT")this.$MessageEventStream5=null;this.$MessageEventStream6.bumpCounter("notify_disconnect_request");this.$MessageEventStream3.forEach(function(q){return q.onStreamDisconnect(o)})}.bind(this));return this};i.prototype.addDeltaStreamListener=function(k){this.$MessageEventStream3.push(k)};i.prototype.$MessageEventStream7=function(k){__p&&__p();var l=void 0;try{l=JSON.parse(decodeURIComponent(escape(String.fromCharCode.apply(null,k))))}catch(m){this.$MessageEventStream6.logError("process_deltas",m);return}var n=this.$MessageEventStream1,o=this.$MessageEventStream4;if(l.syncToken){if(!this.$MessageEventStream5)this.$MessageEventStream5=l.syncToken;if(!this.$MessageEventStream4)this.$MessageEventStream4=c("Int64").fromString(l.firstDeltaSeqId.toString());return}else if(l.queueEntityId!=n){this.$MessageEventStream6.bumpCounter("delta_for_other_fbid");return}else{var p=l.deltas,q={seq_id:o&&o.toString(),first_seq_id:"",last_seq_id:"",deltas_in_batch:[]};if(p&&o){var r=l.firstDeltaSeqId.toString(),s=l.lastIssuedSeqId.toString(),t=c("Int64").fromString(r),u=c("Int64").fromString(s);q.first_seq_id=r;q.last_seq_id=s;if(t.equals(o.add(c("Int64").ONE)))this.$MessageEventStream10(t,u,p,q);else if(t.compare(o)<0){this.$MessageEventStream6.bumpCounter("delta_batch_in_middle");if(u.compare(o)>0)this.$MessageEventStream10(o.add(c("Int64").ONE),u,p,q)}else{this.$MessageEventStream6.bumpCounter("missing_deltas_get_diffs");this.$MessageEventStream8()}}else this.$MessageEventStream6.bumpCounter("process_deltas_invalid_state");this.$MessageEventStream11(q)}};i.prototype.$MessageEventStream10=function(k,l,m,n){__p&&__p();var o=k;for(var p=0;p<m.length;p++){var q=m[p],r=q["class"]||"Missing",s={seqId:o.toString(),type:r,status:""},t=1;if(r!="Missing")try{t=this.$MessageEventStream12(q,r,o,s)}catch(u){s.status="err:"+u.message}else{s.status="no type";this.$MessageEventStream6.bumpCounter("missing_delta_type")}o=o.add(c("Int64").fromInt(t));n.deltas_in_batch.push(s)}this.$MessageEventStream4=l};i.prototype.$MessageEventStream12=function(k,l,m,n){__p&&__p();var o=1,p="";if(l==="NoOp"){o=k.numNoOps||o;p+="n:"+o}if(!k.irisSeqId){k.irisSeqId=m.toString();p+="missing seq id"}var q=c("Int64").fromString(k.irisSeqId.toString())||m;if(q.equals(m))p+=" seqId match";else{p+=" seqId mismatch";this.$MessageEventStream6.bumpCounter("seq_id_running_id_mismatch")}var r={type:l,payload:k};this.$MessageEventStream3.forEach(function(s){return s.onDeltaReceived(r)});n.status=p;return o};i.prototype.$MessageEventStream9=function(k,l){var m=void 0;if(k)m={thread_filter:[{other_user_fbid:k}]};var n={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$MessageEventStream1,initial_titan_sequence_id:this.$MessageEventStream4&&this.$MessageEventStream4.toString(),deviceParams:m,queue_position:l};c("MqttChannel").publish("/messenger_sync_create_queue",JSON.stringify(n))};i.prototype.$MessageEventStream8=function(){__p&&__p();if(!this.$MessageEventStream4){this.$MessageEventStream6.bumpCounter("get_diffs_no_seq_id");return}if(!this.$MessageEventStream5){this.$MessageEventStream6.bumpCounter("get_diffs_no_sync_token");return}var k={sync_token:this.$MessageEventStream5,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$MessageEventStream1,last_seq_id:this.$MessageEventStream4.toString()};c("MqttChannel").publish("/messenger_sync_get_diffs",JSON.stringify(k))};i.prototype.$MessageEventStream11=function(k){new(c("MqttWsClientTypedLogger"))().setSeqID(k.seq_id).setFirstSeqID(k.first_seq_id).setLastSeqID(k.last_seq_id).setDeltasInBatch(JSON.stringify(k.deltas_in_batch)).log()};var j=new(c("MercurySingletonProvider"))(i);f.exports=i}),null);
__d("MqttRunner",["MqttChannel"],(function a(b,c,d,e,f,g){"use strict";var h={init:function i(j){var k=j.endpoint,l=j.userFbid,m=j.appId;c("MqttChannel").run({endpoint:k,userFbid:l,appId:m})}};f.exports=h}),null);
__d("LiveChatMqttClient",["Arbiter","ChannelConstants","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MercurySingletonProvider","MessageEventStream","MessengerLiveChatPluginEvent","MessengerLiveChatPluginGateway","MessengerLiveChatPluginTypedLogger","MqttChannel","MqttRunner","gkx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="Connected",i=225396507985893,j="n",k="wss://edge-chat.facebook.com/chat/";function l(n){this.$LiveChatMqttClient1=n}l.getForFBID=function(n){return m.getForFBID(n)};l.setUp=function(n,o,p,q,r){c("MqttRunner").init({endpoint:k,userFbid:o,appId:i});var s=l.getForFBID(o);s.init(n,o,p,q,r)};l.prototype.init=function(n,o,p,q,r){__p&&__p();this.$LiveChatMqttClient2=n;this.$LiveChatMqttClient3=p;if(!q)c("MessageEventStream").getForFBID(o).init(null,n,j).addDeltaStreamListener(this);else c("MessageEventStream").getForFBID(o).init(q,n).addDeltaStreamListener(this);new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$LiveChatMqttClient1).setPageID(this.$LiveChatMqttClient2).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setEvent(c("MessengerLiveChatPluginEvent").MQTT_CONNECTION_INITIATED).setEventTimestamp(Date.now()).log();c("MqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(s){if(s===h)r&&r();new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$LiveChatMqttClient1).setPageID(this.$LiveChatMqttClient2).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setEvent(c("MessengerLiveChatPluginEvent").MQTT_CONNECTION_STATE_CHANGED).setDebugData(s).setEventTimestamp(Date.now()).log()}.bind(this)})};l.prototype.onDeltaReceived=function(n){var o=n.type,p=n.payload;try{var q=o.replace(/^delta/,"unknown"),r=Number(p.irisSeqId),s={delta:babelHelpers["extends"]({},p,{"class":q}),iseq:r,type:"delta"},t=this.$LiveChatMqttClient3||c("gkx")("AT7JCav-mnZaXvxvDZIStsaHGOzW3wm3IcqOSc7xoesh9oMNPR0bSOyfLxBj6PCvVKOi8MrYYxdqv_TpZOkUtcGctqpnKAug6HnuZMaG4wXC1Q");if(t){var u=c("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":c("ChannelConstants").getArbiterType("delta");c("Arbiter").inform(u,{obj:s})}c("LiveChatPluginLoggerUtil").logDelta(this.$LiveChatMqttClient1,this.$LiveChatMqttClient2,q,c("MessengerLiveChatPluginGateway").MQTT,!t,r)}catch(v){new(c("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$LiveChatMqttClient1).setPageID(this.$LiveChatMqttClient2).setRequestID(c("LiveChatPluginSessionUtil").getRequestID()).setEvent(c("MessengerLiveChatPluginEvent").DELTA_PARSING_ERROR).setEventTimestamp(Date.now()).logVital()}};l.prototype.onStreamDisconnect=function(n){};var m=new(c("MercurySingletonProvider"))(l);f.exports=l}),null);
__d("LiveChatPluginCloseButtonSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").PureComponent);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement("svg",{width:"10px",height:"10px",viewBox:"0 0 14 14"},c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c("React").createElement("g",{transform:"translate(-419.000000, -413.000000)"},c("React").createElement("g",{transform:"translate(164.000000, 396.000000)"},c("React").createElement("g",null,c("React").createElement("g",{transform:"translate(250.000000, 12.000000)"},c("React").createElement("g",null,c("React").createElement("g",null,c("React").createElement("rect",{opacity:"0.200000003",x:"0",y:"0",width:"24",height:"24"}),c("React").createElement("g",{transform:"translate(4.000000, 4.000000)",fill:"#000000"},c("React").createElement("rect",{transform:"translate(8.000000, 8.000000) rotate(45.000000) translate(-8.000000, -8.000000) ",x:"7",y:"-1",width:"2",height:"18",rx:"1"}),c("React").createElement("rect",{transform:"translate(8.000000, 8.000000) rotate(135.000000) translate(-8.000000, -8.000000) ",x:"7",y:"-1",width:"2",height:"18",rx:"1"}))))))))))};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("PrivacyTransparentOverlay.react",["cx","React"],(function a(b,c,d,e,f,g,h){"use strict";var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;k.prototype.render=function(){return c("React").createElement("div",{className:"_4cqr"},this.props.children,c("React").createElement("div",{className:"clearfix"}))};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("LiveChatPluginAnonymousUserPrompt.react",["cx","fbt","Image.react","Link.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerTextWithEntities.react","PluginOptin","PrivacyTransparentOverlay.react","React","ReactDOM","ShimButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=124;j=babelHelpers.inherits(m,c("React").PureComponent);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$LiveChatPluginAnonymousUserPrompt1=function(){this.$LiveChatPluginAnonymousUserPrompt3();c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").LOG_IN_TO_MESSENGER_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$LiveChatPluginAnonymousUserPrompt2=function(){this.$LiveChatPluginAnonymousUserPrompt3();c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").CHAT_NOW_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),o}m.prototype.componentDidMount=function(){var n=c("ReactDOM").findDOMNode(this),o=n&&n.offsetHeight>l?n.offsetHeight:l;this.props.anchorIframeResizeFn(o);c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").ANONYMOUS_CHAT_NOW_PROMPT_RENDERED,this.props.viewerID,this.props.pageID)};m.prototype.componentDidUpdate=function(){var n=c("ReactDOM").findDOMNode(this),o=n&&n.offsetHeight>l?n.offsetHeight:l;this.props.anchorIframeResizeFn(o)};m.prototype.render=function(){return c("React").createElement("div",{className:"_j68"},c("React").createElement("div",{className:"promptHeaderContainer"},c("React").createElement("div",{className:"promptTextContainer"},c("React").createElement("div",{className:"promptHeader"},this.props.loggedOutGreeting?c("React").createElement(c("MessengerTextWithEntities.react"),{renderEmoji:true,renderEmoticons:true,text:this.props.loggedOutGreeting}):i._("Xin ch\u00e0o! Ch\u00fang t\u00f4i lu\u00f4n s\u1eb5n s\u00e0ng tr\u1ea3 l\u1eddi m\u1ecdi c\u00e2u h\u1ecfi c\u1ee7a b\u1ea1n.")),c("React").createElement("div",{className:"promptSubheader"},c("React").createElement(c("Link.react"),{className:"notYouLink",onClick:this.$LiveChatPluginAnonymousUserPrompt1},i._("H\u00e3y \u0111\u0103ng nh\u1eadp Messenger \u0111\u1ec3 tr\u00f2 chuy\u1ec7n.")))),c("React").createElement(c("PrivacyTransparentOverlay.react"),null,c("React").createElement(c("Image.react"),{className:"profilePicture",src:this.props.pageProfilePictureUri})),c("React").createElement("div",{className:"closeButtonContainer"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.props.onCloseButtonClick},c("React").createElement(c("LiveChatPluginCloseButtonSVG.react"),null)))),c("React").createElement("div",{className:"promptButtonContainer"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf promptButton",onClick:this.$LiveChatPluginAnonymousUserPrompt2,style:{color:this.props.threadColor}},i._("Tr\u00f2 chuy\u1ec7n"))))};m.prototype.$LiveChatPluginAnonymousUserPrompt3=function(){new(c("PluginOptin"))("customer_chat").addLoginParams({logged_in:false,page_id:this.props.pageID,switch_user:false}).addReturnParams({referer_uri:this.props.refererUri}).start()};f.exports=m}),null);
__d("LiveChatPluginInformationButtonSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c("React").createElement("g",{transform:"translate(-413.000000, -56.000000)"},c("React").createElement("g",{transform:"translate(90.000000, 44.000000)"},c("React").createElement("g",null,c("React").createElement("g",null,c("React").createElement("g",{transform:"translate(324.000000, 13.000000)"},c("React").createElement("circle",{fill:this.props.informationViewOpen?this.props.threadColor:"#FFFFFF",stroke:this.props.threadColor,cx:"11",cy:"11",r:"11"}),c("React").createElement("path",{d:"M11,9 L12,9 L12,17 L13,17 L13,17.5 L9,17.5 L9,17 L10,17 L10,9.5 L9,9.5 L9,9 L11,9 Z M11,4.5 C11.8284271,4.5 12.5,5.17157288 12.5,6 C12.5,6.82842712 11.8284271,7.5 11,7.5 C10.1715729,7.5 9.5,6.82842712 9.5,6 C9.5,5.17157288 10.1715729,4.5 11,4.5 Z",fill:this.props.informationViewOpen?"#FFFFFF":this.props.threadColor}))))))))};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("LiveChatPluginDialogHeader.react",["cx","LineClamp.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginInformationButtonSVG.react","React","ShimButton.react"],(function a(b,c,d,e,f,g,h){"use strict";var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;k.prototype.render=function(){return c("React").createElement("div",{className:"_f_0"},c("React").createElement("div",{className:"_1qd1"},c("React").createElement(c("ShimButton.react"),{className:"_2t-5 _4bqf",onClick:this.props.onCloseButtonClick},c("React").createElement(c("LiveChatPluginCloseButtonSVG.react"),null))),c("React").createElement("div",{className:"_hov"},c("React").createElement(c("LineClamp.react"),{className:"_how",lines:1},this.props.pageName),c("React").createElement(c("LineClamp.react"),{className:"_hox",lines:1},this.props.pageResponsivenessText)),c("React").createElement("div",{className:"_1qd3"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf _17l7",onClick:this.props.onInformationButtonClick},c("React").createElement(c("LiveChatPluginInformationButtonSVG.react"),{informationViewOpen:this.props.informationViewOpen,threadColor:this.props.threadColor}))))};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("LiveChatPluginLoggedInUserPrompt.react",["cx","fbt","Arbiter","AsyncRequest","CurrentUser","Image.react","Link.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MessengerLiveChatPluginEvent","MessengerTextWithEntities.react","Plugin","PluginOptin","PrivacyTransparentOverlay.react","React","ReactDOM","ShimButton.react","XMNLiveChatConnectController"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=124;j=babelHelpers.inherits(m,c("React").PureComponent);k=j&&j.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.$LiveChatPluginLoggedInUserPrompt2=function(){new(c("PluginOptin"))("customer_chat").addLoginParams({logged_in:false,page_id:this.props.pageID,switch_user:true}).addReturnParams({referer_uri:this.props.refererUri}).start();c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").NOT_YOU_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$LiveChatPluginLoggedInUserPrompt3=function(){__p&&__p();if(!c("CurrentUser").isLoggedInNow())return;if(this.props.hasMessagingPermission)this.props.onChatNowClick();else if(this.props.canSkipContinuousAs){var s=c("XMNLiveChatConnectController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$LiveChatPluginLoggedInUserPrompt1=new(c("AsyncRequest"))().setURI(s).setMethod("POST").setAllowCrossPageTransition(true).setHandler(this.props.onChatNowClick);this.$LiveChatPluginLoggedInUserPrompt1.send()}else{new(c("PluginOptin"))("customer_chat").addLoginParams({logged_in:true,page_id:this.props.pageID,request_id:c("LiveChatPluginSessionUtil").getRequestID(),switch_user:false}).start();c("Arbiter").subscribe(c("Plugin").CONNECT,this.props.onChatNowClick)}c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").CHAT_NOW_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),o}m.prototype.componentDidMount=function(){var n=c("ReactDOM").findDOMNode(this),o=n&&n.offsetHeight>l?n.offsetHeight:l;this.props.anchorIframeResizeFn(o);c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").LOGGED_IN_CHAT_NOW_PROMPT_RENDERED,this.props.viewerID,this.props.pageID,JSON.stringify({hasMessagingPermission:this.props.hasMessagingPermission}))};m.prototype.componentDidUpdate=function(){var n=c("ReactDOM").findDOMNode(this),o=n&&n.offsetHeight>l?n.offsetHeight:l;this.props.anchorIframeResizeFn(o)};m.prototype.componentWillUnmount=function(){this.$LiveChatPluginLoggedInUserPrompt1&&this.$LiveChatPluginLoggedInUserPrompt1.abandon()};m.prototype.render=function(){return c("React").createElement("div",{className:"_j68"},c("React").createElement("div",{className:"promptHeaderContainer"},c("React").createElement("div",{className:"promptTextContainer"},c("React").createElement("div",{className:"promptHeader"},this.props.loggedInGreeting?c("React").createElement(c("MessengerTextWithEntities.react"),{renderEmoji:true,renderEmoticons:true,text:this.props.loggedInGreeting}):i._("Xin ch\u00e0o! Ch\u00fang t\u00f4i c\u00f3 th\u1ec3 gi\u00fap g\u00ec cho b\u1ea1n?")),c("React").createElement("div",{className:"promptSubheader"},c("React").createElement("div",{className:"profilePictureContainer"},c("React").createElement(c("PrivacyTransparentOverlay.react"),null,c("React").createElement(c("Image.react"),{className:"profilePicture",src:"https://graph.facebook.com/"+this.props.viewerID+"/picture??type=large"}))),c("React").createElement("div",{className:"username"},c("CurrentUser").getName()),c("React").createElement(c("Link.react"),{className:"notYouLink",onClick:this.$LiveChatPluginLoggedInUserPrompt2},i._("Kh\u00f4ng ph\u1ea3i b\u1ea1n?")))),c("React").createElement(c("PrivacyTransparentOverlay.react"),null,c("React").createElement(c("Image.react"),{className:"profilePicture",src:this.props.pageProfilePictureUri})),c("React").createElement("div",{className:"closeButtonContainer"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.props.onCloseButtonClick},c("React").createElement(c("LiveChatPluginCloseButtonSVG.react"),null)))),c("React").createElement("div",{className:"promptButtonContainer"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf promptButton",onClick:this.$LiveChatPluginLoggedInUserPrompt3,style:{color:this.props.threadColor}},i._("Tr\u00f2 chuy\u1ec7n ngay"))))};f.exports=m}),null);
__d("LiveChatPluginBotMenuButtonSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c("React").createElement("g",{fill:this.props.threadColor},c("React").createElement("rect",{x:"2",y:"3",width:"20",height:"1"}),c("React").createElement("rect",{x:"2",y:"11",width:"20",height:"1"}),c("React").createElement("rect",{x:"2",y:"19",width:"20",height:"1"}))))};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("LiveChatPluginArrowButtonSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){var k=this.props.direction==="left"?c("React").createElement("g",{fill:this.props.threadColor},c("React").createElement("polygon",{points:"5.5 12 16 1.5 18 3.5 9.5 12 18 20.5 16 22.5"})):c("React").createElement("g",{fill:this.props.threadColor},c("React").createElement("polygon",{points:"8 7 9.5 5.5 16 12 9.5 18.5 8 17 13 12"}));return c("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},k))};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("XMNCommercePostbackCTAController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messages/commerce/postback/",{cta_id:{type:"String",required:true},message_id:{type:"String"},ref:{type:"String"},ref_source:{type:"Enum",enumType:1},ref_type:{type:"Enum",enumType:1}})}),null);
__d("LiveChatPluginBotMenuDialog.react",["cx","fbt","AsyncRequest","Link.react","LiveChatPluginArrowButtonSVG.react","LiveChatPluginLoggerUtil","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercurySourceType","MessengerLiveChatPluginEvent","MNCommerceCallToActionType","React","ShimButton.react","Tooltip.react","XMNCommercePostbackCTAController"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(m){k.constructor.call(this,m);this.state={navigationPath:[]};this.$LiveChatPluginBotMenuDialog11=function(){this.props.closeDialogFn();c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").BOT_MENU_URL_REDIRECT_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this);this.$LiveChatPluginBotMenuDialog1=c("MercuryMessageActions").getForFBID(this.props.viewerID);this.$LiveChatPluginBotMenuDialog2=new(c("MercuryMessageObject"))(this.props.viewerID);this.$LiveChatPluginBotMenuDialog3=c("LiveChatPluginLoggerUtil").getAttributionTags();this.$LiveChatPluginBotMenuDialog4=c("MercuryIDs").getThreadIDFromUserID(this.props.pageID)}l.prototype.render=function(){var m=i._("Menu"),n=[],o=this.props.menuItems;for(var p=0;p<this.state.navigationPath.length;p++){var q=this.state.navigationPath[p];m=o[q].title;o=o[q].nested_ctas}n=o.map(function(r,q){return this.$LiveChatPluginBotMenuDialog5(r,q)}.bind(this));return c("React").createElement("div",{className:"_3qta"},this.$LiveChatPluginBotMenuDialog6(m),n)};l.prototype.$LiveChatPluginBotMenuDialog6=function(m){var n=this.state.navigationPath.length!==0?c("React").createElement(c("Link.react"),{className:"_4bqf _3qtb",onClick:function(o){this.setState(function(p){return{navigationPath:p.navigationPath.slice(0,-1)}})}.bind(this)},c("React").createElement(c("LiveChatPluginArrowButtonSVG.react"),{direction:"left",threadColor:this.props.threadColor})):null;return c("React").createElement("div",{className:"_3quo _3qup"},n,m)};l.prototype.$LiveChatPluginBotMenuDialog5=function(m,n){__p&&__p();var o=void 0;switch(m.action_type){case c("MNCommerceCallToActionType").POSTBACK:o=this.$LiveChatPluginBotMenuDialog7(m);break;case c("MNCommerceCallToActionType").OPEN_URL:o=this.$LiveChatPluginBotMenuDialog8(m);break;case c("MNCommerceCallToActionType").NAVIGATION:o=this.$LiveChatPluginBotMenuDialog9(m,n);break;default:o=this.$LiveChatPluginBotMenuDialog10(m);break}return c("React").createElement("div",{className:"_3quq",key:m.id},c("React").createElement("div",{className:"_3qup _4bqf"},o))};l.prototype.$LiveChatPluginBotMenuDialog10=function(m){return c("React").createElement(c("Tooltip.react"),{className:"_3qut",tooltip:i._("\u0110\u1ec3 s\u1eed d\u1ee5ng t\u00ednh n\u0103ng n\u00e0y, h\u00e3y d\u00f9ng \u1ee9ng d\u1ee5ng Messenger.")},m.title)};l.prototype.$LiveChatPluginBotMenuDialog8=function(m){return c("React").createElement(c("Link.react"),{className:"_3qux",href:m.action_link,onClick:this.$LiveChatPluginBotMenuDialog11,style:{color:this.props.threadColor},target:"_blank"},m.title)};l.prototype.$LiveChatPluginBotMenuDialog9=function(m,n){var o=function(p){this.setState(function(q){return{navigationPath:q.navigationPath.concat(n)}})}.bind(this);return c("React").createElement(c("ShimButton.react"),{className:"_3quz",onClick:o},c("React").createElement(c("Link.react"),{style:{color:this.props.threadColor}},m.title),c("React").createElement("div",{className:"_3qu-"},c("React").createElement(c("LiveChatPluginArrowButtonSVG.react"),{direction:"right",threadColor:this.props.threadColor})))};l.prototype.$LiveChatPluginBotMenuDialog7=function(m){var n=function(o){this.props.closeDialogFn();this.$LiveChatPluginBotMenuDialog1.send(this.$LiveChatPluginBotMenuDialog2.constructCTAConfirmationMessageObject(m.title,c("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$LiveChatPluginBotMenuDialog4,null,this.$LiveChatPluginBotMenuDialog3));var p=c("XMNCommercePostbackCTAController").getURIBuilder().setString("cta_id",m.id).getURI();new(c("AsyncRequest"))().setURI(p).setAllowCrossPageTransition(true).setMethod("POST").send();c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").BOT_MENU_POSTBACK_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this);return c("React").createElement(c("Link.react"),{className:"_3qux",onClick:n,style:{color:this.props.threadColor}},m.title)};f.exports=l}),null);
__d("XMessengerBotsMenuController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messenger/commerce/bots/menu/",{page_id:{type:"String",required:true}})}),null);
__d("LiveChatPluginBotMenuButton.react",["csx","cx","AsyncRequest","LiveChatPluginBotMenuButtonSVG.react","LiveChatPluginBotMenuDialog.react","LiveChatPluginLoggerUtil","MessengerContextualDialog.react","MessengerLiveChatPluginEvent","Parent","React","ReactDOM","ShimButton.react","Style","XMessengerBotsMenuController"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.state={flyoutOpen:false,menuItems:null},this.$LiveChatPluginBotMenuButton4=function(){this.setState(function(r){return{flyoutOpen:!r.flyoutOpen}},this.$LiveChatPluginBotMenuButton8)}.bind(this),this.$LiveChatPluginBotMenuButton7=function(){this.setState({flyoutOpen:false})}.bind(this),this.$LiveChatPluginBotMenuButton6=function(){if(this.state.flyoutOpen)this.$LiveChatPluginBotMenuButton3()}.bind(this),this.$LiveChatPluginBotMenuButton8=function(){c("LiveChatPluginLoggerUtil").logAction(this.state.flyoutOpen?c("MessengerLiveChatPluginEvent").BOT_MENU_OPENED:c("MessengerLiveChatPluginEvent").BOT_MENU_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),n}l.prototype.UNSAFE_componentWillMount=function(){this.$LiveChatPluginBotMenuButton2()};l.prototype.componentWillUnmount=function(){if(this.$LiveChatPluginBotMenuButton1){this.$LiveChatPluginBotMenuButton1.abort();this.$LiveChatPluginBotMenuButton1=null}if(this.state.flyoutOpen)this.$LiveChatPluginBotMenuButton3()};l.prototype.render=function(){return c("React").createElement(c("ShimButton.react"),{className:"_661n",onClick:this.$LiveChatPluginBotMenuButton4,ref:"botMenuContainer"},c("React").createElement(c("LiveChatPluginBotMenuButtonSVG.react"),{threadColor:this.props.threadColor}),this.$LiveChatPluginBotMenuButton5())};l.prototype.$LiveChatPluginBotMenuButton5=function(){if(!this.state.flyoutOpen||!this.state.menuItems)return null;return c("React").createElement(c("MessengerContextualDialog.react"),{alignment:"right",contextRef:function(){return this.refs.botMenuContainer}.bind(this),hideOnBlur:true,onBeforeHide:this.$LiveChatPluginBotMenuButton6,position:"above",ref:function(m){if(this.props.isMobile&&m){var n=c("Parent").bySelector(c("ReactDOM").findDOMNode(m),"._1r_9"),o=window.innerWidth<310?window.innerWidth-10:300;c("Style").set(n,"max-width",o+"px");c("Style").set(n,"-webkit-tap-highlight-color","transparent")}}.bind(this),shown:this.state.flyoutOpen,width:window.innerWidth<310?window.innerWidth-10:300},c("React").createElement(c("LiveChatPluginBotMenuDialog.react"),{closeDialogFn:this.$LiveChatPluginBotMenuButton7,menuItems:this.state.menuItems,pageID:this.props.pageID,threadColor:this.props.threadColor,viewerID:this.props.viewerID}))};l.prototype.$LiveChatPluginBotMenuButton2=function(){var m=c("XMessengerBotsMenuController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$LiveChatPluginBotMenuButton1=new(c("AsyncRequest"))().setURI(m).setHandler(function(n){this.setState({menuItems:n.payload.menu})}.bind(this)).setErrorHandler(function(n){this.setState({menuItems:[]})}.bind(this));this.$LiveChatPluginBotMenuButton1.send()};l.prototype.$LiveChatPluginBotMenuButton3=function(){this.setState({flyoutOpen:false},this.$LiveChatPluginBotMenuButton8)};f.exports=l}),null);
__d("LiveChatPluginSendButtonSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").PureComponent);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement("svg",{width:"22px",height:"22px",viewBox:"0 0 22 22"},c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c("React").createElement("g",{transform:"translate(-5.000000, -5.000000)",fill:this.props.threadColor},c("React").createElement("g",null,c("React").createElement("g",{transform:"translate(5.000000, 5.000000)"},c("React").createElement("path",{d:"M2.0300068,0.145970044 L20.9662955,9.37015518 C22.3445682,10.0420071 22.3445682,11.9582654 20.9662955,12.6296618 L2.0300068,21.853847 C1.09728834,22.3084288 0,21.6475087 0,20.6317597 L0.806953417,13.8945654 C0.882225434,13.2659853 1.39089595,12.7699536 2.03608467,12.6957083 L12.0229514,11.6795038 C12.8612292,11.5943266 12.8612292,10.4054904 12.0229514,10.3203132 L2.03608467,9.30410872 C1.39089595,9.23031889 0.882225434,8.7342872 0.806953417,8.10525162 L0,1.36805729 C0,0.352308292 1.09728834,-0.3081563 2.0300068,0.145970044"}))))))};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("LiveChatPluginMessageComposer.react",["cx","fbt","AbstractTextInput.react","Keys","LiveChatPluginBotMenuButton.react","LiveChatPluginLoggerUtil","LiveChatPluginSendButtonSVG.react","MessengerLiveChatPluginEvent","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercurySourceType","MessengerHotLikeOutlineSVG.react","React","ShimButton.react","StickerConstants"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").PureComponent);k=j&&j.prototype;function l(m){__p&&__p();k.constructor.call(this,m);this.state={inputValue:""};this.$LiveChatPluginMessageComposer11=function(n){this.setState({inputValue:n.target.value})}.bind(this);this.$LiveChatPluginMessageComposer12=function(n){if(n.keyCode===c("Keys").RETURN){n.preventDefault();this.$LiveChatPluginMessageComposer9()}}.bind(this);this.$LiveChatPluginMessageComposer9=function(){var n=this.state.inputValue.trim();if(n&&n.length>0){this.$LiveChatPluginMessageComposer2.send(this.$LiveChatPluginMessageComposer3.constructUserGeneratedMessageObject(n,c("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$LiveChatPluginMessageComposer4,null,null,this.$LiveChatPluginMessageComposer5));this.setState({inputValue:""});c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").MESSAGE_SENT,this.props.viewerID,this.props.pageID)}}.bind(this);this.$LiveChatPluginMessageComposer10=function(){this.$LiveChatPluginMessageComposer2.send(this.$LiveChatPluginMessageComposer3.constructStickerMessageObject(c("StickerConstants").HOT_LIKE_SMALL_STICKER_ID,c("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$LiveChatPluginMessageComposer4,this.$LiveChatPluginMessageComposer5));this.setState({inputValue:""});c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").LIKE_BUTTON_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this);this.$LiveChatPluginMessageComposer2=c("MercuryMessageActions").getForFBID(this.props.viewerID);this.$LiveChatPluginMessageComposer3=c("MercuryMessageObject").getForFBID(this.props.viewerID);this.$LiveChatPluginMessageComposer4=c("MercuryIDs").getThreadIDFromUserID(this.props.pageID);this.$LiveChatPluginMessageComposer5=c("LiveChatPluginLoggerUtil").getAttributionTags()}l.prototype.render=function(){return c("React").createElement("div",{className:"_336a"+(this.props.disableInput?" _664i":"")},c("React").createElement("div",{className:"_4zbw"},this.$LiveChatPluginMessageComposer6(),this.$LiveChatPluginMessageComposer7(),this.$LiveChatPluginMessageComposer8()))};l.prototype.$LiveChatPluginMessageComposer8=function(){if(this.props.disableInput)return null;if(this.state.inputValue.length>0)return c("React").createElement("div",{className:"_kmd"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf _64mk",onClick:this.$LiveChatPluginMessageComposer9},c("React").createElement("div",{className:"_64ml"},c("React").createElement(c("LiveChatPluginSendButtonSVG.react"),{threadColor:this.props.threadColor}))));else return c("React").createElement("div",{className:"_kmd"},c("React").createElement(c("ShimButton.react"),{className:"_4bqf _64mk",onClick:this.$LiveChatPluginMessageComposer10},c("React").createElement(c("MessengerHotLikeOutlineSVG.react"),{color:this.props.threadColor})))};l.prototype.$LiveChatPluginMessageComposer7=function(){if(this.props.disableInput)return c("React").createElement("div",{className:"_664k"},i._("Tr\u00ecnh bi\u00ean so\u1ea1n b\u1ecb t\u1eaft cho cu\u1ed9c tr\u00f2 chuy\u1ec7n n\u00e0y."));return c("React").createElement("div",{className:"_4fwe"},c("React").createElement(c("AbstractTextInput.react"),{onBlur:this.props.onBlur,onChange:this.$LiveChatPluginMessageComposer11,onFocus:this.props.onFocus,onKeyDown:this.$LiveChatPluginMessageComposer12,ref:function(m){this.$LiveChatPluginMessageComposer1=m}.bind(this),placeholder:i._("Nh\u1eadp tin nh\u1eafn...").toString(),value:this.state.inputValue}))};l.prototype.$LiveChatPluginMessageComposer6=function(){if(this.props.hasMenu)return c("React").createElement(c("LiveChatPluginBotMenuButton.react"),{isMobile:this.props.isMobile,threadColor:this.props.threadColor,pageID:this.props.pageID,viewerID:this.props.viewerID});return null};l.prototype.focus=function(){this.$LiveChatPluginMessageComposer1&&this.$LiveChatPluginMessageComposer1.focusInput()};f.exports=l}),null);
__d("XMNLiveChatBlockMessageController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/plugins/live_chat/block/",{page_id:{type:"String",required:true}})}),null);
__d("XMNLiveChatUnblockMessageController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/plugins/live_chat/unblock/",{page_id:{type:"String",required:true}})}),null);
__d("LiveChatPluginDialogContainer.react",["cx","AsyncRequest","JSResource","LazyComponent.react","LiveChatPluginAnonymousUserPrompt.react","LiveChatPluginDialogHeader.react","LiveChatPluginLoggedInUserPrompt.react","LiveChatPluginLoggerUtil","LiveChatPluginMessageComposer.react","LoadOnRender.react","MercuryIDs","MercuryThreadActions","MessengerSpinner.react","React","ReactDOM","UnverifiedXD","XMNLiveChatBlockMessageController","XMNLiveChatUnblockMessageController","emptyFunction","gkx","performanceAbsoluteNow"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("MercuryThreadActions").get();i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(m){__p&&__p();j.constructor.call(this,m);this.state={dialogBodyHeight:-1,informationViewOpen:false,isPageBlocked:false};this.$LiveChatPluginDialogContainer10=function(n){c("JSResource").loadAll([c("JSResource")("LiveChatPluginDialogBody.react").__setRef("LiveChatPluginDialogContainer.react")],function(o){n(o);c("LiveChatPluginLoggerUtil").logChatDisplayDone(this.props.viewerID,this.props.pageID,this.$LiveChatPluginDialogContainer1)}.bind(this))}.bind(this);this.$LiveChatPluginDialogContainer8=function(){var n=c("XMNLiveChatBlockMessageController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.setState({isPageBlocked:true});new(c("AsyncRequest"))().setURI(n).setAllowCrossPageTransition(true).send()}.bind(this);this.$LiveChatPluginDialogContainer9=function(){var n=c("XMNLiveChatUnblockMessageController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.setState({isPageBlocked:false});new(c("AsyncRequest"))().setURI(n).setAllowCrossPageTransition(true).send()}.bind(this);this.$LiveChatPluginDialogContainer4=function(){var n=c("ReactDOM").findDOMNode(this),o=c("ReactDOM").findDOMNode(this.$LiveChatPluginDialogContainer2),p=c("ReactDOM").findDOMNode(this.$LiveChatPluginDialogContainer3);if(n&&n instanceof HTMLElement&&o&&o instanceof HTMLElement&&p&&p instanceof HTMLElement){var q=n.getBoundingClientRect().height-o.getBoundingClientRect().height-p.getBoundingClientRect().height;if(q!==this.state.dialogBodyHeight)this.setState({dialogBodyHeight:q})}}.bind(this);this.$LiveChatPluginDialogContainer7=function(){this.setState(function(n){return{informationViewOpen:!n.informationViewOpen}})}.bind(this);this.$LiveChatPluginDialogContainer1=c("performanceAbsoluteNow")()}l.prototype.componentDidMount=function(){__p&&__p();if(this.props.isMobile)window.addEventListener("resize",this.$LiveChatPluginDialogContainer4);if(this.props.chatStarted&&this.props.hasMessagingPermission&&this.props.isLoggedIn){var m=c("ReactDOM").findDOMNode(this);if(m&&m instanceof HTMLElement){m.addEventListener("click",function(){this.$LiveChatPluginDialogContainer5()}.bind(this));if(!this.props.isMobile)m.addEventListener("click",function(){this.$LiveChatPluginDialogContainer6()}.bind(this))}}};l.prototype.render=function(){if(!this.props.chatStarted||!this.props.hasMessagingPermission)return this.props.isLoggedIn?c("React").createElement(c("LiveChatPluginLoggedInUserPrompt.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,canSkipContinuousAs:this.props.canSkipContinuousAs,hasMessagingPermission:this.props.hasMessagingPermission,loggedInGreeting:this.props.loggedInGreeting,onChatNowClick:this.props.onChatNowClick,onCloseButtonClick:this.props.onCloseButtonClick,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,refererUri:this.props.refererUri,threadColor:this.props.threadColor,viewerID:this.props.viewerID}):c("React").createElement(c("LiveChatPluginAnonymousUserPrompt.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,loggedOutGreeting:this.props.loggedOutGreeting,onCloseButtonClick:this.props.onCloseButtonClick,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,refererUri:this.props.refererUri,threadColor:this.props.threadColor,viewerID:this.props.viewerID});return this.props.isLoggedIn?c("React").createElement("div",{className:"_3gog",style:this.props.isMobile?null:{borderRadius:"9pt"}},c("React").createElement(c("LiveChatPluginDialogHeader.react"),{informationViewOpen:this.state.informationViewOpen,onCloseButtonClick:this.props.onCloseButtonClick,onInformationButtonClick:this.$LiveChatPluginDialogContainer7,pageID:this.props.pageID,pageName:this.props.pageName,pageResponsivenessText:this.props.pageResponsivenessText,ref:function(m){return this.$LiveChatPluginDialogContainer2=m}.bind(this),threadColor:this.props.threadColor,viewerID:this.props.viewerID}),c("React").createElement("div",{className:"_424s"},c("React").createElement(c("LoadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{blockMessage:this.$LiveChatPluginDialogContainer8,dialogBodyHeight:this.state.dialogBodyHeight,isMobile:this.props.isMobile,isMuted:this.props.isMuted,isPageBlocked:this.state.isPageBlocked,informationViewOpen:this.state.informationViewOpen,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,threadColor:this.props.threadColor,unblockMessage:this.$LiveChatPluginDialogContainer9,viewerID:this.props.viewerID}),loader:this.$LiveChatPluginDialogContainer10,placeholder:c("React").createElement("div",{className:"spinner"},c("React").createElement(c("MessengerSpinner.react"),{color:"blue",size:c("MessengerSpinner.react").large_size}))})),c("React").createElement(c("LiveChatPluginMessageComposer.react"),{disableInput:this.props.disableInput,hasMenu:this.props.hasMenu,isMobile:this.props.isMobile,onBlur:this.$LiveChatPluginDialogContainer11()&&c("gkx")("AT7hhNkUCsrH-WQwqPlkVR6rxIH4s31Hwi85MD_2LXYVR9YP4OQnHMjUXVLCsk9uQ8WZtQWtCc1jqeEmvM9S2ebGIBfTB8W8Vp3LTkXFFb3dzg")?this.$LiveChatPluginDialogContainer12:c("emptyFunction"),onFocus:this.$LiveChatPluginDialogContainer11()&&c("gkx")("AT7hhNkUCsrH-WQwqPlkVR6rxIH4s31Hwi85MD_2LXYVR9YP4OQnHMjUXVLCsk9uQ8WZtQWtCc1jqeEmvM9S2ebGIBfTB8W8Vp3LTkXFFb3dzg")?this.$LiveChatPluginDialogContainer13:c("emptyFunction"),pageID:this.props.pageID,ref:function(m){return this.$LiveChatPluginDialogContainer3=m}.bind(this),threadColor:this.props.threadColor,viewerID:this.props.viewerID})):null};l.prototype.$LiveChatPluginDialogContainer5=function(){k.markRead(c("MercuryIDs").getThreadIDFromUserID(this.props.pageID))};l.prototype.$LiveChatPluginDialogContainer6=function(){this.$LiveChatPluginDialogContainer3&&this.$LiveChatPluginDialogContainer3.focus()};l.prototype.$LiveChatPluginDialogContainer12=function(){c("UnverifiedXD").send({type:"liveChatPluginBlurComposer"})};l.prototype.$LiveChatPluginDialogContainer13=function(){c("UnverifiedXD").send({type:"liveChatPluginFocusComposer"})};l.prototype.$LiveChatPluginDialogContainer11=function(){return/iPhone|iPad|iPod/.test(navigator.userAgent)};f.exports=l}),null);
__d("XMNPlatformCustomerChatPluginOpenThreadController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/messages/commerce/customer_chat_plugin/open_thread/",{page_id:{type:"FBID",required:true},request_id:{type:"String",required:true},referer_uri:{type:"String",required:true},ref:{type:"String"}})}),null);
__d("LiveChatPlugin.react",["cx","Arbiter","AsyncRequest","CurrentUser","LiveChatIcebreakerClient","LiveChatMqttClient","LiveChatPluginDialogContainer.react","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MessengerLiveChatPluginEvent","React","XMNPlatformCustomerChatPluginOpenThreadController","gkx"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;function k(){__p&&__p();var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.state={chatStarted:c("LiveChatPluginSessionUtil").getChatStarted(),hasMessagingPermission:this.props.hasMessagingPermission,loggedInGreeting:this.props.loggedInGreeting,loggedOutGreeting:this.props.loggedOutGreeting,refParam:this.props.refParam},this.$LiveChatPlugin6=function(){this.props.onCloseButtonClick();c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").CHAT_DIALOG_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),this.$LiveChatPlugin5=function(){this.props.onChatNowClick();this.$LiveChatPlugin3();this.setState({chatStarted:true,hasMessagingPermission:true},function(){c("LiveChatPluginSessionUtil").setChatStarted(true)})}.bind(this),this.$LiveChatPlugin7=function(){var q=c("LiveChatPluginSessionUtil").getRefSent();if(!q){var r=c("XMNPlatformCustomerChatPluginOpenThreadController").getURIBuilder().setFBID("page_id",this.props.pageID).setString("ref",this.state.refParam).setString("referer_uri",this.props.refererUri).setString("request_id",c("LiveChatPluginSessionUtil").getRequestID()).getURI();new(c("AsyncRequest"))().setURI(r).setAllowCrossPageTransition(true).setMethod("POST").send();c("LiveChatPluginSessionUtil").setRefSent(true)}}.bind(this),m}k.prototype.componentDidMount=function(){__p&&__p();if(!c("CurrentUser").isLoggedIn()){this.setState({chatStarted:false});c("LiveChatPluginSessionUtil").setChatStarted(false)}if(this.state.chatStarted&&this.state.hasMessagingPermission){this.$LiveChatPlugin3();c("LiveChatPluginSessionUtil").setChatStarted(true)}this.$LiveChatPlugin2=c("Arbiter").subscribe("Connect.Unsafe.updateCustomerChat",function(l,m){var n={},o=this.$LiveChatPlugin4(m.logged_in_greeting),p=this.$LiveChatPlugin4(m.logged_out_greeting);if(o!==null)n.loggedInGreeting=o;if(p!==null)n.loggedOutGreeting=p;if(m.ref)n.refParam=m.ref;this.setState(n)}.bind(this));c("LiveChatPluginLoggerUtil").logAction(c("MessengerLiveChatPluginEvent").PLUGIN_LOADED,this.props.viewerID,this.props.pageID,JSON.stringify({greetingDialogDisplay:this.props.greetingDialogDisplay,greetingDialogDelay:this.props.greetingDialogDelay,isMobile:this.props.isMobile,reloaded:this.props.reloaded,isDialogHidden:c("LiveChatPluginSessionUtil").getIsDialogHidden(),isMuted:this.props.isMuted}),this.props.threadColor,this.state.loggedInGreeting,this.state.loggedOutGreeting)};k.prototype.componentWillUnmount=function(){this.$LiveChatPlugin1&&this.$LiveChatPlugin1.disconnect();this.$LiveChatPlugin2&&c("Arbiter").unsubscribe(this.$LiveChatPlugin2)};k.prototype.render=function(){return c("React").createElement("div",{className:"_30ss"},c("React").createElement(c("LiveChatPluginDialogContainer.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,canSkipContinuousAs:this.props.canSkipContinuousAs,chatStarted:this.state.chatStarted,disableInput:this.props.disableInput,hasMenu:this.props.hasMenu,hasMessagingPermission:this.state.hasMessagingPermission,isLoggedIn:this.props.isLoggedIn,isMobile:this.props.isMobile,isMuted:this.props.isMuted,loggedInGreeting:this.state.loggedInGreeting,loggedOutGreeting:this.state.loggedOutGreeting,onChatNowClick:this.$LiveChatPlugin5,onCloseButtonClick:this.$LiveChatPlugin6,pageID:this.props.pageID,pageName:this.props.pageName,pageProfilePictureUri:this.props.pageProfilePictureUri,pageResponsivenessText:this.props.pageResponsivenessText,refererUri:this.props.refererUri,threadColor:this.props.threadColor?this.props.threadColor:"#0084FF",viewerID:this.props.viewerID}))};k.prototype.$LiveChatPlugin3=function(){var l=c("gkx")("AT6c5YHVCTUix5Gwa--s9AxFgQaFVEg5JPpv1CaOrBZjkjH4j_C1GcnXrwDtlCc2JBmNslLjxJtrBz_0zcfaXV9_ZItnXCskBu0gl-oBcItejg"),m=this.props.isIESupported||c("gkx")("AT7JCav-mnZaXvxvDZIStsaHGOzW3wm3IcqOSc7xoesh9oMNPR0bSOyfLxBj6PCvVKOi8MrYYxdqv_TpZOkUtcGctqpnKAug6HnuZMaG4wXC1Q");if(l)c("LiveChatMqttClient").setUp(this.props.pageID,this.props.viewerID,this.props.isIESupported,null,m?this.$LiveChatPlugin7:null);this.$LiveChatPlugin8();if(!m)this.$LiveChatPlugin7()};k.prototype.$LiveChatPlugin8=function(){this.$LiveChatPlugin1=new(c("LiveChatIcebreakerClient"))(this.props.pageID,this.props.viewerID,this.props.originDomain,this.props.isIESupported);this.$LiveChatPlugin1&&this.$LiveChatPlugin1.connectWithRetries()};k.prototype.$LiveChatPlugin4=function(l){if(!l)return null;else if(Array.from(l).length>80)return null;else return l};f.exports=k}),null);
__d("LiveChatPluginBadgeSVG.react",["React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){__p&&__p();var k={fontSize:"8px",text:this.props.unreadCount,cx:"12",cy:"8",rx:"8",ry:"8"};if(this.props.unreadCount===0)return null;else if(this.props.unreadCount>20){k.text="20+";k.cx="11";k.rx="9"}else if(this.props.unreadCount<10)k.fontSize="9px";return c("React").createElement("svg",{x:"40",y:"0",width:"20",height:"20"},c("React").createElement("ellipse",{cx:k.cx,cy:k.cy,rx:k.rx,ry:k.ry,fill:"#e8423e"}),c("React").createElement("text",{x:"12",y:"8",textAnchor:"middle",fill:"#ffffff",fontSize:k.fontSize,fontFamily:"Arial",dy:".4em"},k.text))};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("LiveChatPluginMessengerIconSVG.react",["Arbiter","LiveChatPluginBadgeSVG.react","LiveChatPluginSessionUtil","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.state={unreadCount:this.props.unreadCount},this.$LiveChatPluginMessengerIconSVG1=null,l}j.prototype.componentDidMount=function(){this.$LiveChatPluginMessengerIconSVG1=c("Arbiter").subscribe("CustomerChatAlert/unreadCount",function(k,l){this.setState({unreadCount:l})}.bind(this))};j.prototype.componentWillUnmount=function(){if(this.$LiveChatPluginMessengerIconSVG1)c("Arbiter").unsubscribe(this.$LiveChatPluginMessengerIconSVG1)};j.prototype.render=function(){var k=this.props.threadColor?c("React").createElement("svg",{x:"0",y:"0",width:"60",height:"60"},c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c("React").createElement("g",null,c("React").createElement("g",null,c("React").createElement("circle",{fill:this.props.threadColor,cx:"30",cy:"30",r:"30"}),c("React").createElement("g",{transform:"translate(10.000000, 11.000000)",fill:"#FFFFFF"},c("React").createElement("path",{d:"M0,18.7150914 C0,8.37723141 8.956743,0 20,0 C31.043257,0 40,8.37723141 40,18.7150914 C40,29.0529515 31.043257,37.4301829 20,37.4301829 C18,37.4301829 16.0763359,37.1551856 14.2544529,36.6459314 L6.95652174,40 L6.95652174,33.0434783 C2.44929143,29.6044708 0,24.5969773 0,18.7150914 Z M16.9276495,19.6993886 L22.109375,25.0798234 L33.0434783,13.4782609 L23.0672554,18.9962636 L17.890625,13.6158288 L6.95652174,25.2173913 L16.9276495,19.6993886 Z"})))))):c("React").createElement("svg",{x:"0",y:"0",width:"60",height:"60"},c("React").createElement("defs",null,c("React").createElement("linearGradient",{x1:"50%",y1:"100%",x2:"50%",y2:"0.000340050378%",id:"linearGradient-1"},c("React").createElement("stop",{stopColor:"#0068FF",offset:"4.5%"}),c("React").createElement("stop",{stopColor:"#00C6FF",offset:"95.5%"}))),c("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c("React").createElement("g",null,c("React").createElement("g",null,c("React").createElement("circle",{fill:"#FFFFFF",cx:"30",cy:"30",r:"30"}),c("React").createElement("g",{transform:"translate(10.000000, 11.000000)"},c("React").createElement("path",{d:"M0,18.7150914 C0,24.5969773 2.44929143,29.6044708 6.95652174,33.0434783 L6.95652174,40 L14.2544529,36.6459314 C16.0763359,37.1551856 18,37.4301829 20,37.4301829 C31.043257,37.4301829 40,29.0529515 40,18.7150914 C40,8.37723141 31.043257,0 20,0 C8.956743,0 0,8.37723141 0,18.7150914 Z",fill:"url(#linearGradient-1)"}),c("React").createElement("polygon",{fill:"#FFFFFF",points:"16.9378907 19.359375 7 25 17.8976562 13.140625 23.0570312 18.640625 33 13 22.1023437 24.859375"})))))),l=null;if(c("LiveChatPluginSessionUtil").getChatStarted()&&c("LiveChatPluginSessionUtil").getIsDialogHidden())l=c("React").createElement(c("LiveChatPluginBadgeSVG.react"),{unreadCount:this.state.unreadCount});return c("React").createElement("svg",{width:"60px",height:"60px",viewBox:"0 0 60 60"},k,l)};f.exports=j}),null);
__d("LiveChatGreetingDialogDisplayMode",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({UNSET:"unset",SHOW:"show",HIDE:"hide",FADE:"fade"})}),null);
__d("LiveChatPluginQEUniverse",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({CUSTOMER_CHAT_PLUGIN_QE_UNIVERSE:"customer_chat_plugin_qe"})}),null);
__d("LiveChatPluginMount",["Arbiter","Bootloader","CurrentUser","LiveChatGreetingDialogDisplayMode","LiveChatPlugin.react","LiveChatPluginLoggerUtil","LiveChatPluginMessengerIconSVG.react","LiveChatPluginQEUniverse","LiveChatPluginSessionUtil","MessengerLiveChatSettings","MessengerLiveChatPluginEvent","QE2Logger","React","ReactDOM","ShimButton.react","Style","UnverifiedXD","gkx","performanceAbsoluteNow"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){__p&&__p();var j=i.container,k=i.canSkipContinuousAs,l=i.disableInput,m=i.greetingDialogDisplay,n=i.greetingDialogDelay,o=i.greetingDialogFadeDelay,p=i.hasMenu,q=i.hasMessagingPermission,r=i.isIESupported,s=i.initSeqID,t=i.isMuted,u=i.loggedInGreeting,v=i.loggedOutGreeting,w=i.originDomain,x=i.pageID,y=i.pageName,z=i.pageProfilePictureUri,A=i.pageResponsivenessText,B=i.qeParameters,C=i.refererUri,D=i.refParam,E=i.reloaded,F=i.requestID,G=i.soundURLs,H=i.threadCSSColor,I=i.unreadCount;this.$LiveChatPluginMount12=function(){this.$LiveChatPluginMount2=!this.$LiveChatPluginMount2;c("UnverifiedXD").send({type:this.$LiveChatPluginMount2?"liveChatPluginHideDialogIframe":"liveChatPluginShowDialogIframe",chatStarted:c("LiveChatPluginSessionUtil").getChatStarted(),isMobile:this.$LiveChatPluginMount3});c("LiveChatPluginSessionUtil").setIsDialogHidden(this.$LiveChatPluginMount2)}.bind(this);this.$LiveChatPluginMount11=function(){this.$LiveChatPluginMount5&&clearTimeout(this.$LiveChatPluginMount5);c("UnverifiedXD").send({type:this.$LiveChatPluginMount3?"liveChatPluginExpandMobileDialogIframe":"liveChatPluginExpandDesktopDialogIframe"})}.bind(this);var J=c("performanceAbsoluteNow")(),K=!c("LiveChatPluginSessionUtil").getSessionState();this.$LiveChatPluginMount3=/iPhone|iPod|iPad|Android|Mobile/i.test(navigator.userAgent);if(!s)s=0;var L=c("CurrentUser").isLoggedIn(),M=c("CurrentUser").getID();this.$LiveChatPluginMount6(q,w,x,E,F,M,m,n);if(L)c("Bootloader").loadModules(["LiveChatPluginAlerts","MercurySyncDeltaHandler"],function(O,P){O.init(M,x,y,G,t,I);P.get();c("Arbiter").inform("MercurySyncDeltaHandler/initSeqID",{fbid:M,seqID:s})},"LiveChatPluginMount");c("UnverifiedXD").send({type:this.$LiveChatPluginMount3?"liveChatPluginPrepareMobileAnchorIframe":"liveChatPluginPrepareDesktopAnchorIframe",chatStarted:c("LiveChatPluginSessionUtil").getChatStarted(),dialogHidden:this.$LiveChatPluginMount2});var N=c("React").createElement(c("ShimButton.react"),{onClick:function(){this.$LiveChatPluginMount7(M,x)}.bind(this),style:{cursor:"pointer",outline:"none"}},c("React").createElement(c("LiveChatPluginMessengerIconSVG.react"),{threadColor:H,unreadCount:I}));c("Arbiter").subscribeOnce("blankIframeAck",function(O,P){this.$LiveChatPluginMount1=P;c("ReactDOM").render(N,P.document.body);c("Style").set(P.document.body,"margin","0");this.$LiveChatPluginMount8(I);this.$LiveChatPluginMount9(n,m,o,K)}.bind(this));c("ReactDOM").render(c("React").createElement(c("LiveChatPlugin.react"),{anchorIframeResizeFn:this.$LiveChatPluginMount10,canSkipContinuousAs:k,disableInput:l,greetingDialogDelay:n,greetingDialogDisplay:m,hasMenu:p,hasMessagingPermission:q,isIESupported:r,isLoggedIn:L,isMobile:this.$LiveChatPluginMount3,isMuted:t,loggedInGreeting:u,loggedOutGreeting:v,onChatNowClick:this.$LiveChatPluginMount11,onCloseButtonClick:this.$LiveChatPluginMount12,originDomain:w,pageID:x,pageName:y,pageProfilePictureUri:z,pageResponsivenessText:A,refererUri:C,refParam:D,reloaded:E,threadColor:H,viewerID:M}),j);this.$LiveChatPluginMount8(I);c("LiveChatPluginLoggerUtil").logTTI(M,x,J)}h.prototype.$LiveChatPluginMount9=function(i,j,k,l){__p&&__p();if(!l)return;var m=false;switch(j){case c("LiveChatGreetingDialogDisplayMode").FADE:m=!this.$LiveChatPluginMount3&&i>0;break;case c("LiveChatGreetingDialogDisplayMode").SHOW:m=i>0;break;case c("LiveChatGreetingDialogDisplayMode").UNSET:var n=c("MessengerLiveChatSettings").qeSettings;if(!n||this.$LiveChatPluginMount3)break;c("QE2Logger").logExposureForUser(c("LiveChatPluginQEUniverse").CUSTOMER_CHAT_PLUGIN_QE_UNIVERSE);m=n.shouldPrompt&&n.promptDelayMs>0;i=n.promptDelayMs;break;case c("LiveChatGreetingDialogDisplayMode").HIDE:break;default:break}if(!m)return;setTimeout(function(){this.$LiveChatPluginMount13(k)}.bind(this),i)};h.prototype.$LiveChatPluginMount13=function(i){if(this.$LiveChatPluginMount2){this.$LiveChatPluginMount12();if(i)this.$LiveChatPluginMount5=setTimeout(this.$LiveChatPluginMount12,i)}};h.prototype.$LiveChatPluginMount10=function(i){c("UnverifiedXD").send({type:"liveChatPluginResizeAnchorIframe",height:i})};h.prototype.$LiveChatPluginMount8=function(i){if(this.$LiveChatPluginMount1){c("UnverifiedXD").send({type:"liveChatPluginShowBubbleIframe",showBadge:i>0&&c("LiveChatPluginSessionUtil").getIsDialogHidden()});return}c("UnverifiedXD").send({type:"liveChatPluginGetBubbleIframe",isHTTPS:window.location.protocol==="https:",fromIframe:window.name})};h.prototype.$LiveChatPluginMount7=function(i,j){this.$LiveChatPluginMount12();var k=c("LiveChatPluginSessionUtil").getChatStarted(),event=void 0;if(k)event=this.$LiveChatPluginMount2?c("MessengerLiveChatPluginEvent").CHAT_DIALOG_CLOSED:c("MessengerLiveChatPluginEvent").CHAT_DIALOG_OPENED;else event=this.$LiveChatPluginMount2?c("MessengerLiveChatPluginEvent").CHAT_NOW_PROMPT_CLOSED:c("MessengerLiveChatPluginEvent").CHAT_NOW_PROMPT_OPENED;c("LiveChatPluginLoggerUtil").logAction(event,i,j)};h.prototype.$LiveChatPluginMount6=function(i,j,k,l,m,n,o,p){__p&&__p();if(l){m=c("LiveChatPluginSessionUtil").getRequestID();c("LiveChatPluginSessionUtil").removeSessionState(c("LiveChatPluginSessionUtil").getCurrentSessionKey())}c("LiveChatPluginSessionUtil").setCurrentSessionKey(j,k,n);var q=c("LiveChatPluginSessionUtil").getSessionState();if(!q){if(l)this.$LiveChatPluginMount2=false;else if(o!==c("LiveChatGreetingDialogDisplayMode").UNSET)this.$LiveChatPluginMount2=o===c("LiveChatGreetingDialogDisplayMode").HIDE||p>0;else if(!this.$LiveChatPluginMount3&&c("MessengerLiveChatSettings").qeSettings&&c("MessengerLiveChatSettings").qeSettings.promptDelayMs>0)this.$LiveChatPluginMount2=c("MessengerLiveChatSettings").qeSettings.shouldPrompt;else this.$LiveChatPluginMount2=this.$LiveChatPluginMount3;c("LiveChatPluginSessionUtil").setSessionState({chatStarted:l,isDialogHidden:this.$LiveChatPluginMount2,requestID:m,refSent:false})}else{this.$LiveChatPluginMount2=c("LiveChatPluginSessionUtil").getIsDialogHidden();if(!i)c("LiveChatPluginSessionUtil").setChatStarted(false);c("LiveChatPluginSessionUtil").setRequestID(m)}};f.exports=h}),null);